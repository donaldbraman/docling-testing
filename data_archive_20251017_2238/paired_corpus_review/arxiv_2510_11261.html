<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research.</title>
<!--Generated on Mon Oct 13 10:38:00 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on  %“begin–center˝ .-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="/static/browse/0.3.4/css/arxiv-html-papers-20250916.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2510.11261v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S1" title="In Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2" title="In Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Utility optimization for terminal wealth</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS1" title="In 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>The setup and notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS2" title="In 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>The individual optimization problem</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS3" title="In 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Mean-field equilibrium under stochastic order flow</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="In 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Some implications</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3" title="In Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Recursive utility optimization with path-dependent cash flows</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.SS1" title="In 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>The setup and notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.SS2" title="In 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>The individual optimization problem</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.SS3" title="In 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Mean-field equilibrium among the agents with recursive utilities</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.SS4" title="In 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Mean-field equilibrium of multiple populations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4" title="In Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Numerical examples</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.SS1" title="In 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Utility for terminal wealth</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.SS2" title="In 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Recursive utility</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S5" title="In Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Concluding remarks and future research directions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Mean-Field Price Formation on Trees
<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The authors are not responsible in any manner for any losses caused by the use of any contents in this research.
</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Masaaki Fujii<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>mfujii@e.u-tokyo.ac.jp, Graduate School of Economics, The University of Tokyo, Tokyo, Japan </span></span></span>
</span></span>
</div>
<div class="ltx_dates">(
First version: October 13, 2025
<br class="ltx_break"/>)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p">In this work, we combine the mean-field game theory with the classical idea of binomial tree framework, pioneered by Sharpe and Cox, Ross &amp; Rubinstein, to solve the equilibrium price formation problem for the stock.
For agents with exponential utilities
and recursive utilities of exponential type, we prove the existence of a unique mean-field equilibrium and derive an explicit formula for equilibrium transition probabilities of the stock price by restricting its trajectories onto a binomial tree.
The agents are subject to stochastic terminal liabilities and incremental endowments, both of which are dependent on unhedgeable common and idiosyncratic factors, in addition to the stock price path. Finally, we provide numerical examples to illustrate the qualitative effects of these components on the equilibrium price distribution.</p>
</div>
<div class="ltx_para" id="p1">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Keywords:</span>
mean-field game theory, multi-population, equilibrium price formation, exponential utility, recursive utility, binomial tree</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p">The mean-field game (MFG) theory was pioneered independently by the seminal works
of Lasry &amp; Lions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib35" title="">35</a>]</cite> and Huang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib29" title="">29</a>]</cite> in the mid- to late-2000s.
These works are based on analytic methods using coupled Hamilton-Jacobi-Bellman and Kolmogorov equations.
Later, the probabilistic approach to the MFG theory based on forward-backward stochastic differential equations (FBSDEs)
of McKean-Vlasov type was established by Carmona &amp; Delarue <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib10" title="">10</a>]</cite>.
The two volumes, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib11" title="">11</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib12" title="">12</a>]</cite> , by the same authors,
provide full details on the probabilistic approach and its applications.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p">The greatest advantage of the MFG theory is that it can convert a complex problem of stochastic differential games
among many agents into a standard optimization problem and a fixed-point problem.
There is a growing number of studies in the literature attempting to solve many-agent problems
by the MFG technique. The MFG theory requires, in principle, symmetric interactions among the agents.
We can find a particularly large number of applications of MFGs in financial and energy markets
because symmetric interactions are standard in these settings.
There are also many economic applications of mean field games, in particular, those focusing on general equilibrium models on growth, inequality and unemployment, dynamic demand response and persuasion problems, etc. See, for example, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib22" title="">22</a>]</cite> and the references therein.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p">In recent years, there have also been major advances in MFG theory for applications in the equilibrium price-formation problem,
where the asset price process is constructed endogenously to ensure that the asset’s supply and demand always balance among the heterogeneous
but exchangeable agents, rather than being exogenously given.
Gomes &amp; Saúde <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib24" title="">24</a>]</cite> present a deterministic model
of electricity price. Its extension with random supply is given by Gomes et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib23" title="">23</a>]</cite>.
Ashrafyan et.al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib6" title="">6</a>]</cite> propose a duality approach transforming these problems
into variational ones that are numerically more tractable.
Shrivats et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib39" title="">39</a>]</cite> deal with a price formation problem for
the solar renewable energy certificate (SREC) by solving FBSDEs of McKean-Vlasov type.
Féron et.al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib15" title="">15</a>]</cite> develop a tractable equilibrium model for intraday electricity markets.
Sarto et.al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib36" title="">36</a>]</cite> study cap-and-trade pollution regulation and derive
the equilibrium price for the carbon emission.
Regarding the price formation of securities, Fujii &amp; Takahashi <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib16" title="">16</a>]</cite> show
that the equilibrium price process can be characterized by FBSDEs of conditional
McKean-Vlasov type. Its strong convergence to the mean-field limit from a finite-agent setting
is proved in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib17" title="">17</a>]</cite>, and its extension to the presence of a major player is given in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib18" title="">18</a>]</cite> by the same authors.
Fujii <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib19" title="">19</a>]</cite> develops a model that allows the co-presence of cooperative and non-cooperative populations to
learn how the price process is formed when the agents in one population act in a coordinated manner.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p">There remain two limitations in the above results: firstly, the
relevant control of each agent is the trading rate and hence her asset position is constrained to follow an absolutely continuous process with
respect to the Lebesgue measure <math alttext="dt" class="ltx_Math" display="inline" id="S1.p4.m1" intent=":literal"><semantics><mrow><mi>d</mi><mo lspace="0em" rspace="0em">​</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math>; secondly, the cost function of each agent consists of penalties on the
trading speed and on the inventory size of the assets. Therefore, the above
frameworks cannot deal with the general self-financing trading strategies nor the utility functions defined directly in terms of the
wealth process of the portfolio. A major obstacle in dealing with a utility function of the wealth resides in the difficulty of guaranteeing
the convexity of the Hamiltonian associated with the Pontryagin’s maximum principle and in the difficulty of getting
enough regularity to prove the well-posedness of the associated FBSDEs.
These problems are solved by Fujii &amp; Sekine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib21" title="">21</a>]</cite> for the agents with exponential utilities by applying the method of Hu, Imkeller &amp; Müller <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib26" title="">26</a>]</cite>
based on the martingale optimality principle. An extension to the setting with partial information is studied by Sekine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib37" title="">37</a>]</cite>.
They find that a novel quadratic-growth backward SDE (qg-BSDE) of conditional McKean-Vlasov type characterizes the equilibrium risk-premium process. Unfortunately, however, the existence of the solution of this mean-field qg-BSDE has been proved
only under rather restrictive conditions. This is because the conditional McKean-Vlasov nature of the equation
makes the traditional approach of Kobylanski <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib32" title="">32</a>]</cite> inapplicable anymore.
Moreover, even if the well-posedness of the equation were to be completely solved, its
numerical evaluation would continue to remain a highly challenging problem.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p">In this work, we study the price-formation problem for the risky stock.
In order to understand how the equilibrium price process changes its behavior due to the market environment
and the differences in the distribution of characteristics among the agents,
it is necessary to get more explicit and more numerically tractable solutions than those in the existing literature.
For proceeding toward this goal, in this paper, we propose an approach to combine the MFG theory with a
classical idea of binomial trees, first proposed by Sharpe <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib38" title="">38</a>]</cite> and formalized by Cox, Ross &amp; Rubinstein <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib13" title="">13</a>]</cite>.
By restricting the stock price trajectories onto a binomial tree,
we can search, in a rather straightforward manner, an appropriate set of transition probabilities so that the stock market clears.
The agents, which are mainly intended to be financial and investment firms,
are supposed to have standard exponential utilities or recursive utilities of exponential type.
We allow the presence of terminal liability and incremental endowments,
both of which are stochastic due to unhedgeable common factors <math alttext="Y" class="ltx_Math" display="inline" id="S1.p5.m1" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> as well as idiosyncratic factors <math alttext="Z^{i}" class="ltx_Math" display="inline" id="S1.p5.m2" intent=":literal"><semantics><msup><mi>Z</mi><mi>i</mi></msup><annotation encoding="application/x-tex">Z^{i}</annotation></semantics></math> in addition to the
stock price dependence. Since we are focusing on a trading desk of each firm, the incremental endowments
represent non-tradable incomes originating from the firm’s other business activities.
We also study the impacts of external order flow from outside groups
or possibly from a major financial player.
Simple and explicit expressions for the equilibrium transition probabilities allow us to numerically evaluate the marginal
equilibrium price distributions as well as conditional distributions with respect to the common factors <math alttext="Y" class="ltx_Math" display="inline" id="S1.p5.m3" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
and to study their qualitative behaviors with respect to the components just mentioned above.
Moreover, our scheme can be readily extended to multi-population equilibrium problems.
This is clear contrast to the continuous-time setting as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib21" title="">21</a>]</cite>, where the extension
would require to solve a coupled system of complex mean-field qg-BSDEs, whose
well-posedness would be much more challenging than a single population case.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p">We structure the rest of the paper as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2" title="2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2</span></a> investigates the mean-field equilibrium
among the agents with exponential utilities subject to terminal liabilities. Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3" title="3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3</span></a> deals with an extension
to recursive utilities and also introduces cash spending (i.e. nominal consumption) and incremental endowments.
Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4" title="4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a> provides several illustrative numerical examples and examines their implications.
Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S5" title="5 Concluding remarks and future research directions ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">5</span></a> summarizes our findings and discusses possible directions for future research.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Utility optimization for terminal wealth</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p">We start our investigation into the mean-field price formation from a simple model where a countable number of agents,
whose utilities are exponential type,
are optimizing their terminal wealth by carrying out self-financing trading strategies on a deterministic money market account
and a single risky stock.
Each agent has to manage financial risk arising from the common market shocks as well as her own idiosyncratic shocks.
Note that, in addition to the shocks from the stock price process, our model incorporates non-tradable macro-economic and/or environmental shocks that affect all agents.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>The setup and notation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p">Let us start from explaining the relevant probability spaces.
<math alttext="(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=1}^{N},\mathbb{P}^{0})" class="ltx_Math" display="inline" id="S2.SS1.p1.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mn>0</mn></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mn>0</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=1}^{N},\mathbb{P}^{0})</annotation></semantics></math> is a complete filtered probability space, where <math alttext="0=t_{0}&lt;t_{1}&lt;\cdots&lt;t_{N}=T" class="ltx_Math" display="inline" id="S2.SS1.p1.m2" intent=":literal"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>t</mi><mn>0</mn></msub><mo>&lt;</mo><msub><mi>t</mi><mn>1</mn></msub><mo>&lt;</mo><mi mathvariant="normal">⋯</mi><mo>&lt;</mo><msub><mi>t</mi><mi>N</mi></msub><mo>=</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">0=t_{0}&lt;t_{1}&lt;\cdots&lt;t_{N}=T</annotation></semantics></math>
is an equally spaced time sequence using a time step <math alttext="\Delta:=T/N" class="ltx_Math" display="inline" id="S2.SS1.p1.m3" intent=":literal"><semantics><mrow><mi mathvariant="normal">Δ</mi><mo>:=</mo><mrow><mi>T</mi><mo>/</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">\Delta:=T/N</annotation></semantics></math> where <math alttext="T&lt;\infty" class="ltx_Math" display="inline" id="S2.SS1.p1.m4" intent=":literal"><semantics><mrow><mi>T</mi><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">T&lt;\infty</annotation></semantics></math> and <math alttext="N\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.m5" intent=":literal"><semantics><mrow><mi>N</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">N\in\mathbb{N}</annotation></semantics></math> are given constants.
The filtration <math alttext="({\cal F}_{t_{n}}^{0})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.m6" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">({\cal F}_{t_{n}}^{0})_{n=0}^{N}</annotation></semantics></math> is generated by two stochastic processes, one is a strictly positive process <math alttext="(S_{n}:=S(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.m7" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>:=</mo><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n}:=S(t_{n}))_{n=0}^{N}</annotation></semantics></math>
and the other is a <math alttext="d_{Y}" class="ltx_Math" display="inline" id="S2.SS1.p1.m8" intent=":literal"><semantics><msub><mi>d</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">d_{Y}</annotation></semantics></math>-dimensional process <math alttext="(Y_{n}=Y(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.m9" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>Y</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n}=Y(t_{n}))_{n=0}^{N}</annotation></semantics></math>, i.e. <math alttext="{\cal F}_{t_{n}}^{0}:=\sigma\{S_{k},Y_{k},0\leq k\leq n\}" class="ltx_Math" display="inline" id="S2.SS1.p1.m10" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo>:=</mo><mrow><mi>σ</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">{</mo><mrow><mrow><msub><mi>S</mi><mi>k</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>k</mi></msub><mo>,</mo><mn>0</mn></mrow><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>n</mi></mrow><mo stretchy="false">}</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">{\cal F}_{t_{n}}^{0}:=\sigma\{S_{k},Y_{k},0\leq k\leq n\}</annotation></semantics></math>.
In the model below, we shall use <math alttext="S_{n}" class="ltx_Math" display="inline" id="S2.SS1.p1.m11" intent=":literal"><semantics><msub><mi>S</mi><mi>n</mi></msub><annotation encoding="application/x-tex">S_{n}</annotation></semantics></math> to denote the stock price at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S2.SS1.p1.m12" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math> and <math alttext="Y_{n}" class="ltx_Math" display="inline" id="S2.SS1.p1.m13" intent=":literal"><semantics><msub><mi>Y</mi><mi>n</mi></msub><annotation encoding="application/x-tex">Y_{n}</annotation></semantics></math> the common shocks affecting all the agents at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S2.SS1.p1.m14" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>.
<math alttext="S_{0}&gt;0" class="ltx_Math" display="inline" id="S2.SS1.p1.m15" intent=":literal"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S_{0}&gt;0</annotation></semantics></math> and <math alttext="Y_{0}\in\mathbb{R}^{d_{Y}}" class="ltx_Math" display="inline" id="S2.SS1.p1.m16" intent=":literal"><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub><mo>∈</mo><msup><mi>ℝ</mi><msub><mi>d</mi><mi>Y</mi></msub></msup></mrow><annotation encoding="application/x-tex">Y_{0}\in\mathbb{R}^{d_{Y}}</annotation></semantics></math> are given constants and thus <math alttext="{\cal F}_{0}^{0}" class="ltx_Math" display="inline" id="S2.SS1.p1.m17" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mn>0</mn></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{0}</annotation></semantics></math> is trivial.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p">In addition to the above space,
we consider a countable set of complete filtered probability spaces <math alttext="(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i}),~i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS1.p2.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><mo rspace="0.497em">,</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i}),~i\in\mathbb{N}</annotation></semantics></math>.
For each <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.m2" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math alttext="(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i})" class="ltx_Math" display="inline" id="S2.SS1.p2.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i})</annotation></semantics></math> is endowed with
<math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S2.SS1.p2.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variables <math alttext="(\xi^{i},\gamma_{i})" class="ltx_Math" display="inline" id="S2.SS1.p2.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>ξ</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\xi^{i},\gamma_{i})</annotation></semantics></math> as well as <math alttext="({\cal F}^{i}_{t_{n}})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p2.m6" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">({\cal F}^{i}_{t_{n}})_{n=0}^{N}</annotation></semantics></math>-adapted
stochastic process <math alttext="(Z_{n}^{i}=Z^{i}(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p2.m7" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>=</mo><mrow><msup><mi>Z</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i}=Z^{i}(t_{n}))_{n=0}^{N}</annotation></semantics></math>. Here, <math alttext="\xi_{i},\gamma_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.m8" intent=":literal"><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\xi_{i},\gamma_{i}</annotation></semantics></math> are both <math alttext="\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS1.p2.m9" intent=":literal"><semantics><mi>ℝ</mi><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math>-valued
and <math alttext="\xi_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.m10" intent=":literal"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_{i}</annotation></semantics></math> is used to represent the initial wealth and <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.m11" intent=":literal"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_{i}</annotation></semantics></math> the size of absolute risk aversion
of agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.m12" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>. The <math alttext="d_{Z}" class="ltx_Math" display="inline" id="S2.SS1.p2.m13" intent=":literal"><semantics><msub><mi>d</mi><mi>Z</mi></msub><annotation encoding="application/x-tex">d_{Z}</annotation></semantics></math>-dimensional process <math alttext="(Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p2.m14" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math> is used to model idiosyncratic shocks to each agent.
The fact that <math alttext="(\xi^{i},\gamma_{i})" class="ltx_Math" display="inline" id="S2.SS1.p2.m15" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>ξ</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\xi^{i},\gamma_{i})</annotation></semantics></math> are <math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S2.SS1.p2.m16" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable means that the agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p2.m17" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> knows her
initial wealth and the size of risk aversion at time zero.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p">By the standard procedures (see, for example, Klenke <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib31" title="">31</a>, Chapter 14]</cite>), the complete filtered probability space
<math alttext="(\Omega,{\cal F},({\cal F}_{t_{n}})_{n=0}^{N},\mathbb{P})" class="ltx_Math" display="inline" id="S2.SS1.p3.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo>,</mo><mi class="ltx_font_mathcaligraphic">ℱ</mi><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><mi>ℙ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega,{\cal F},({\cal F}_{t_{n}})_{n=0}^{N},\mathbb{P})</annotation></semantics></math> is defined as the product of all the above spaces</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(\Omega,{\cal F},({\cal F}_{t_{n}})_{n=0}^{N},\mathbb{P}):=(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=0}^{N},\mathbb{P}^{0})\otimes_{i=1}^{\infty}(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i})" class="ltx_Math" display="block" id="S2.Ex1.m1" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo>,</mo><mi class="ltx_font_mathcaligraphic">ℱ</mi><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><mi>ℙ</mi><mo stretchy="false">)</mo></mrow><mo>:=</mo><mrow><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mn>0</mn></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mn>0</mn></msup><mo rspace="0.055em" stretchy="false">)</mo></mrow><msubsup><mo rspace="0.222em">⊗</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">(\Omega,{\cal F},({\cal F}_{t_{n}})_{n=0}^{N},\mathbb{P}):=(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=0}^{N},\mathbb{P}^{0})\otimes_{i=1}^{\infty}(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">which denotes the full probability space containing the entire environment of our model.
Therefore, by construction, <math alttext="((S_{n}),(Y_{n}))" class="ltx_Math" display="inline" id="S2.SS1.p3.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mo>,</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">((S_{n}),(Y_{n}))</annotation></semantics></math> and <math alttext="(\xi^{i},\gamma_{i},(Z_{n}^{i})),~i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS1.p3.m3" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi>ξ</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo></mrow><mo rspace="0.497em">,</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">(\xi^{i},\gamma_{i},(Z_{n}^{i})),~i\in\mathbb{N}</annotation></semantics></math> are mutually independent.
On the other hand, the relevant probability space for each agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p3.m4" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> is the product probability space defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(\Omega^{0,i},{\cal F}^{0,i},({\cal F}_{t_{n}}^{0,i})_{n=0}^{N},\mathbb{P}^{0,i}):=(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=0}^{N},\mathbb{P}^{0})\otimes(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i})," class="ltx_Math" display="block" id="S2.Ex2.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo stretchy="false">)</mo></mrow><mo>:=</mo><mrow><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mn>0</mn></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mn>0</mn></msup><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">(\Omega^{0,i},{\cal F}^{0,i},({\cal F}_{t_{n}}^{0,i})_{n=0}^{N},\mathbb{P}^{0,i}):=(\Omega^{0},{\cal F}^{0},({\cal F}_{t_{n}}^{0})_{n=0}^{N},\mathbb{P}^{0})\otimes(\Omega^{i},{\cal F}^{i},({\cal F}_{t_{n}}^{i})_{n=0}^{N},\mathbb{P}^{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">which reflects our assumption that common shocks are public knowledge, but the idiosyncratic shocks are private to
each agent.
We shall use the same symbols, such as <math alttext="(S_{n},Y_{n},\gamma_{i},\cdots)" class="ltx_Math" display="inline" id="S2.SS1.p3.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><mi mathvariant="normal">⋯</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S_{n},Y_{n},\gamma_{i},\cdots)</annotation></semantics></math>, if they are
defined as trivial extensions on larger product probability spaces.
Expectations with respect to <math alttext="\mathbb{P}^{0}" class="ltx_Math" display="inline" id="S2.SS1.p3.m6" intent=":literal"><semantics><msup><mi>ℙ</mi><mn>0</mn></msup><annotation encoding="application/x-tex">\mathbb{P}^{0}</annotation></semantics></math>, <math alttext="\mathbb{P}^{0,i}" class="ltx_Math" display="inline" id="S2.SS1.p3.m7" intent=":literal"><semantics><msup><mi>ℙ</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><annotation encoding="application/x-tex">\mathbb{P}^{0,i}</annotation></semantics></math> and <math alttext="\mathbb{P}" class="ltx_Math" display="inline" id="S2.SS1.p3.m8" intent=":literal"><semantics><mi>ℙ</mi><annotation encoding="application/x-tex">\mathbb{P}</annotation></semantics></math> are denoted by <math alttext="\mathbb{E}^{0}[\cdot]" class="ltx_Math" display="inline" id="S2.SS1.p3.m9" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mo lspace="0em" rspace="0em">⋅</mo><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0}[\cdot]</annotation></semantics></math>, <math alttext="\mathbb{E}^{0,i}[\cdot]" class="ltx_Math" display="inline" id="S2.SS1.p3.m10" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mo lspace="0em" rspace="0em">⋅</mo><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0,i}[\cdot]</annotation></semantics></math>
and <math alttext="\mathbb{E}[\cdot]" class="ltx_Math" display="inline" id="S2.SS1.p3.m11" intent=":literal"><semantics><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mo lspace="0em" rspace="0em">⋅</mo><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\cdot]</annotation></semantics></math>, respectively. We also denote by <math alttext="\overline{E}[\cdot]" class="ltx_Math" display="inline" id="S2.SS1.p3.m12" intent=":literal"><semantics><mrow><mover accent="true"><mi>E</mi><mo stretchy="true">¯</mo></mover><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mo lspace="0em" rspace="0em">⋅</mo><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\overline{E}[\cdot]</annotation></semantics></math> the expectation with respect to the product measure
<math alttext="\otimes_{i=1}^{\infty}\mathbb{P}^{i}" class="ltx_Math" display="inline" id="S2.SS1.p3.m13" intent=":literal"><semantics><mrow><mi></mi><msubsup><mo lspace="0.222em" rspace="0.222em">⊗</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>ℙ</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">\otimes_{i=1}^{\infty}\mathbb{P}^{i}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p">In this work, we restrict the trajectories of <math alttext="(S_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p4.m1" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n})_{n=0}^{N}</annotation></semantics></math> on a recombining binomial tree. For each <math alttext="n=1,\cdots,N" class="ltx_Math" display="inline" id="S2.SS1.p4.m2" intent=":literal"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">n=1,\cdots,N</annotation></semantics></math>,
the random variable <math alttext="\widetilde{R}_{n}:=S_{n}/S_{n-1}" class="ltx_Math" display="inline" id="S2.SS1.p4.m3" intent=":literal"><semantics><mrow><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mi>n</mi></msub><mo>:=</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>/</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">\widetilde{R}_{n}:=S_{n}/S_{n-1}</annotation></semantics></math> takes only the two possible values, either <math alttext="\widetilde{u}" class="ltx_Math" display="inline" id="S2.SS1.p4.m4" intent=":literal"><semantics><mover accent="true"><mi>u</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{u}</annotation></semantics></math> or <math alttext="\widetilde{d}" class="ltx_Math" display="inline" id="S2.SS1.p4.m5" intent=":literal"><semantics><mover accent="true"><mi>d</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{d}</annotation></semantics></math>.
This means that the set of all possible values taken by <math alttext="S_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m6" intent=":literal"><semantics><msub><mi>S</mi><mi>n</mi></msub><annotation encoding="application/x-tex">S_{n}</annotation></semantics></math> is given by <math alttext="{\cal S}_{n}:=\{S_{0}\widetilde{u}^{k}\widetilde{d}^{n-k},0\leq k\leq n\}" class="ltx_Math" display="inline" id="S2.SS1.p4.m7" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo>:=</mo><mrow><mo stretchy="false">{</mo><mrow><mrow><mrow><msub><mi>S</mi><mn>0</mn></msub><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>k</mi></msup><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>d</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow></msup></mrow><mo>,</mo><mn>0</mn></mrow><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>n</mi></mrow><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">{\cal S}_{n}:=\{S_{0}\widetilde{u}^{k}\widetilde{d}^{n-k},0\leq k\leq n\}</annotation></semantics></math>,
which is a finite subset of <math alttext="(0,\infty)" class="ltx_Math" display="inline" id="S2.SS1.p4.m8" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,\infty)</annotation></semantics></math>.
Let <math alttext="{\cal S}^{n}:={\cal S}_{0}\times{\cal S}_{1}\times{\cal S}_{2}\times\cdots\times{\cal S}_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m9" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo>:=</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mn>0</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mn>1</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mn>2</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub></mrow></mrow><annotation encoding="application/x-tex">{\cal S}^{n}:={\cal S}_{0}\times{\cal S}_{1}\times{\cal S}_{2}\times\cdots\times{\cal S}_{n}</annotation></semantics></math>
be the set of all values taken by the stock price trajectory <math alttext="(S_{k})_{k=0}^{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m10" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><annotation encoding="application/x-tex">(S_{k})_{k=0}^{n}</annotation></semantics></math>.
Moreover, in order to avoid technicalities regarding the conditional probabilities, we also assume that
the process <math alttext="Y" class="ltx_Math" display="inline" id="S2.SS1.p4.m11" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> takes only a finite number of values at every <math alttext="t_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m12" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>. We use <math alttext="{\cal Y}_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m13" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Y}_{n}</annotation></semantics></math>, which is a
finite subset of <math alttext="\mathbb{R}^{d_{Y}}" class="ltx_Math" display="inline" id="S2.SS1.p4.m14" intent=":literal"><semantics><msup><mi>ℝ</mi><msub><mi>d</mi><mi>Y</mi></msub></msup><annotation encoding="application/x-tex">\mathbb{R}^{d_{Y}}</annotation></semantics></math>, to denote the set of all values taken by <math alttext="Y_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m15" intent=":literal"><semantics><msub><mi>Y</mi><mi>n</mi></msub><annotation encoding="application/x-tex">Y_{n}</annotation></semantics></math>.
We use, for each <math alttext="0\leq n\leq N" class="ltx_Math" display="inline" id="S2.SS1.p4.m16" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0\leq n\leq N</annotation></semantics></math>, <math alttext="{\cal Y}^{n}:={\cal Y}_{0}\times{\cal Y}_{1}\times\cdots\times{\cal Y}_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m17" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msup><mo>:=</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mn>0</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mn>1</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><annotation encoding="application/x-tex">{\cal Y}^{n}:={\cal Y}_{0}\times{\cal Y}_{1}\times\cdots\times{\cal Y}_{n}</annotation></semantics></math> to represent the set of all values in
<math alttext="\mathbb{R}^{d_{Y}\times(n+1)}" class="ltx_Math" display="inline" id="S2.SS1.p4.m18" intent=":literal"><semantics><msup><mi>ℝ</mi><mrow><msub><mi>d</mi><mi>Y</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msup><annotation encoding="application/x-tex">\mathbb{R}^{d_{Y}\times(n+1)}</annotation></semantics></math> taken by the trajectory <math alttext="(Y_{k})_{k=0}^{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m19" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><annotation encoding="application/x-tex">(Y_{k})_{k=0}^{n}</annotation></semantics></math>.
In a similar manner, we denote the support of the random variable <math alttext="Z_{n}^{i}" class="ltx_Math" display="inline" id="S2.SS1.p4.m20" intent=":literal"><semantics><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">Z_{n}^{i}</annotation></semantics></math> by <math alttext="{\cal Z}_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m21" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Z}_{n}</annotation></semantics></math>
and define <math alttext="{\cal Z}^{n}:={\cal Z}_{0}\times{\cal Z}_{1}\times\cdots\times{\cal Z}_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m22" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msup><mo>:=</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mn>0</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mn>1</mn></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub></mrow></mrow><annotation encoding="application/x-tex">{\cal Z}^{n}:={\cal Z}_{0}\times{\cal Z}_{1}\times\cdots\times{\cal Z}_{n}</annotation></semantics></math> as the support of <math alttext="(Z_{k}^{i})_{k=0}^{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m23" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>k</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><annotation encoding="application/x-tex">(Z_{k}^{i})_{k=0}^{n}</annotation></semantics></math>.
The time-<math alttext="t_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m24" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math> value of the risk-free money market account is given by <math alttext="\exp\bigl(rn\Delta\bigr)" class="ltx_Math" display="inline" id="S2.SS1.p4.m25" intent=":literal"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi>n</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp\bigl(rn\Delta\bigr)</annotation></semantics></math>
where <math alttext="r&gt;0" class="ltx_Math" display="inline" id="S2.SS1.p4.m26" intent=":literal"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r&gt;0</annotation></semantics></math> is a positive constant denoting the risk-free (nominal) interest rate. We also use the symbol <math alttext="\beta:=\exp(r\Delta)" class="ltx_Math" display="inline" id="S2.SS1.p4.m27" intent=":literal"><semantics><mrow><mi>β</mi><mo>:=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\beta:=\exp(r\Delta)</annotation></semantics></math>.
For later use, let us also define</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="u:=\widetilde{u}-\exp(r\Delta),\quad d:=\widetilde{d}-\exp(r\Delta)" class="ltx_Math" display="block" id="S2.Ex3.m1" intent=":literal"><semantics><mrow><mrow><mi>u</mi><mo>:=</mo><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>−</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mi>d</mi><mo>:=</mo><mrow><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo>−</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">u:=\widetilde{u}-\exp(r\Delta),\quad d:=\widetilde{d}-\exp(r\Delta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">and</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{n}:=\widetilde{R}_{n}-\exp(r\Delta),~1\leq n\leq N." class="ltx_Math" display="block" id="S2.Ex4.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>R</mi><mi>n</mi></msub><mo>:=</mo><mrow><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mi>n</mi></msub><mo>−</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo rspace="0.497em">,</mo><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">R_{n}:=\widetilde{R}_{n}-\exp(r\Delta),~1\leq n\leq N.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">The random variable <math alttext="R_{n}" class="ltx_Math" display="inline" id="S2.SS1.p4.m28" intent=":literal"><semantics><msub><mi>R</mi><mi>n</mi></msub><annotation encoding="application/x-tex">R_{n}</annotation></semantics></math> takes the values either <math alttext="u" class="ltx_Math" display="inline" id="S2.SS1.p4.m29" intent=":literal"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math> or <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p4.m30" intent=":literal"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p">In the following, to lighten the notational burden, we use <math alttext="\mathbb{E}^{0,i}\bigl[~\cdot~|s,y,z^{i},\gamma_{i}\bigr]" class="ltx_math_unparsed" display="inline" id="S2.SS1.p5.m1" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em" rspace="0.163em">[</mo><mo rspace="0.330em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0,i}\bigl[~\cdot~|s,y,z^{i},\gamma_{i}\bigr]</annotation></semantics></math> to denote
<math alttext="\mathbb{E}^{0,i}\bigl[~\cdot~|S_{n-1}=s,Y_{n-1}=y,Z_{n-1}^{i}=z^{i},\gamma_{i}=\gamma_{i}\bigr]" class="ltx_math_unparsed" display="inline" id="S2.SS1.p5.m2" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em" rspace="0.163em">[</mo><mo rspace="0.330em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0,i}\bigl[~\cdot~|S_{n-1}=s,Y_{n-1}=y,Z_{n-1}^{i}=z^{i},\gamma_{i}=\gamma_{i}\bigr]</annotation></semantics></math> for <math alttext="(s,y,z^{i})\in{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}" class="ltx_Math" display="inline" id="S2.SS1.p5.m3" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y,z^{i})\in{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}</annotation></semantics></math>.
With slight abuse of notation, we shall use the same symbols for the realizations of <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S2.SS1.p5.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variables
(<math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S2.SS1.p5.m5" intent=":literal"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_{i}</annotation></semantics></math> in the above example).</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S2.Thmassumption1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 2.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmassumption1.p1">
<p class="ltx_p">(i):<span class="ltx_text ltx_font_italic"> <math alttext="\widetilde{u}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m1" intent=":literal"><semantics><mover accent="true"><mi>u</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{u}</annotation></semantics></math> and <math alttext="\widetilde{d}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m2" intent=":literal"><semantics><mover accent="true"><mi>d</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{d}</annotation></semantics></math> are real constants satisfying</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0&lt;\widetilde{d}&lt;\exp(r\Delta)&lt;\widetilde{u}&lt;\infty." class="ltx_Math" display="block" id="S2.Ex5.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo>&lt;</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">0&lt;\widetilde{d}&lt;\exp(r\Delta)&lt;\widetilde{u}&lt;\infty.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">(ii):<span class="ltx_text ltx_font_italic"> Every <math alttext="(\xi^{i},\gamma_{i},(Z_{n}^{i})_{n=0}^{N}),i=1,2,\ldots" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m3" intent=":literal"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi>ξ</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">)</mo></mrow><mo>,</mo><mi>i</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mn>2</mn><mo>,</mo><mi mathvariant="normal">…</mi></mrow></mrow><annotation encoding="application/x-tex">(\xi^{i},\gamma_{i},(Z_{n}^{i})_{n=0}^{N}),i=1,2,\ldots</annotation></semantics></math> has the same distribution.
<br class="ltx_break"/></span>(iii):<span class="ltx_text ltx_font_italic"> There exist constants <math alttext="\underline{\xi},\overline{\xi}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m4" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>ξ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ξ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\xi},\overline{\xi}</annotation></semantics></math> and <math alttext="\underline{\gamma},\overline{\gamma}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m5" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>γ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\gamma},\overline{\gamma}</annotation></semantics></math> so that for every <math alttext="i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m6" intent=":literal"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">i\in\mathbb{N}</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\xi_{i}\in[\underline{\xi},\overline{\xi}]\subset\mathbb{R},\quad\gamma_{i}\in\Gamma:=[\underline{\gamma},\overline{\gamma}]\subset(0,\infty)." class="ltx_Math" display="block" id="S2.Ex6.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>∈</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>ξ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ξ</mi><mo stretchy="true">¯</mo></mover><mo stretchy="false">]</mo></mrow><mo>⊂</mo><mi>ℝ</mi></mrow><mo rspace="1.167em">,</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant="normal">Γ</mi><mo>:=</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>γ</mi><mo stretchy="true">¯</mo></mover><mo stretchy="false">]</mo></mrow><mo>⊂</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\xi_{i}\in[\underline{\xi},\overline{\xi}]\subset\mathbb{R},\quad\gamma_{i}\in\Gamma:=[\underline{\gamma},\overline{\gamma}]\subset(0,\infty).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">(iv):<span class="ltx_text ltx_font_italic"> For every <math alttext="0\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m7" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0\leq n\leq N</annotation></semantics></math>, <math alttext="{\cal Z}_{n}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m8" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Z}_{n}</annotation></semantics></math> is a bounded subset
of <math alttext="\mathbb{R}^{d_{Z}}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m9" intent=":literal"><semantics><msup><mi>ℝ</mi><msub><mi>d</mi><mi>Z</mi></msub></msup><annotation encoding="application/x-tex">\mathbb{R}^{d_{Z}}</annotation></semantics></math>.
<br class="ltx_break"/></span>(v):<span class="ltx_text ltx_font_italic"> For each <math alttext="i" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m10" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math alttext="(Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m11" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math> is a Markov process i.e. <math alttext="\mathbb{E}^{i}[f(Z_{n}^{i})|{\cal F}_{t_{m}}^{i}]=\mathbb{E}^{i}[f(Z_{n}^{i})|Z_{m}^{i}]" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m12" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>m</mi></msub><mi>i</mi></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi>Z</mi><mi>m</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{i}[f(Z_{n}^{i})|{\cal F}_{t_{m}}^{i}]=\mathbb{E}^{i}[f(Z_{n}^{i})|Z_{m}^{i}]</annotation></semantics></math>
for every bounded measurable function <math alttext="f" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m13" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> on <math alttext="{\cal Z}_{n}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m14" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Z}_{n}</annotation></semantics></math> and <math alttext="m\leq n" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m15" intent=":literal"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\leq n</annotation></semantics></math>.
<br class="ltx_break"/></span>(vi):<span class="ltx_text ltx_font_italic"> <math alttext="(Y_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m16" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n})_{n=0}^{N}</annotation></semantics></math> is a Markov process i.e. <math alttext="\mathbb{E}^{0}[f(Y_{n})|{\cal F}_{t_{m}}^{0}]=\mathbb{E}^{0}[f(Y_{n})|Y_{m}]" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m17" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>m</mi></msub><mn>0</mn></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msub><mi>Y</mi><mi>m</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0}[f(Y_{n})|{\cal F}_{t_{m}}^{0}]=\mathbb{E}^{0}[f(Y_{n})|Y_{m}]</annotation></semantics></math>
for every bounded measurable function <math alttext="f" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m18" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> on <math alttext="{\cal Y}_{n}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m19" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Y}_{n}</annotation></semantics></math> and <math alttext="m\leq n" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m20" intent=":literal"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\leq n</annotation></semantics></math>.
<br class="ltx_break"/></span>(vii):<span class="ltx_text ltx_font_italic"> The transition probabilities of <math alttext="(S_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m21" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n})_{n=0}^{N}</annotation></semantics></math> satisfy, for every <math alttext="0\leq n\leq N-1" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m22" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0\leq n\leq N-1</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|S_{n},Y_{n})=p_{n}(S_{n},Y_{n}),\\
\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|S_{n},Y_{n})=q_{n}(S_{n},Y_{n}):=1-p_{n}(S_{n},Y_{n}),\end{split}" class="ltx_Math" display="block" id="S2.Ex7.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>q</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mn>1</mn><mo>−</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|S_{n},Y_{n})=p_{n}(S_{n},Y_{n}),\\
\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|S_{n},Y_{n})=q_{n}(S_{n},Y_{n}):=1-p_{n}(S_{n},Y_{n}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">where <math alttext="p_{n},q_{n}:{\cal S}_{n}\times{\cal Y}_{n}\rightarrow\mathbb{R},~0\leq n\leq N-1" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m23" intent=":literal"><semantics><mrow><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>,</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow><mo rspace="0.497em">,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">p_{n},q_{n}:{\cal S}_{n}\times{\cal Y}_{n}\rightarrow\mathbb{R},~0\leq n\leq N-1</annotation></semantics></math> are bounded measurable functions
satisfying</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0&lt;p_{n}(s,y),q_{n}(s,y)&lt;1" class="ltx_Math" display="block" id="S2.Ex8.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><msub><mi>q</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0&lt;p_{n}(s,y),q_{n}(s,y)&lt;1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="(s,y)\in{\cal S}_{n}\times{\cal Y}_{n}" class="ltx_Math" display="inline" id="S2.Thmassumption1.p1.m24" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n}\times{\cal Y}_{n}</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p">Let us give some remarks on the above assumptions.
Firstly, by the condition (i), we have <math alttext="d&lt;0&lt;u" class="ltx_Math" display="inline" id="S2.SS1.p6.m1" intent=":literal"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mn>0</mn><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">d&lt;0&lt;u</annotation></semantics></math>.
It is well-known that the transition probabilities under the risk-neutral measure <math alttext="\mathbb{Q}" class="ltx_Math" display="inline" id="S2.SS1.p6.m2" intent=":literal"><semantics><mi>ℚ</mi><annotation encoding="application/x-tex">\mathbb{Q}</annotation></semantics></math>
for the classical binomial framework are given by <math alttext="p^{\mathbb{Q}}:=\frac{-d}{u-d}" class="ltx_Math" display="inline" id="S2.SS1.p6.m3" intent=":literal"><semantics><mrow><msup><mi>p</mi><mi>ℚ</mi></msup><mo>:=</mo><mfrac><mrow><mo>−</mo><mi>d</mi></mrow><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">p^{\mathbb{Q}}:=\frac{-d}{u-d}</annotation></semantics></math> for the up-move and <math alttext="q^{\mathbb{Q}}:=1-p^{\mathbb{Q}}" class="ltx_Math" display="inline" id="S2.SS1.p6.m4" intent=":literal"><semantics><mrow><msup><mi>q</mi><mi>ℚ</mi></msup><mo>:=</mo><mrow><mn>1</mn><mo>−</mo><msup><mi>p</mi><mi>ℚ</mi></msup></mrow></mrow><annotation encoding="application/x-tex">q^{\mathbb{Q}}:=1-p^{\mathbb{Q}}</annotation></semantics></math> for the down-move.
These probabilities are uniquely determined by the parameters <math alttext="(\widetilde{u},\widetilde{d})" class="ltx_Math" display="inline" id="S2.SS1.p6.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>,</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\widetilde{u},\widetilde{d})</annotation></semantics></math> and the risk-free interest rate.
In this paper, we fix the relative jump size <math alttext="(\widetilde{u},\widetilde{d})" class="ltx_Math" display="inline" id="S2.SS1.p6.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>,</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\widetilde{u},\widetilde{d})</annotation></semantics></math> to be constant across all nodes; however this is done merely for simplicity.
The entire discussion of our paper still holds even if <math alttext="(\widetilde{u},\widetilde{d})" class="ltx_Math" display="inline" id="S2.SS1.p6.m7" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>,</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\widetilde{u},\widetilde{d})</annotation></semantics></math> varies from node to node.
In fact, the method works even for general non-recombining binomial trees.
Moreover, thanks to the famous result by Derman &amp; Kani (1994) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib14" title="">14</a>]</cite>, one can construct so-called “<span class="ltx_text ltx_font_italic">implied binomial trees</span>”
by adjusting the position <math alttext="(\widetilde{u},\widetilde{d})" class="ltx_Math" display="inline" id="S2.SS1.p6.m8" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>,</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\widetilde{u},\widetilde{d})</annotation></semantics></math> node by node to reproduce implied volatility surface
in the market, while keeping the recombining property of binomial trees intact.
Therefore, if necessary, our discussion below can be applied to a binomial tree whose risk-neutral distribution is consistent with the option market.
The boundedness assumption in (iii) and (iv) is not crucial. One can relax it by adding appropriate integrability conditions.</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<p class="ltx_p">Our goal in this section is to find a set of transition probabilities of the form <math alttext="\bigl(p_{n}(s,y))_{n=0}^{N-1}" class="ltx_Math" display="inline" id="S2.SS1.p7.m1" intent=":literal"><semantics><msubsup><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\bigl(p_{n}(s,y))_{n=0}^{N-1}</annotation></semantics></math> so that the demand and
supply of the stock are balanced among the agents at every node <math alttext="(s,y)\in{\cal S}_{n}\times{\cal Y}_{n},0\leq n\leq N-1" class="ltx_Math" display="inline" id="S2.SS1.p7.m2" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><mo>,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n}\times{\cal Y}_{n},0\leq n\leq N-1</annotation></semantics></math>.
Note that we can assume, without any loss of generality, that the process <math alttext="(Y_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p7.m3" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n})_{n=0}^{N}</annotation></semantics></math> and <math alttext="(Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p7.m4" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math>
are Markov, since, if necessary, we can recover Markovian property by lifting <math alttext="Y,Z^{i}" class="ltx_Math" display="inline" id="S2.SS1.p7.m5" intent=":literal"><semantics><mrow><mi>Y</mi><mo>,</mo><msup><mi>Z</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">Y,Z^{i}</annotation></semantics></math> to higher dimensional processes.
However, the condition (vii) is not trivial. In fact, in the next section, we shall study more general
situations where the transition probability must be dependent on the past history of the stock price to achieve the market-clearing equilibrium.
Under the current condition (vi) and (vii), <math alttext="(S_{n+1},Y_{n+1})" class="ltx_Math" display="inline" id="S2.SS1.p7.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S_{n+1},Y_{n+1})</annotation></semantics></math> satisfy the property:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}^{0}[f(S_{n+1})g(Y_{n+1})|{\cal F}_{t_{n}}^{0}]=\mathbb{E}^{0}[f(S_{n+1})|S_{n},Y_{n}]\mathbb{E}^{0}[g(Y_{n+1})|Y_{n}],\quad 0\leq n\leq N-1," class="ltx_Math" display="block" id="S2.E1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>g</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0}[f(S_{n+1})g(Y_{n+1})|{\cal F}_{t_{n}}^{0}]=\mathbb{E}^{0}[f(S_{n+1})|S_{n},Y_{n}]\mathbb{E}^{0}[g(Y_{n+1})|Y_{n}],\quad 0\leq n\leq N-1,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for any bounded measurable functions <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p7.m7" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> and <math alttext="g" class="ltx_Math" display="inline" id="S2.SS1.p7.m8" intent=":literal"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.
We can interpret that the process <math alttext="(Y_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p7.m9" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n})_{n=0}^{N}</annotation></semantics></math> represents some standalone macro-economic and/or environmental factors
which are not influenced by the agents’ trading activities. It may naturally serve as a state process in regime switching models.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="S2.Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Remark 2.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmremark1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Note that the bound for the transition probabilities in (vii) guarantees the equivalence of probability measures <math alttext="\mathbb{P}^{0}\circ S_{n}^{-1}" class="ltx_Math" display="inline" id="S2.Thmremark1.p1.m1" intent=":literal"><semantics><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0.222em" rspace="0.222em">∘</mo><msubsup><mi>S</mi><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{P}^{0}\circ S_{n}^{-1}</annotation></semantics></math> and
<math alttext="\mathbb{Q}\circ S_{n}^{-1}" class="ltx_Math" display="inline" id="S2.Thmremark1.p1.m2" intent=":literal"><semantics><mrow><mi>ℚ</mi><mo lspace="0.222em" rspace="0.222em">∘</mo><msubsup><mi>S</mi><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{Q}\circ S_{n}^{-1}</annotation></semantics></math>. Hence, our system is arbitrage free.</span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>The individual optimization problem</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p">We now explain the optimization problem for each agent. Agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p1.m1" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math alttext="i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS2.p1.m2" intent=":literal"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">i\in\mathbb{N}</annotation></semantics></math>, endowed with an initial wealth <math alttext="\xi_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.m3" intent=":literal"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_{i}</annotation></semantics></math>,
engages in self-financing trading involving the risk-free money market account and the risky stock.
She adopts an <math alttext="({\cal F}_{t_{n}}^{0,i})_{n=0}^{N-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.m4" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">({\cal F}_{t_{n}}^{0,i})_{n=0}^{N-1}</annotation></semantics></math>-adapted trading strategy <math alttext="(\phi_{n}^{i})_{n=0}^{N-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.m5" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">(\phi_{n}^{i})_{n=0}^{N-1}</annotation></semantics></math> denoting the
invested amount of cash in the stock at time <math alttext="t=t_{n}" class="ltx_Math" display="inline" id="S2.SS2.p1.m6" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">t=t_{n}</annotation></semantics></math>. The associated wealth process of agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p1.m7" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is denoted by <math alttext="(X_{n}^{i}=X^{i}(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S2.SS2.p1.m8" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>=</mo><mrow><msup><mi>X</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(X_{n}^{i}=X^{i}(t_{n}))_{n=0}^{N}</annotation></semantics></math> and follows the dynamics</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}X_{n+1}^{i}&amp;=\exp(r\Delta)(X_{n}^{i}-\phi_{n}^{i})+\phi_{n}^{i}\widetilde{R}_{n+1}\\
&amp;=\beta X_{n}^{i}+\phi_{n}^{i}R_{n+1},\end{split}" class="ltx_Math" display="block" id="S2.Ex9.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><msubsup><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>−</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo>+</mo><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}X_{n+1}^{i}&amp;=\exp(r\Delta)(X_{n}^{i}-\phi_{n}^{i})+\phi_{n}^{i}\widetilde{R}_{n+1}\\
&amp;=\beta X_{n}^{i}+\phi_{n}^{i}R_{n+1},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="X_{0}^{i}=\xi_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.m9" intent=":literal"><semantics><mrow><msubsup><mi>X</mi><mn>0</mn><mi>i</mi></msubsup><mo>=</mo><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_{0}^{i}=\xi_{i}</annotation></semantics></math> and <math alttext="\beta=\exp(r\Delta)" class="ltx_Math" display="inline" id="S2.SS2.p1.m10" intent=":literal"><semantics><mrow><mi>β</mi><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\beta=\exp(r\Delta)</annotation></semantics></math>. Recall that <math alttext="R_{n+1}:=\widetilde{R}_{n+1}-\exp(r\Delta)" class="ltx_Math" display="inline" id="S2.SS2.p1.m11" intent=":literal"><semantics><mrow><msub><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>:=</mo><mrow><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">R_{n+1}:=\widetilde{R}_{n+1}-\exp(r\Delta)</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p">Each agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p2.m1" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> is supposed to solve the optimization problem:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\sup_{(\phi_{n}^{i})_{n=0}^{N-1}\in\mathbb{A}^{i}}\mathbb{E}^{0,i}\Bigl[-\exp\Bigl(-\gamma_{i}\bigl(X_{N}^{i}-F(S_{N},Y_{N},Z_{N}^{i})\bigr)\Bigr)|{\cal F}_{0}^{0,i}\Bigr],\end{split}" class="ltx_Math" display="block" id="S2.E2.m1" intent=":literal"><semantics><mtable displaystyle="true"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><mrow><munder><mo movablelimits="false">sup</mo><mrow><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo>∈</mo><msup><mi>𝔸</mi><mi>i</mi></msup></mrow></munder><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mo rspace="0.167em">−</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msubsup><mi>X</mi><mi>N</mi><mi>i</mi></msubsup><mo>−</mo><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\sup_{(\phi_{n}^{i})_{n=0}^{N-1}\in\mathbb{A}^{i}}\mathbb{E}^{0,i}\Bigl[-\exp\Bigl(-\gamma_{i}\bigl(X_{N}^{i}-F(S_{N},Y_{N},Z_{N}^{i})\bigr)\Bigr)|{\cal F}_{0}^{0,i}\Bigr],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{A}^{i}:=\bigl\{(\phi_{n}^{i})_{n=0}^{N-1};\phi_{n}^{i}\text{ is ${\cal F}_{t_{n}}^{0,i}$-measurable real random variable}\bigr\}" class="ltx_Math" display="block" id="S2.Ex10.m1" intent=":literal"><semantics><mrow><msup><mi>𝔸</mi><mi>i</mi></msup><mo>:=</mo><mrow><mo maxsize="1.200em" minsize="1.200em">{</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo>;</mo><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mtext> is </mtext><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><mtext>-measurable real random variable</mtext></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{A}^{i}:=\bigl\{(\phi_{n}^{i})_{n=0}^{N-1};\phi_{n}^{i}\text{ is ${\cal F}_{t_{n}}^{0,i}$-measurable real random variable}\bigr\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">denotes the admissible control space.
Here, we assume that agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.p2.m2" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> has full knowledge of the common market information and her own private idiosyncratic information,
but no knowledge of the private idiosyncratic information of the other agents.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S2.Thmassumption2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 2.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmassumption2.p1">
<p class="ltx_p">(i):<span class="ltx_text ltx_font_italic"> <math alttext="F:{\cal S}_{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmassumption2.p1.m1" intent=":literal"><semantics><mrow><mi>F</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>N</mi></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">F:{\cal S}_{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\rightarrow\mathbb{R}</annotation></semantics></math> is a bounded measurable function.
<br class="ltx_break"/></span>(ii):<span class="ltx_text ltx_font_italic"> Every agent is a price-taker in the sense that she considers that the stock price process (and hence its transition
probability specified in Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a> (vii)) to be exogenously given and unaffected by her trading strategies.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p">Here, the term <math alttext="F(S_{N},Y_{N},Z_{N}^{i})" class="ltx_Math" display="inline" id="S2.SS2.p3.m1" intent=":literal"><semantics><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(S_{N},Y_{N},Z_{N}^{i})</annotation></semantics></math> denotes the stochastic liability (<math alttext="(-1)\times" class="ltx_math_unparsed" display="inline" id="S2.SS2.p3.m2" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mo lspace="0em">−</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">(-1)\times</annotation></semantics></math> stochastic endowment) at the terminal time,
which depends on <math alttext="S_{N},Y_{N}" class="ltx_Math" display="inline" id="S2.SS2.p3.m3" intent=":literal"><semantics><mrow><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">S_{N},Y_{N}</annotation></semantics></math> and <math alttext="Z_{N}^{i}" class="ltx_Math" display="inline" id="S2.SS2.p3.m4" intent=":literal"><semantics><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">Z_{N}^{i}</annotation></semantics></math>.
Under the exponential utilities, the constant shift <math alttext="F\rightarrow F+c" class="ltx_Math" display="inline" id="S2.SS2.p3.m5" intent=":literal"><semantics><mrow><mi>F</mi><mo stretchy="false">→</mo><mrow><mi>F</mi><mo>+</mo><mi>c</mi></mrow></mrow><annotation encoding="application/x-tex">F\rightarrow F+c</annotation></semantics></math>
does not change the optimization problem; only the dependence on <math alttext="(S_{N},Y_{N},Z_{N}^{i})" class="ltx_Math" display="inline" id="S2.SS2.p3.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S_{N},Y_{N},Z_{N}^{i})</annotation></semantics></math>
in the function <math alttext="F" class="ltx_Math" display="inline" id="S2.SS2.p3.m7" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is relevant.
The condition (ii) is a plausible assumption since every agent naturally knows her trading share is negligible in the market.
This is also a key assumption for the standard MFG technique, in which we first solve a simple optimization problem with a given
candidate for the equilibrium distribution, and then check its consistency with the obtained optimal solution.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="S2.Thmremark2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Remark 2.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmremark2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Before going to solve the optimization problem, we give some economic motivations to include the stochastic terminal liability
<math alttext="F(S_{N},Y_{N},Z_{N}^{i})" class="ltx_Math" display="inline" id="S2.Thmremark2.p1.m1" intent=":literal"><semantics><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(S_{N},Y_{N},Z_{N}^{i})</annotation></semantics></math>. Since we primarily want to model various financial firms by our agents,
it is natural to suppose that they are subject to stochastic liabilities (such as portfolio of derivative contracts) dependent on the stock price.
It is also very plausible that the size of liability varies from agent to agent by their idiosyncratic factors <math alttext="(Z_{N}^{i})" class="ltx_Math" display="inline" id="S2.Thmremark2.p1.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Z_{N}^{i})</annotation></semantics></math>
as well as the common macro-economic/environmental factors <math alttext="(Y_{N})" class="ltx_Math" display="inline" id="S2.Thmremark2.p1.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>N</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Y_{N})</annotation></semantics></math>. This structure would naturally hold for non-financial firms, too.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p">We now characterize the optimal trading strategy for each agent.
Applying the well-known scheme of backward induction for discrete-time models, we establish the following result.
We shall see that the initial wealth <math alttext="\xi_{i}" class="ltx_Math" display="inline" id="S2.SS2.p4.m1" intent=":literal"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_{i}</annotation></semantics></math> does not play any role, which is an important characteristic
of exponential-type utilities.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S2.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem 2.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let Assumptions <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption2" title="Assumption 2.2. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a> be in force.
Then the problem <math alttext="(\ref{problem-terminal})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.E2" title="In 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{problem-terminal})</annotation></semantics></math> has a unique optimal solution <math alttext="(\phi^{i,*}_{n-1})_{n=1}^{N}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m2" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(\phi^{i,*}_{n-1})_{n=1}^{N}</annotation></semantics></math>,
which is an a.s. bounded process defined by a
measurable function <math alttext="\phi_{n-1}^{i,*}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m3" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">\phi_{n-1}^{i,*}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
as <math alttext="\phi_{n-1}^{i,*}:=\phi_{n-1}^{i,*}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m4" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>:=</mo><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\phi_{n-1}^{i,*}:=\phi_{n-1}^{i,*}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})</annotation></semantics></math>, where</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\phi_{n-1}^{i,*}(s,y,z^{i},\gamma_{i}):=\frac{1}{\gamma_{i}(u-d)}\frac{\beta^{n}}{\beta^{N}}\Bigl\{\log\Bigl(-\frac{p_{n-1}(s,y)u}{q_{n-1}(s,y)d}\Bigr)+\log\bigl(f_{n-1}(s,y,z^{i},\gamma_{i})\bigr)\Bigr\},\\
&amp;f_{n-1}(s,y,z^{i},\gamma_{i}):=\frac{\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]}{\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]}.\end{split}" class="ltx_Math" display="block" id="S2.E3.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mfrac><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mfrac></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo>+</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mfrac><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\phi_{n-1}^{i,*}(s,y,z^{i},\gamma_{i}):=\frac{1}{\gamma_{i}(u-d)}\frac{\beta^{n}}{\beta^{N}}\Bigl\{\log\Bigl(-\frac{p_{n-1}(s,y)u}{q_{n-1}(s,y)d}\Bigr)+\log\bigl(f_{n-1}(s,y,z^{i},\gamma_{i})\bigr)\Bigr\},\\
&amp;f_{n-1}(s,y,z^{i},\gamma_{i}):=\frac{\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]}{\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Here, <math alttext="f_{n-1}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m5" intent=":literal"><semantics><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">f_{n-1}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math> and
<math alttext="V_{n}:{\cal S}_{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m6" intent=":literal"><semantics><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">V_{n}:{\cal S}_{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.m7" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math> are a.s.​ strictly positive
bounded measurable functions defined recursively by</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="V_{N}(s,y,z^{i},\gamma_{i}):=\exp\bigl(\gamma_{i}F(s,y,z^{i})\bigr)," class="ltx_Math" display="block" id="S2.Ex11.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>V</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">V_{N}(s,y,z^{i},\gamma_{i}):=\exp\bigl(\gamma_{i}F(s,y,z^{i})\bigr),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">and</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}V_{n-1}(s,y,z^{i},\gamma_{i})&amp;:=p_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}_{n-1}(s,y,z^{i},\gamma_{i})u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;+q_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}_{n-1}(s,y,z^{i},\gamma_{i})d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}].\end{split}" class="ltx_Math" display="block" id="S2.E4.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>:=</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}V_{n-1}(s,y,z^{i},\gamma_{i})&amp;:=p_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}_{n-1}(s,y,z^{i},\gamma_{i})u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;+q_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}_{n-1}(s,y,z^{i},\gamma_{i})d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}].\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p2">
<p class="ltx_p">With <math alttext="V_{N}:{\cal S}_{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m1" intent=":literal"><semantics><mrow><msub><mi>V</mi><mi>N</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">V_{N}:{\cal S}_{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
defined by <math alttext="V_{N}(s,y,z^{i},\gamma_{i})=\exp\bigl(\gamma_{i}F(s,y,z^{i})\bigr)" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m2" intent=":literal"><semantics><mrow><mrow><msub><mi>V</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">V_{N}(s,y,z^{i},\gamma_{i})=\exp\bigl(\gamma_{i}F(s,y,z^{i})\bigr)</annotation></semantics></math>, we temporarily suppose that
the problem of agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m3" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> at <math alttext="t=t_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m4" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t=t_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m5" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>,
is defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sup_{\phi^{i}}\mathbb{E}^{0,i}\Bigl[-\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}X_{n}^{i}\Bigr)V_{n}(S_{n},Y_{n},Z_{n}^{i},\gamma_{i})|{\cal F}_{t_{n-1}}^{0,i}\Bigr]," class="ltx_Math" display="block" id="S2.E5.m1" intent=":literal"><semantics><mrow><mrow><munder><mo movablelimits="false">sup</mo><msup><mi>ϕ</mi><mi>i</mi></msup></munder><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mo rspace="0.167em">−</mo><mrow><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\sup_{\phi^{i}}\mathbb{E}^{0,i}\Bigl[-\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}X_{n}^{i}\Bigr)V_{n}(S_{n},Y_{n},Z_{n}^{i},\gamma_{i})|{\cal F}_{t_{n-1}}^{0,i}\Bigr],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with some a.s. strictly positive bounded measurable function <math alttext="V_{n}:{\cal S}_{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m6" intent=":literal"><semantics><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">V_{n}:{\cal S}_{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>.
Here, the supremum is taken over <math alttext="{\cal F}_{n-1}^{0,i}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m7" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><annotation encoding="application/x-tex">{\cal F}_{n-1}^{0,i}</annotation></semantics></math>-measurable real random variables.
Let us solve the above problem on the set <math alttext="\{(X^{i}_{n-1},S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})=(x^{i},s,y,z^{i},\gamma_{i})\}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m8" intent=":literal"><semantics><mrow><mo stretchy="false">{</mo><mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(X^{i}_{n-1},S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})=(x^{i},s,y,z^{i},\gamma_{i})\}</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>With slight
abuse of notation, we use the same symbols for the realizations of <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="footnote3.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variables.</span></span></span>.
Then the above problem is equivalent to</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\inf_{\phi^{i}\in\mathbb{R}}\mathbb{E}^{0,i}\Bigl[\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}(\beta x^{i}+\phi^{i}R_{n})\Bigr)V_{n}(s\widetilde{R}_{n},Y_{n},Z_{n}^{i},\gamma_{i})\bigr|x^{i},y,z^{i},\gamma_{i}\Bigr]\\
&amp;=\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n-1}}x^{i}\Bigr)\inf_{\phi^{i}\in\mathbb{R}}\Bigl\{p_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i}u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;\qquad\qquad+q_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i}d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\Bigr\},\end{split}" class="ltx_Math" display="block" id="S2.Ex12.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><munder><mo movablelimits="false">inf</mo><mrow><msup><mi>ϕ</mi><mi>i</mi></msup><mo>∈</mo><mi>ℝ</mi></mrow></munder><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>x</mi><mi>i</mi></msup></mrow><mo>+</mo><mrow><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><msub><mi>R</mi><mi>n</mi></msub></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mi>n</mi></msub></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false" mathsize="1.200em">|</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mo>=</mo><mi>exp</mi><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mo lspace="0em">−</mo><msub><mi>γ</mi><mi>i</mi></msub><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mfrac><msup><mi>x</mi><mi>i</mi></msup><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow><munder><mo lspace="0.167em" movablelimits="false" rspace="0em">inf</mo><mrow><msup><mi>ϕ</mi><mi>i</mi></msup><mo>∈</mo><mi>ℝ</mi></mrow></munder><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo stretchy="false">[</mo><msub><mi>V</mi><mi>n</mi></msub><mrow><mo stretchy="false">(</mo><mi>s</mi><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mo>+</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo stretchy="false">[</mo><msub><mi>V</mi><mi>n</mi></msub><mrow><mo stretchy="false">(</mo><mi>s</mi><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\inf_{\phi^{i}\in\mathbb{R}}\mathbb{E}^{0,i}\Bigl[\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}(\beta x^{i}+\phi^{i}R_{n})\Bigr)V_{n}(s\widetilde{R}_{n},Y_{n},Z_{n}^{i},\gamma_{i})\bigr|x^{i},y,z^{i},\gamma_{i}\Bigr]\\
&amp;=\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n-1}}x^{i}\Bigr)\inf_{\phi^{i}\in\mathbb{R}}\Bigl\{p_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i}u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;\qquad\qquad+q_{n-1}(s,y)e^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i}d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\Bigr\},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where we have used the property given in Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a> (vii).
Since <math alttext="d&lt;0&lt;u" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m9" intent=":literal"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mn>0</mn><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">d&lt;0&lt;u</annotation></semantics></math>, the optimal position <math alttext="\phi^{i,*}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m10" intent=":literal"><semantics><msup><mi>ϕ</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><annotation encoding="application/x-tex">\phi^{i,*}</annotation></semantics></math> is a.s. uniquely characterized by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;p_{n-1}(s,y)ue^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;\quad+q_{n-1}(s,y)de^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]=0.\end{split}" class="ltx_Math" display="block" id="S2.Ex13.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><mo>+</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;p_{n-1}(s,y)ue^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}u}\mathbb{E}^{0,i}[V_{n}(s\widetilde{u},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]\\
&amp;\quad+q_{n-1}(s,y)de^{-\gamma_{i}\frac{\beta^{N}}{\beta^{n}}\phi^{i,*}d}\mathbb{E}^{0,i}[V_{n}(s\widetilde{d},Y_{n},Z_{n}^{i},\gamma_{i})|y,z^{i},\gamma_{i}]=0.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">This gives the results given in <math alttext="(\ref{th-t1-eq1})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m11" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E3" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.3</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-eq1})</annotation></semantics></math>, which is well-defined and bounded since <math alttext="V_{n}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m12" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math> is a strictly positive and bounded,
and <math alttext="0&lt;p_{n-1},q_{n-1}&lt;1" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p2.m13" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&lt;</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0&lt;p_{n-1},q_{n-1}&lt;1</annotation></semantics></math> by our assumption.</p>
</div>
<div class="ltx_para" id="S2.Thmtheorem1.p3">
<p class="ltx_p">It follows that the function <math alttext="V_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m1" intent=":literal"><semantics><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">V_{n-1}</annotation></semantics></math> defined by <math alttext="(\ref{th-t1-eq2})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E4" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-eq2})</annotation></semantics></math> becomes once again a.s. strictly positive and bounded
on <math alttext="{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m3" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}_{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma</annotation></semantics></math>.
The value function at the next step <math alttext="t_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m4" intent=":literal"><semantics><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{n-1}</annotation></semantics></math> is now defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n-1}}X_{n-1}^{i}\Bigr)V_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})" class="ltx_Math" display="block" id="S2.Ex14.m1" intent=":literal"><semantics><mrow><mo rspace="0.167em">−</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">-\exp\Bigl(-\gamma_{i}\frac{\beta^{N}}{\beta^{n-1}}X_{n-1}^{i}\Bigr)V_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">and we have recovered the problem of the same form as in <math alttext="(\ref{th-t1-temp1})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E5" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.5</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-temp1})</annotation></semantics></math>.
Thus the repeat of the above procedures <math alttext="N" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p3.m6" intent=":literal"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> times yields the desired conclusion.
∎</p>
</div>
</div>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Mean-field equilibrium under stochastic order flow</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p">Our goal is to find a set of functions <math alttext="p_{n}(s,y),(s,y)\in{\cal S}_{n}\times{\cal Y}_{n},0\leq n\leq N-1" class="ltx_Math" display="inline" id="S2.SS3.p1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><mo>,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow><annotation encoding="application/x-tex">p_{n}(s,y),(s,y)\in{\cal S}_{n}\times{\cal Y}_{n},0\leq n\leq N-1</annotation></semantics></math> that specify the transition probabilities at every node
so that supply and demand match among the agents.
To ensure generality, we also incorporate an external stochastic order flow, <math alttext="L_{n-1}(S_{n-1},Y_{n-1})" class="ltx_Math" display="inline" id="S2.SS3.p1.m2" intent=":literal"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">L_{n-1}(S_{n-1},Y_{n-1})</annotation></semantics></math>,
which represents the stock supply per capita at each time <math alttext="t=t_{n-1}" class="ltx_Math" display="inline" id="S2.SS3.p1.m3" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t=t_{n-1}</annotation></semantics></math>, for <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.SS3.p1.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>.
The external order flow serves to model the net contribution from other populations or from a major financial institution,
such as a central bank.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S2.Thmassumption3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 2.3</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmassumption3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">For every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmassumption3.p1.m1" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>, <math alttext="L_{n-1}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.Thmassumption3.p1.m2" intent=":literal"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">L_{n-1}:{\cal S}_{n-1}\times{\cal Y}_{n-1}\rightarrow\mathbb{R}</annotation></semantics></math>
is a bounded measurable function.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S2.Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 2.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmdefinition1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">We say that the system is in the mean-field equilibrium if</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lim_{N_{p}\rightarrow\infty}\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})=L_{n-1}(S_{n-1},Y_{n-1})," class="ltx_Math" display="block" id="S2.Ex15.m1" intent=":literal"><semantics><mrow><mrow><mrow><munder><mo movablelimits="false">lim</mo><mrow><msub><mi>N</mi><mi>p</mi></msub><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\lim_{N_{p}\rightarrow\infty}\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})=L_{n-1}(S_{n-1},Y_{n-1}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><math alttext="\mathbb{P}" class="ltx_Math" display="inline" id="S2.Thmdefinition1.p1.m1" intent=":literal"><semantics><mi>ℙ</mi><annotation encoding="application/x-tex">\mathbb{P}</annotation></semantics></math><span class="ltx_text ltx_font_italic">-a.s. for every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmdefinition1.p1.m2" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math> with <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S2.Thmdefinition1.p1.m3" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> defined by <math alttext="(\ref{th-t1-eq1})" class="ltx_Math" display="inline" id="S2.Thmdefinition1.p1.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.E3" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.3</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-eq1})</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p">Since <math alttext="(Z^{i},\gamma_{i}),i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS3.p2.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi>Z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>,</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">(Z^{i},\gamma_{i}),i\in\mathbb{N}</annotation></semantics></math> are independent and identically distributed and also independent of the process <math alttext="(S,Y)" class="ltx_Math" display="inline" id="S2.SS3.p2.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S,Y)</annotation></semantics></math>, the above condition for the mean-field equilibrium is equivalently expressed as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}^{1}\bigl[\phi^{1,*}_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})\bigr]=L_{n-1}(s,y)" class="ltx_Math" display="block" id="S2.E6.m1" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{1}\bigl[\phi^{1,*}_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})\bigr]=L_{n-1}(s,y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for every <math alttext="(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S2.SS3.p2.m3" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.SS3.p2.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>.
Under the mean-field equilibrium, the excess demand/supply per capita converges to zero as the population size tends to infinity. Our first main result for this paper is then established as follows.
One can observe conditional McKean-Vlasov nature
as expected from the result in Fujii &amp; Sekine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib20" title="">20</a>]</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S2.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem 2.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S2.Thmtheorem2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let Assumptions <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption2" title="Assumption 2.2. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption3" title="Assumption 2.3. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.3</span></a> be in force.
Then there exists a unique mean-field equilibrium and the associated transition probabilities of the stock are given by</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;p_{n-1}(s,y):=\mathbb{P}^{0}\Bigl(S_{n}=\widetilde{u}S_{n-1}|(S_{n-1},Y_{n-1})=(s,y)\Bigr)\\
&amp;=(-d)\Big/\Bigl\{u\exp\Bigl(\frac{1}{\mathbb{E}^{1}[1/\gamma_{1}]}\Bigl[\mathbb{E}^{1}\Bigl(\frac{\log(f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1}))}{\gamma_{1}}\Bigr)-(u-d)\frac{\beta^{N}}{\beta^{n}}L_{n-1}(s,y)\Bigr]\Bigr)-d\Bigr\},\end{split}" class="ltx_Math" display="block" id="S2.E7.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo fence="false">|</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true" symmetric="true">/</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><mi>u</mi><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><mn>1</mn><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo>−</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>N</mi></msup><msup><mi>β</mi><mi>n</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo>−</mo><mi>d</mi></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;p_{n-1}(s,y):=\mathbb{P}^{0}\Bigl(S_{n}=\widetilde{u}S_{n-1}|(S_{n-1},Y_{n-1})=(s,y)\Bigr)\\
&amp;=(-d)\Big/\Bigl\{u\exp\Bigl(\frac{1}{\mathbb{E}^{1}[1/\gamma_{1}]}\Bigl[\mathbb{E}^{1}\Bigl(\frac{\log(f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1}))}{\gamma_{1}}\Bigr)-(u-d)\frac{\beta^{N}}{\beta^{n}}L_{n-1}(s,y)\Bigr]\Bigr)-d\Bigr\},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.m1" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.m2" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>.
Moreover, under the above transition probabilities, there exists some positive constant <math alttext="C_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.m3" intent=":literal"><semantics><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">C_{n-1}</annotation></semantics></math> such that</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})-L_{n-1}(S_{n-1},Y_{n-1})\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}" class="ltx_Math" display="block" id="S2.E8.m1" intent=":literal"><semantics><mrow><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>−</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup></mrow><mo>≤</mo><mfrac><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>N</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\mathbb{E}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(S_{n-1},Y_{n-1},Z_{n-1}^{i},\gamma_{i})-L_{n-1}(S_{n-1},Y_{n-1})\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>, which gives the convergence rate in the large population limit.</span></p>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.Thmtheorem2.p2">
<p class="ltx_p">The first claim <math alttext="(\ref{th-t2-eq1})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E7" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq1})</annotation></semantics></math> is a direct consequence of <math alttext="(\ref{th-t1-eq1})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E3" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.3</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-eq1})</annotation></semantics></math>. The form of <math alttext="(p_{n-1}(s,y))" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{n-1}(s,y))</annotation></semantics></math> is uniquely determined by
the condition <math alttext="(\ref{def-mfe-t})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E6" title="In 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{def-mfe-t})</annotation></semantics></math>. We only need to verify that it satisfies the condition (vii) in Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a>.
At <math alttext="t=N-1" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m5" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">t=N-1</annotation></semantics></math>, <math alttext="f_{N-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m6" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-1}</annotation></semantics></math> is an a.s. strictly positive and bounded function on <math alttext="{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m7" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma</annotation></semantics></math>
by the corresponding assumption on <math alttext="F" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m8" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>. Since <math alttext="d&lt;0&lt;u" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m9" intent=":literal"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mn>0</mn><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">d&lt;0&lt;u</annotation></semantics></math>, it is easy to see <math alttext="0&lt;p_{N-1}(s,y),q_{N-1}(s,y)&lt;1" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m10" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mrow><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><msub><mi>q</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0&lt;p_{N-1}(s,y),q_{N-1}(s,y)&lt;1</annotation></semantics></math> for every <math alttext="(s,y)\in{\cal S}_{N-1}\times{\cal Y}_{N-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m11" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{N-1}\times{\cal Y}_{N-1}</annotation></semantics></math>,
and hence consistent with the condition. This then implies that <math alttext="\phi^{i,*}_{N-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m12" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{N-1}</annotation></semantics></math> is an a.s. bounded function on <math alttext="{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m13" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma</annotation></semantics></math>, which results in a.s. strictly positive and bounded <math alttext="V_{N-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m14" intent=":literal"><semantics><msub><mi>V</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">V_{N-1}</annotation></semantics></math> given by <math alttext="(\ref{th-t1-eq2})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m15" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E4" title="In Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t1-eq2})</annotation></semantics></math>
on <math alttext="{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m16" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}_{N-1}\times{\cal Y}_{N-1}\times{\cal Z}_{N-1}\times\Gamma</annotation></semantics></math>. This in turn ensures that <math alttext="f_{N-2}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m17" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-2}</annotation></semantics></math> satisfies the desired properties,
and so do <math alttext="(p_{N-2}(s,y),q_{N-2}(s,y))" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m18" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>q</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{N-2}(s,y),q_{N-2}(s,y))</annotation></semantics></math>, <math alttext="(s,y)\in{\cal S}_{N-2}\times{\cal Y}_{N-2}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p2.m19" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{N-2}\times{\cal Y}_{N-2}</annotation></semantics></math>. By simple induction, we get the desired consistency
for every time step.</p>
</div>
<div class="ltx_para" id="S2.Thmtheorem2.p3">
<p class="ltx_p">For the second claim, it suffices to show that there is some constant <math alttext="C_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m1" intent=":literal"><semantics><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">C_{n-1}</annotation></semantics></math> such that an inequality</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\overline{\mathbb{E}}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})-L_{n-1}(s,y)\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}" class="ltx_Math" display="block" id="S2.Ex16.m1" intent=":literal"><semantics><mrow><mrow><mover accent="true"><mi>𝔼</mi><mo stretchy="true">¯</mo></mover><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>−</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup></mrow><mo>≤</mo><mfrac><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>N</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\overline{\mathbb{E}}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})-L_{n-1}(s,y)\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">holds for every <math alttext="(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m2" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m3" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>.
With the equilibrium transition probabilities given by <math alttext="(\ref{th-t2-eq1})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E7" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq1})</annotation></semantics></math>, one can show that the optimal position for agent-<math alttext="i" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m5" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\phi_{n-1}^{i,*}(s,y,Z_{n-1}^{i},\gamma_{i})&amp;=\frac{1}{(u-d)}\frac{\beta^{n}}{\beta^{N}}\Bigl\{\frac{\log f_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})}{\gamma_{i}}-\frac{1/\gamma_{i}}{\mathbb{E}^{1}[1/\gamma_{1}]}\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}\Bigr]\Bigr\}\\
&amp;+\frac{1/\gamma_{i}}{\mathbb{E}^{1}[1/\gamma_{1}]}L_{n-1}(s,y).\end{split}" class="ltx_Math" display="block" id="S2.E9.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo>−</mo><mrow><mfrac><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><mfrac><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\phi_{n-1}^{i,*}(s,y,Z_{n-1}^{i},\gamma_{i})&amp;=\frac{1}{(u-d)}\frac{\beta^{n}}{\beta^{N}}\Bigl\{\frac{\log f_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})}{\gamma_{i}}-\frac{1/\gamma_{i}}{\mathbb{E}^{1}[1/\gamma_{1}]}\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}\Bigr]\Bigr\}\\
&amp;+\frac{1/\gamma_{i}}{\mathbb{E}^{1}[1/\gamma_{1}]}L_{n-1}(s,y).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
2.9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Thanks to the i.i.d. property of <math alttext="(Z_{n-1}^{i},\gamma_{i})" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Z_{n-1}^{i},\gamma_{i})</annotation></semantics></math> and the boundedness of <math alttext="f_{n-1},L_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m7" intent=":literal"><semantics><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">f_{n-1},L_{n-1}</annotation></semantics></math> and <math alttext="1/\gamma_{i}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m8" intent=":literal"><semantics><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1/\gamma_{i}</annotation></semantics></math>,
it is easy to see that there exists some constant <math alttext="C_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m9" intent=":literal"><semantics><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">C_{n-1}</annotation></semantics></math> such that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\overline{\mathbb{E}}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})-L_{n-1}(s,y)\Bigr|^{2}\\
&amp;\leq\frac{C_{n-1}}{N_{p}}\mathbb{E}^{1}\left[\Bigl|\frac{1}{\gamma_{1}}-\mathbb{E}^{1}\Bigl(\frac{1}{\gamma_{1}}\Bigr)\Bigr|^{2}+\Bigl|\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}-\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}\Bigr]\Bigr|^{2}\right]\end{split}" class="ltx_Math" display="block" id="S2.Ex17.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mover accent="true"><mi>𝔼</mi><mo stretchy="true">¯</mo></mover><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>−</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>≤</mo><mrow><mfrac><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo>[</mo><mrow><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mfrac><mn>1</mn><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo>−</mo><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mn>1</mn><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo>−</mo><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mi>γ</mi><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup></mrow><mo>]</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\overline{\mathbb{E}}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}(s,y,Z_{n-1}^{i},\gamma_{i})-L_{n-1}(s,y)\Bigr|^{2}\\
&amp;\leq\frac{C_{n-1}}{N_{p}}\mathbb{E}^{1}\left[\Bigl|\frac{1}{\gamma_{1}}-\mathbb{E}^{1}\Bigl(\frac{1}{\gamma_{1}}\Bigr)\Bigr|^{2}+\Bigl|\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}-\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1})}{\gamma_{1}}\Bigr]\Bigr|^{2}\right]\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">which gives the desired result. Note that the variances in the left-hand side
are finite uniformly in <math alttext="(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m10" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">(s,y)\in{\cal S}_{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math> thanks to the boundedness of functions <math alttext="f_{n-1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m11" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{n-1}</annotation></semantics></math> and <math alttext="1/\gamma_{i}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p3.m12" intent=":literal"><semantics><mrow><mn>1</mn><mo>/</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1/\gamma_{i}</annotation></semantics></math>.
∎</p>
</div>
</div>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Some implications</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p">Let us consider some implications of the above findings. For simplicity, assume first that there is no external order flow <math alttext="L\equiv 0" class="ltx_Math" display="inline" id="S2.SS4.p1.m1" intent=":literal"><semantics><mrow><mi>L</mi><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L\equiv 0</annotation></semantics></math>.
Recalling that the risk-neutral probability of the up-move at each node is <math alttext="p^{\mathbb{Q}}=\frac{(-d)}{u-d}" class="ltx_Math" display="inline" id="S2.SS4.p1.m2" intent=":literal"><semantics><mrow><msup><mi>p</mi><mi>ℚ</mi></msup><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">p^{\mathbb{Q}}=\frac{(-d)}{u-d}</annotation></semantics></math>,
one can see from <math alttext="(\ref{th-t2-eq1})" class="ltx_Math" display="inline" id="S2.SS4.p1.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E7" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq1})</annotation></semantics></math> that <math alttext="p_{n-1}(s,y)&gt;p^{\mathbb{Q}}" class="ltx_Math" display="inline" id="S2.SS4.p1.m4" intent=":literal"><semantics><mrow><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><msup><mi>p</mi><mi>ℚ</mi></msup></mrow><annotation encoding="application/x-tex">p_{n-1}(s,y)&gt;p^{\mathbb{Q}}</annotation></semantics></math> (i.e. positive excess return at this node)
occurs if and only if <math alttext="\mathbb{E}^{1}[\log(f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1}))/\gamma_{1}]&lt;0" class="ltx_Math" display="inline" id="S2.SS4.p1.m5" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>/</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}^{1}[\log(f_{n-1}(s,y,Z_{n-1}^{1},\gamma_{1}))/\gamma_{1}]&lt;0</annotation></semantics></math>.
This happens if <math alttext="V_{n}" class="ltx_Math" display="inline" id="S2.SS4.p1.m6" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math>, which is determined by the function <math alttext="F" class="ltx_Math" display="inline" id="S2.SS4.p1.m7" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>,
is a decreasing function of <math alttext="s" class="ltx_Math" display="inline" id="S2.SS4.p1.m8" intent=":literal"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>. In Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4" title="4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>, we shall see numerical examples confirming this point.
The corresponding situation occurs when the agents’ liability (<math alttext="(-1)\times" class="ltx_math_unparsed" display="inline" id="S2.SS4.p1.m9" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mo lspace="0em">−</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">(-1)\times</annotation></semantics></math> endowment) decreases when the stock price goes up.
In this case, adding to the long position in the stock increases the risk, and hence the agents require higher risk premium.
Therefore, for a liability whose size varies countercyclically, the more levered financial and investment firms are, the higher the risk premium is demanded.Suppose, on the other hand, that the agents’ liability increases when the stock price goes up.
For example, imagine that agents have net short position in call options on the stock.
Then, the agents have a strong incentive to increase the long position in the same stock, and hence may accept even a negative risk premium.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p">As one can see from <math alttext="(\ref{th-t2-eq1})" class="ltx_Math" display="inline" id="S2.SS4.p2.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E7" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq1})</annotation></semantics></math>, there is no need to add idiosyncratic shocks to control the size of risk premium,
which is mainly determined by the sensitivity of the liability to the stock price.
However, the absence of idiosyncratic shocks gives rise to a very unrealistic market
where there is no trade among the agents. From the expression of the optimal position in <math alttext="(\ref{th-t2-eq3})" class="ltx_Math" display="inline" id="S2.SS4.p2.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E9" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.9</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq3})</annotation></semantics></math>,
we can observe that the trading volume per capita
<math alttext="\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S2.SS4.p2.m3" intent=":literal"><semantics><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}</annotation></semantics></math> in the market is dictated by the variation of the idiosyncratic factors.
Note that, by the definition of the mean-field equilibrium, <math alttext="\mathbb{E}[\phi^{i,*}_{n}]=0,\forall i\in\mathbb{N}" class="ltx_Math" display="inline" id="S2.SS4.p2.m4" intent=":literal"><semantics><mrow><mrow><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">∀</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\phi^{i,*}_{n}]=0,\forall i\in\mathbb{N}</annotation></semantics></math> when <math alttext="L_{n}=0" class="ltx_Math" display="inline" id="S2.SS4.p2.m5" intent=":literal"><semantics><mrow><msub><mi>L</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_{n}=0</annotation></semantics></math>.
Therefore, <math alttext="\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S2.SS4.p2.m6" intent=":literal"><semantics><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}</annotation></semantics></math> gives the standard deviation of the stock position among the agents
at time <math alttext="t=t_{n}" class="ltx_Math" display="inline" id="S2.SS4.p2.m7" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">t=t_{n}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p">In addition to the condition <math alttext="L\equiv 0" class="ltx_Math" display="inline" id="S2.SS4.p3.m1" intent=":literal"><semantics><mrow><mi>L</mi><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L\equiv 0</annotation></semantics></math>, let us now suppose that the function <math alttext="F" class="ltx_Math" display="inline" id="S2.SS4.p3.m2" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is independent of the stock price.
We then have <math alttext="f_{N-1}=1" class="ltx_Math" display="inline" id="S2.SS4.p3.m3" intent=":literal"><semantics><mrow><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_{N-1}=1</annotation></semantics></math> a.s. since <math alttext="V_{N}" class="ltx_Math" display="inline" id="S2.SS4.p3.m4" intent=":literal"><semantics><msub><mi>V</mi><mi>N</mi></msub><annotation encoding="application/x-tex">V_{N}</annotation></semantics></math> is <math alttext="S_{N}" class="ltx_Math" display="inline" id="S2.SS4.p3.m5" intent=":literal"><semantics><msub><mi>S</mi><mi>N</mi></msub><annotation encoding="application/x-tex">S_{N}</annotation></semantics></math>-independent and thus <math alttext="\phi^{i,*}_{N-1}=0" class="ltx_Math" display="inline" id="S2.SS4.p3.m6" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi^{i,*}_{N-1}=0</annotation></semantics></math> a.s. by <math alttext="(\ref{th-t2-eq3})" class="ltx_Math" display="inline" id="S2.SS4.p3.m7" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E9" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.9</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq3})</annotation></semantics></math>.
This in turn makes <math alttext="V_{N-1}" class="ltx_Math" display="inline" id="S2.SS4.p3.m8" intent=":literal"><semantics><msub><mi>V</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">V_{N-1}</annotation></semantics></math> independent from <math alttext="S_{N-1}" class="ltx_Math" display="inline" id="S2.SS4.p3.m9" intent=":literal"><semantics><msub><mi>S</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">S_{N-1}</annotation></semantics></math>.
In this way, a simple induction shows that <math alttext="f_{n-1}=1" class="ltx_Math" display="inline" id="S2.SS4.p3.m10" intent=":literal"><semantics><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_{n-1}=1</annotation></semantics></math> a.s. for every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S2.SS4.p3.m11" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>
and the equilibrium price distribution becomes equal to the one in the risk-neutral measure.
In this case, there is no trade in the market although each agent has different risk aversion,
which corresponds to the classical (but a bit uninteresting) example of the representative agent with CARA utility.</p>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p">Finally, let us turn on the external order flow. It is clearly seen from <math alttext="(\ref{th-t2-eq1})" class="ltx_Math" display="inline" id="S2.SS4.p4.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E7" title="In Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-t2-eq1})</annotation></semantics></math>, the positive inflow <math alttext="L&gt;0" class="ltx_Math" display="inline" id="S2.SS4.p4.m2" intent=":literal"><semantics><mrow><mi>L</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L&gt;0</annotation></semantics></math>
to the stock market
increases the equilibrium risk premium. This may sound slightly counter intuitive since we think a big sell-off in the stock should lead to
a sharp decline in the stock price. In order to understand that there is no contradiction,
it is important to recall that what we have found above is the transition probabilities so that there exists equilibrium.
If there is positive supply of the stock, the agents must accept larger long position (and hence larger risk) in the stock to maintain
the balance of demand and supply. Thus the agents require higher risk premium to compensate this additional risk.
If the risk premium is not high enough, there would be no equilibrium and thus the stock market might crash.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Recursive utility optimization with path-dependent cash flows</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p">In the previous section, we obtained mean-field equilibrium by choosing appropriate transition probabilities in the form of <math alttext="p_{n}(s,y)" class="ltx_Math" display="inline" id="S3.p1.m1" intent=":literal"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{n}(s,y)</annotation></semantics></math>.
Suppose now that the stochastic liability (or <math alttext="(-1)" class="ltx_Math" display="inline" id="S3.p1.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-1)</annotation></semantics></math> endowment) <math alttext="F" class="ltx_Math" display="inline" id="S3.p1.m3" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is dependent
not only on the terminal stock price <math alttext="S_{N}" class="ltx_Math" display="inline" id="S3.p1.m4" intent=":literal"><semantics><msub><mi>S</mi><mi>N</mi></msub><annotation encoding="application/x-tex">S_{N}</annotation></semantics></math> but also on the stock-price history <math alttext="(S_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.p1.m5" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n})_{n=0}^{N}</annotation></semantics></math>,
which is just as plausible as the previous case. In this case, a quick inspection of the proofs for Theorems <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmtheorem2" title="Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a> shows that the transition probabilities of the simple form <math alttext="p_{n}(s,y)" class="ltx_Math" display="inline" id="S3.p1.m6" intent=":literal"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{n}(s,y)</annotation></semantics></math> can not clear the market anymore.
It strongly suggests that we need path-dependence also in the transition probabilities.
We also want to examine if we can include cash spending (i.e. nominal consumption) and to know its impact on the excess return.
In this section, we shall thus adopt recursive utility that incorporates
standard time-separable utility over nominal consumptions as its special case. We include a path-dependent terminal liability as well as
path-dependent incremental endowments in the model.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>The setup and notation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p">In this section, for each <math alttext="i\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.m1" intent=":literal"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">i\in\mathbb{N}</annotation></semantics></math>,
we assume that the probability space <math alttext="(\Omega^{i},{\cal F}^{i},({\cal F}^{i}_{t_{n}})_{n=0}^{N},\mathbb{P}^{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega^{i},{\cal F}^{i},({\cal F}^{i}_{t_{n}})_{n=0}^{N},\mathbb{P}^{i})</annotation></semantics></math> is
endowed with <math alttext="(\xi_{i},\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>ξ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\xi_{i},\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})</annotation></semantics></math> as <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variables
in addition to <math alttext="({\cal F}_{t_{n}}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.m5" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">({\cal F}_{t_{n}}^{i})_{n=0}^{N}</annotation></semantics></math>-adapted stochastic process <math alttext="(Z_{n}^{i}=Z^{i}(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.m6" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>=</mo><mrow><msup><mi>Z</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i}=Z^{i}(t_{n}))_{n=0}^{N}</annotation></semantics></math>.
Here, <math alttext="\zeta_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.m7" intent=":literal"><semantics><msub><mi>ζ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\zeta_{i}</annotation></semantics></math> is the coefficient of absolute risk aversion for cash spending and the parameter <math alttext="\psi_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.m8" intent=":literal"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math> is used
to control the importance of the continuation utility relative to the current spending.
<math alttext="\delta_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.m9" intent=":literal"><semantics><msub><mi>δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\delta_{i}</annotation></semantics></math> denotes the coefficient of time preference. We introduce an <math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.m10" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable 4-tuple
<math alttext="\varrho_{i}:=(\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.m11" intent=":literal"><semantics><mrow><msub><mi>ϱ</mi><mi>i</mi></msub><mo>:=</mo><mrow><mo stretchy="false">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\varrho_{i}:=(\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})</annotation></semantics></math> for simpler notation.
Let us also introduce the symbol <math alttext="{\bf{S}}^{n}:=(S_{0},S_{1},\cdots,S_{n})" class="ltx_Math" display="inline" id="S3.SS1.p1.m12" intent=":literal"><semantics><mrow><msup><mi>𝐒</mi><mi>n</mi></msup><mo>:=</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mn>0</mn></msub><mo>,</mo><msub><mi>S</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\bf{S}}^{n}:=(S_{0},S_{1},\cdots,S_{n})</annotation></semantics></math> to denote a stock-price trajectory
and <math alttext="{\bf{s}}^{n}=(s_{0},\cdots,s_{n})\in{\cal S}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.m13" intent=":literal"><semantics><mrow><msup><mi>𝐬</mi><mi>n</mi></msup><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mo>∈</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">{\bf{s}}^{n}=(s_{0},\cdots,s_{n})\in{\cal S}^{n}</annotation></semantics></math> as its specific realization.
For <math alttext="{\bf{s}}\in{\cal S}^{n-1}" class="ltx_Math" display="inline" id="S3.SS1.p1.m14" intent=":literal"><semantics><mrow><mi>𝐬</mi><mo>∈</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{\bf{s}}\in{\cal S}^{n-1}</annotation></semantics></math>, we also use the symbols <math alttext="({\bf{s}}\widetilde{u})^{n}:=({\bf{s}}^{n-1},s_{n-1}\widetilde{u})\in{\cal S}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.m15" intent=":literal"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>:=</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐬</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mo>∈</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">({\bf{s}}\widetilde{u})^{n}:=({\bf{s}}^{n-1},s_{n-1}\widetilde{u})\in{\cal S}^{n}</annotation></semantics></math>
and <math alttext="({\bf{s}}\widetilde{d})^{n}:=({\bf{s}}^{n-1},s_{n-1}\widetilde{d})\in{\cal S}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.m16" intent=":literal"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>:=</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐬</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mo>∈</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">({\bf{s}}\widetilde{d})^{n}:=({\bf{s}}^{n-1},s_{n-1}\widetilde{d})\in{\cal S}^{n}</annotation></semantics></math>.
As in the last section, we shall use the expressions such as
<math alttext="\mathbb{E}^{0,i}[~\cdot~|{\bf{s}},y,z^{i},\varrho_{i}]" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.m17" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo rspace="0.163em" stretchy="false">[</mo><mo rspace="0.330em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0,i}[~\cdot~|{\bf{s}},y,z^{i},\varrho_{i}]</annotation></semantics></math> for <math alttext="({\bf{s}},y,z^{i})\in{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}" class="ltx_Math" display="inline" id="S3.SS1.p1.m18" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y,z^{i})\in{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}</annotation></semantics></math>
to denote the conditional expectation <math alttext="\mathbb{E}^{0,i}[~\cdot~|{\bf{S}}^{n-1}={\bf{s}},Y_{n-1}=y,Z_{n-1}^{i}=z_{i},\varrho_{i}=\varrho_{i}]" class="ltx_math_unparsed" display="inline" id="S3.SS1.p1.m19" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo rspace="0.163em" stretchy="false">[</mo><mo rspace="0.330em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>𝐬</mi><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>z</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0,i}[~\cdot~|{\bf{S}}^{n-1}={\bf{s}},Y_{n-1}=y,Z_{n-1}^{i}=z_{i},\varrho_{i}=\varrho_{i}]</annotation></semantics></math>,
where, with the slight abuse of notation, the same symbol is used for a realization of <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.m20" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variable <math alttext="\varrho_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.m21" intent=":literal"><semantics><msub><mi>ϱ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\varrho_{i}</annotation></semantics></math>.
Except these points, we will use the same setup and notation given in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS1" title="2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a>.
Now, let us update Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmassumption1" title="Assumption 2.1. ‣ 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a> for this section.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S3.Thmassumption1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 3.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmassumption1.p1">
<p class="ltx_p">(i):<span class="ltx_text ltx_font_italic"> <math alttext="\widetilde{u}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m1" intent=":literal"><semantics><mover accent="true"><mi>u</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{u}</annotation></semantics></math> and <math alttext="\widetilde{d}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m2" intent=":literal"><semantics><mover accent="true"><mi>d</mi><mo>~</mo></mover><annotation encoding="application/x-tex">\widetilde{d}</annotation></semantics></math> are real constants satisfying</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0&lt;\widetilde{d}&lt;\exp(r\Delta)&lt;\widetilde{u}&lt;\infty." class="ltx_Math" display="block" id="S3.Ex1.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo>&lt;</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">0&lt;\widetilde{d}&lt;\exp(r\Delta)&lt;\widetilde{u}&lt;\infty.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">(ii):<span class="ltx_text ltx_font_italic"> Every <math alttext="(\xi^{i},\gamma_{i},\zeta_{i},\psi_{i},\delta_{i},(Z_{n}^{i})_{n=0}^{N}),i=1,2,\ldots" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m3" intent=":literal"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi>ξ</mi><mi>i</mi></msup><mo>,</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>i</mi></msub><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">)</mo></mrow><mo>,</mo><mi>i</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mn>2</mn><mo>,</mo><mi mathvariant="normal">…</mi></mrow></mrow><annotation encoding="application/x-tex">(\xi^{i},\gamma_{i},\zeta_{i},\psi_{i},\delta_{i},(Z_{n}^{i})_{n=0}^{N}),i=1,2,\ldots</annotation></semantics></math> has the same distribution.
<br class="ltx_break"/></span>(iii):<span class="ltx_text ltx_font_italic"> There exist real constants <math alttext="\underline{\xi},\overline{\xi}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m4" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>ξ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ξ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\xi},\overline{\xi}</annotation></semantics></math>, <math alttext="\underline{\gamma},\overline{\gamma}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m5" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>γ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\gamma},\overline{\gamma}</annotation></semantics></math>, <math alttext="\underline{\zeta},\overline{\zeta}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m6" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>ζ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ζ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\zeta},\overline{\zeta}</annotation></semantics></math>, <math alttext="\underline{\psi},\overline{\psi}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m7" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>ψ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ψ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\psi},\overline{\psi}</annotation></semantics></math>
and <math alttext="\underline{\delta},\overline{\delta}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m8" intent=":literal"><semantics><mrow><munder accentunder="true"><mi>δ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>δ</mi><mo stretchy="true">¯</mo></mover></mrow><annotation encoding="application/x-tex">\underline{\delta},\overline{\delta}</annotation></semantics></math> so that for every <math alttext="i\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m9" intent=":literal"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">i\in\mathbb{N}</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\xi_{i}\in[\underline{\xi},\overline{\xi}]\subset\mathbb{R},\\
&amp;\varrho_{i}:=(\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})\in\Gamma:=[\underline{\gamma},\overline{\gamma}]\times[\underline{\zeta},\overline{\zeta}]\times[\underline{\psi},\overline{\psi}]\times[\underline{\delta},\overline{\delta}]\subset(0,\infty)^{4}.\end{split}" class="ltx_Math" display="block" id="S3.Ex2.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>∈</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>ξ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ξ</mi><mo stretchy="true">¯</mo></mover><mo stretchy="false">]</mo></mrow><mo>⊂</mo><mi>ℝ</mi></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msub><mi>ϱ</mi><mi>i</mi></msub><mo>:=</mo><mrow><mo stretchy="false">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>δ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>∈</mo><mi mathvariant="normal">Γ</mi><mo>:=</mo><mrow><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>γ</mi><mo stretchy="true">¯</mo></mover><mo rspace="0.055em" stretchy="false">]</mo></mrow><mo rspace="0.222em">×</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>ζ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ζ</mi><mo stretchy="true">¯</mo></mover><mo rspace="0.055em" stretchy="false">]</mo></mrow><mo rspace="0.222em">×</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>ψ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ψ</mi><mo stretchy="true">¯</mo></mover><mo rspace="0.055em" stretchy="false">]</mo></mrow><mo rspace="0.222em">×</mo><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>δ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>δ</mi><mo stretchy="true">¯</mo></mover><mo stretchy="false">]</mo></mrow></mrow><mo>⊂</mo><msup><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><mn>4</mn></msup></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\xi_{i}\in[\underline{\xi},\overline{\xi}]\subset\mathbb{R},\\
&amp;\varrho_{i}:=(\gamma_{i},\zeta_{i},\psi_{i},\delta_{i})\in\Gamma:=[\underline{\gamma},\overline{\gamma}]\times[\underline{\zeta},\overline{\zeta}]\times[\underline{\psi},\overline{\psi}]\times[\underline{\delta},\overline{\delta}]\subset(0,\infty)^{4}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">(iv):<span class="ltx_text ltx_font_italic"> For every <math alttext="0\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m10" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0\leq n\leq N</annotation></semantics></math>, <math alttext="{\cal Z}_{n}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m11" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Z}_{n}</annotation></semantics></math> is a bounded subset
of <math alttext="\mathbb{R}^{d_{Z}}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m12" intent=":literal"><semantics><msup><mi>ℝ</mi><msub><mi>d</mi><mi>Z</mi></msub></msup><annotation encoding="application/x-tex">\mathbb{R}^{d_{Z}}</annotation></semantics></math>.
<br class="ltx_break"/></span>(v):<span class="ltx_text ltx_font_italic"> For each <math alttext="i" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m13" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math alttext="(Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m14" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math> is a Markov process i.e. <math alttext="\mathbb{E}^{i}[f(Z_{n}^{i})|{\cal F}_{t_{m}}^{i}]=\mathbb{E}^{i}[f(Z_{n}^{i})|Z_{m}^{i}]" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m15" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>m</mi></msub><mi>i</mi></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi>Z</mi><mi>m</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{i}[f(Z_{n}^{i})|{\cal F}_{t_{m}}^{i}]=\mathbb{E}^{i}[f(Z_{n}^{i})|Z_{m}^{i}]</annotation></semantics></math>
for every bounded measurable function <math alttext="f" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m16" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> on <math alttext="{\cal Z}_{n}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m17" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Z}_{n}</annotation></semantics></math> and <math alttext="m\leq n" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m18" intent=":literal"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\leq n</annotation></semantics></math>.
<br class="ltx_break"/></span>(vi):<span class="ltx_text ltx_font_italic"> <math alttext="(Y_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m19" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n})_{n=0}^{N}</annotation></semantics></math> is a Markov process i.e. <math alttext="\mathbb{E}^{0}[f(Y_{n})|{\cal F}_{t_{m}}^{0}]=\mathbb{E}^{0}[f(Y_{n})|Y_{m}]" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m20" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>m</mi></msub><mn>0</mn></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msub><mi>Y</mi><mi>m</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0}[f(Y_{n})|{\cal F}_{t_{m}}^{0}]=\mathbb{E}^{0}[f(Y_{n})|Y_{m}]</annotation></semantics></math>
for every bounded measurable function <math alttext="f" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m21" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> on <math alttext="{\cal Y}_{n}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m22" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><annotation encoding="application/x-tex">{\cal Y}_{n}</annotation></semantics></math> and <math alttext="m\leq n" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m23" intent=":literal"><semantics><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\leq n</annotation></semantics></math>.
<br class="ltx_break"/></span>(vii):<span class="ltx_text ltx_font_italic"> The transition probabilities of <math alttext="(S_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m24" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n})_{n=0}^{N}</annotation></semantics></math> satisfy, for every <math alttext="0\leq n\leq N-1" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m25" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0\leq n\leq N-1</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\bf{S}}^{n},Y_{n})=p_{n}({\bf{S}}^{n},Y_{n}),\\
\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\bf{S}}^{n},Y_{n})=q_{n}({\bf{S}}^{n},Y_{n}):=1-p_{n}({\bf{S}}^{n},Y_{n}),\end{split}" class="ltx_Math" display="block" id="S3.Ex3.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><mrow><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo fence="false">|</mo><mrow><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>q</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mn>1</mn><mo>−</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{u}S_{n}|{\bf{S}}^{n},Y_{n})=p_{n}({\bf{S}}^{n},Y_{n}),\\
\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\cal F}_{t_{n}}^{0})&amp;=\mathbb{P}^{0}(S_{n+1}=\widetilde{d}S_{n}|{\bf{S}}^{n},Y_{n})=q_{n}({\bf{S}}^{n},Y_{n}):=1-p_{n}({\bf{S}}^{n},Y_{n}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">where <math alttext="p_{n},q_{n}:{\cal S}^{n}\times{\cal Y}_{n}\rightarrow\mathbb{R},~0\leq n\leq N-1" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m26" intent=":literal"><semantics><mrow><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>,</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow><mo rspace="0.497em">,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">p_{n},q_{n}:{\cal S}^{n}\times{\cal Y}_{n}\rightarrow\mathbb{R},~0\leq n\leq N-1</annotation></semantics></math> are bounded measurable functions
satisfying</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0&lt;p_{n}({\bf{s}},y),q_{n}({\bf{s}},y)&lt;1" class="ltx_Math" display="block" id="S3.Ex4.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><msub><mi>q</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">0&lt;p_{n}({\bf{s}},y),q_{n}({\bf{s}},y)&lt;1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="({\bf{s}},y)\in{\cal S}^{n}\times{\cal Y}_{n}" class="ltx_Math" display="inline" id="S3.Thmassumption1.p1.m27" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y)\in{\cal S}^{n}\times{\cal Y}_{n}</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p">Under the above assumptions, we have, instead of <math alttext="(\ref{Y-conditional-1})" class="ltx_Math" display="inline" id="S3.SS1.p2.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S2.E1" title="In 2.1 The setup and notation ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Y-conditional-1})</annotation></semantics></math>, the relation</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}^{0}\bigl[f(S_{n+1})g(Y_{n+1})|{\cal F}_{t_{n}}^{0}]=\mathbb{E}^{0}[f(S_{n+1})|{\bf{S}}^{n},Y_{n}]\mathbb{E}^{0}[g(Y_{n+1})|Y_{n}],\quad 0\leq n\leq N-1," class="ltx_Math" display="block" id="S3.E1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>g</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}^{0}\bigl[f(S_{n+1})g(Y_{n+1})|{\cal F}_{t_{n}}^{0}]=\mathbb{E}^{0}[f(S_{n+1})|{\bf{S}}^{n},Y_{n}]\mathbb{E}^{0}[g(Y_{n+1})|Y_{n}],\quad 0\leq n\leq N-1,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for any bounded measurable functions <math alttext="f" class="ltx_Math" display="inline" id="S3.SS1.p2.m2" intent=":literal"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> and <math alttext="g" class="ltx_Math" display="inline" id="S3.SS1.p2.m3" intent=":literal"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="S3.Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Remark 3.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmremark1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">As in the last section, the condition <math alttext="0&lt;p_{n}({\bf{s}},y),q_{n}({\bf{s}},y)&lt;1,\forall({\bf{s}},y)\in{\cal S}^{n}\times{\cal Y}_{n},0\leq n\leq N-1" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>&lt;</mo><mrow><msub><mi>p</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mrow><msub><mi>q</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><mrow><mo>∀</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow></mrow><mo>,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">0&lt;p_{n}({\bf{s}},y),q_{n}({\bf{s}},y)&lt;1,\forall({\bf{s}},y)\in{\cal S}^{n}\times{\cal Y}_{n},0\leq n\leq N-1</annotation></semantics></math>
guarantees the equivalence of <math alttext="\mathbb{P}^{0}\circ S_{n}^{-1}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.m2" intent=":literal"><semantics><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0.222em" rspace="0.222em">∘</mo><msubsup><mi>S</mi><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{P}^{0}\circ S_{n}^{-1}</annotation></semantics></math> and <math alttext="\mathbb{Q}\circ S_{n}^{-1}" class="ltx_Math" display="inline" id="S3.Thmremark1.p1.m3" intent=":literal"><semantics><mrow><mi>ℚ</mi><mo lspace="0.222em" rspace="0.222em">∘</mo><msubsup><mi>S</mi><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{Q}\circ S_{n}^{-1}</annotation></semantics></math>. Hence the
system is arbitrage free.</span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The individual optimization problem</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p">In this section, as mentioned before, we assume that each agent-<math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.m1" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> not only engages in self-financing trading
with the money-market account and the risky stock, but she is also allowed to spend some cash at the beginning of each period. Moreover,
she receives a stochastic endowment at each time <math alttext="t_{n},1\leq n\leq N" class="ltx_Math" display="inline" id="S3.SS2.p1.m2" intent=":literal"><semantics><mrow><mrow><msub><mi>t</mi><mi>n</mi></msub><mo>,</mo><mn>1</mn></mrow><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">t_{n},1\leq n\leq N</annotation></semantics></math>.
Thus the wealth of the agent-<math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.m3" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> <math alttext="(X^{i}_{n}:=X^{i}(t_{n}))_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p1.m4" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>:=</mo><mrow><msup><mi>X</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(X^{i}_{n}:=X^{i}(t_{n}))_{n=0}^{N}</annotation></semantics></math> follows the dynamics</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}X_{n+1}^{i}&amp;=\exp(r\Delta)(X_{n}^{i}-c_{n}^{i}\Delta-\phi_{n}^{i})+\phi_{n}^{i}\widetilde{R}_{n+1}+g_{n+1}({\bf{S}}^{n+1},Y_{n+1},Z_{n+1}^{i})\\
&amp;=\beta(X_{n}^{i}-c_{n}^{i}\Delta)+\phi_{n}^{i}R_{n+1}+g_{n+1}({\bf{S}}^{n+1},Y_{n+1},Z_{n+1}^{i}),\end{split}" class="ltx_Math" display="block" id="S3.Ex5.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><msubsup><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>−</mo><mrow><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>−</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><msub><mi>g</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>−</mo><mrow><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><msub><mi>g</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}X_{n+1}^{i}&amp;=\exp(r\Delta)(X_{n}^{i}-c_{n}^{i}\Delta-\phi_{n}^{i})+\phi_{n}^{i}\widetilde{R}_{n+1}+g_{n+1}({\bf{S}}^{n+1},Y_{n+1},Z_{n+1}^{i})\\
&amp;=\beta(X_{n}^{i}-c_{n}^{i}\Delta)+\phi_{n}^{i}R_{n+1}+g_{n+1}({\bf{S}}^{n+1},Y_{n+1},Z_{n+1}^{i}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="X_{0}^{i}=\xi_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.m5" intent=":literal"><semantics><mrow><msubsup><mi>X</mi><mn>0</mn><mi>i</mi></msubsup><mo>=</mo><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_{0}^{i}=\xi_{i}</annotation></semantics></math>. Here, <math alttext="c_{n}^{i},0\leq n\leq N-1" class="ltx_Math" display="inline" id="S3.SS2.p1.m6" intent=":literal"><semantics><mrow><mrow><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><mn>0</mn></mrow><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">c_{n}^{i},0\leq n\leq N-1</annotation></semantics></math> denotes the cash spending at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S3.SS2.p1.m7" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>, which is scaled to the period’s rate.
<math alttext="g_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i}),1\leq n\leq N" class="ltx_Math" display="inline" id="S3.SS2.p1.m8" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mn>1</mn></mrow><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">g_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i}),1\leq n\leq N</annotation></semantics></math> is the stochastic endowment (i.e. income originating from the agent’s other business lines)
paid at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S3.SS2.p1.m9" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>, which is dependent on the stock-price trajectory <math alttext="{\bf{S}}^{n}" class="ltx_Math" display="inline" id="S3.SS2.p1.m10" intent=":literal"><semantics><msup><mi>𝐒</mi><mi>n</mi></msup><annotation encoding="application/x-tex">{\bf{S}}^{n}</annotation></semantics></math>
in addition to the common and the idiosyncratic shocks <math alttext="(Y_{n},Z_{n}^{i})" class="ltx_Math" display="inline" id="S3.SS2.p1.m11" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Y_{n},Z_{n}^{i})</annotation></semantics></math>. Recall that <math alttext="R_{n}:=\widetilde{R}_{n}-\exp(r\Delta)" class="ltx_Math" display="inline" id="S3.SS2.p1.m12" intent=":literal"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub><mo>:=</mo><mrow><msub><mover accent="true"><mi>R</mi><mo>~</mo></mover><mi>n</mi></msub><mo>−</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">R_{n}:=\widetilde{R}_{n}-\exp(r\Delta)</annotation></semantics></math>.
As discussed in Remark <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmremark2" title="Remark 2.2. ‣ 2.2 The individual optimization problem ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a>, including such stochastic endowments appears
to be almost unavoidable for a realistic model of financial firms.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p">We suppose that the <math alttext="({\cal F}^{0,i}_{t_{n}})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p2.m1" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">({\cal F}^{0,i}_{t_{n}})_{n=0}^{N}</annotation></semantics></math>-adapted process of utilities <math alttext="(U_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.SS2.p2.m2" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(U_{n}^{i})_{n=0}^{N}</annotation></semantics></math> are defined recursively by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;U_{n}^{i}:=-\frac{1}{\zeta_{i}}\log\Bigl\{e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\bigl(\mathbb{E}^{0,i}[e^{-\gamma_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\bigr)\Bigr)\Bigr\},\\
&amp;\leftrightarrow e^{-\zeta_{i}U_{n}^{i}}=e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\bigl(\mathbb{E}^{0,i}[e^{-\gamma_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\bigr)\Bigr),\end{split}" class="ltx_math_unparsed" display="block" id="S3.E2.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><mo>:=</mo><mrow><mo>−</mo><mrow><mfrac><mn>1</mn><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo stretchy="false">↔</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo>=</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;U_{n}^{i}:=-\frac{1}{\zeta_{i}}\log\Bigl\{e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\bigl(\mathbb{E}^{0,i}[e^{-\gamma_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\bigr)\Bigr)\Bigr\},\\
&amp;\leftrightarrow e^{-\zeta_{i}U_{n}^{i}}=e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\bigl(\mathbb{E}^{0,i}[e^{-\gamma_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\bigr)\Bigr),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with the terminal condition</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="U_{N}^{i}:=X_{N}^{i}-F({\bf{S}}^{N},Y_{N},Z_{N}^{i})." class="ltx_Math" display="block" id="S3.Ex6.m1" intent=":literal"><semantics><mrow><mrow><msubsup><mi>U</mi><mi>N</mi><mi>i</mi></msubsup><mo>:=</mo><mrow><msubsup><mi>X</mi><mi>N</mi><mi>i</mi></msubsup><mo>−</mo><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>N</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">U_{N}^{i}:=X_{N}^{i}-F({\bf{S}}^{N},Y_{N},Z_{N}^{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Each agent-<math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.m3" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> is supposed to solve the optimization problem</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sup_{(\phi_{n}^{i},c_{n}^{i})_{n=0}^{N-1}\in\mathbb{A}^{i}}U^{i}_{0}," class="ltx_Math" display="block" id="S3.E3.m1" intent=":literal"><semantics><mrow><mrow><munder><mo movablelimits="false">sup</mo><mrow><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo>∈</mo><msup><mi>𝔸</mi><mi>i</mi></msup></mrow></munder><msubsup><mi>U</mi><mn>0</mn><mi>i</mi></msubsup></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\sup_{(\phi_{n}^{i},c_{n}^{i})_{n=0}^{N-1}\in\mathbb{A}^{i}}U^{i}_{0},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">over the admissible space defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{A}^{i}:=\bigl\{(\phi_{n}^{i},c_{n}^{i})_{n=0}^{N-1};(\phi_{n}^{i},c_{n}^{i})\text{ is an ${\cal F}_{n}^{0,i}$-measurable $\mathbb{R}^{2}$-valued random variable}\bigr\}." class="ltx_Math" display="block" id="S3.Ex7.m1" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔸</mi><mi>i</mi></msup><mo>:=</mo><mrow><mo maxsize="1.200em" minsize="1.200em">{</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo>;</mo><mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mtext> is an </mtext><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>n</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><mtext>-measurable </mtext><msup><mi>ℝ</mi><mn>2</mn></msup><mtext>-valued random variable</mtext></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">}</mo></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\mathbb{A}^{i}:=\bigl\{(\phi_{n}^{i},c_{n}^{i})_{n=0}^{N-1};(\phi_{n}^{i},c_{n}^{i})\text{ is an ${\cal F}_{n}^{0,i}$-measurable $\mathbb{R}^{2}$-valued random variable}\bigr\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">For simplicity, we do not restrict <math alttext="(c_{n}^{i})" class="ltx_Math" display="inline" id="S3.SS2.p2.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(c_{n}^{i})</annotation></semantics></math> to non-negative values. One may interpret negative spending
as positive income from costly labor for the corresponding period.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S3.Thmassumption2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 3.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmassumption2.p1">
<p class="ltx_p">(i):<span class="ltx_text ltx_font_italic"> The function <math alttext="F:{\cal S}^{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmassumption2.p1.m1" intent=":literal"><semantics><mrow><mi>F</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>N</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>N</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>N</mi></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">F:{\cal S}^{N}\times{\cal Y}_{N}\times{\cal Z}_{N}\rightarrow\mathbb{R}</annotation></semantics></math> is measurable and bounded.
<br class="ltx_break"/></span>(ii):<span class="ltx_text ltx_font_italic"> For every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmassumption2.p1.m2" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>, the function <math alttext="g_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmassumption2.p1.m3" intent=":literal"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">g_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\rightarrow\mathbb{R}</annotation></semantics></math>
is measurable and bounded.</span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p">Before going into the details, let us consider the special case: <math alttext="\zeta_{i}=\gamma_{i}=\psi_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.m1" intent=":literal"><semantics><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>ψ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\zeta_{i}=\gamma_{i}=\psi_{i}</annotation></semantics></math>. In this case, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}e^{-\zeta_{i}U_{n}^{i}}&amp;=e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\mathbb{E}^{0,i}[e^{-\zeta_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\\
&amp;=e^{-\zeta_{i}c_{n}^{i}}\Delta+\mathbb{E}^{0,i}\bigl[\delta_{i}e^{-\zeta_{i}c_{n+1}^{i}}\Delta|{\cal F}_{t_{n}}^{0,i}\bigr]+\delta_{i}^{2}\mathbb{E}^{0,i}[e^{-\zeta_{i}U_{n+2}^{i}}|{\cal F}_{t_{n}}^{0,i}]\\
&amp;=\cdots=e^{-\zeta_{i}c_{n}^{i}}\Delta+\mathbb{E}^{0,i}\Bigl[\sum_{k=n+1}^{N-1}\delta_{i}^{k-n}e^{-\zeta_{i}c_{k}^{i}}\Delta+\delta_{i}^{N-n}e^{-\zeta_{i}U_{N}^{i}}|{\cal F}_{t_{n}}^{0,i}\Bigr],\end{split}" class="ltx_Math" display="block" id="S3.Ex8.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><mo>+</mo><mrow><msubsup><mi>δ</mi><mi>i</mi><mn>2</mn></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mi mathvariant="normal">⋯</mi><mo>=</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mrow><munderover><mo lspace="0em" movablelimits="false">∑</mo><mrow><mi>k</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msubsup><mi>δ</mi><mi>i</mi><mrow><mi>k</mi><mo>−</mo><mi>n</mi></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mi>k</mi><mi>i</mi></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo>+</mo><mrow><mrow><msubsup><mi>δ</mi><mi>i</mi><mrow><mi>N</mi><mo>−</mo><mi>n</mi></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mi>N</mi><mi>i</mi></msubsup></mrow></mrow></msup></mrow><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}e^{-\zeta_{i}U_{n}^{i}}&amp;=e^{-\zeta_{i}c_{n}^{i}}\Delta+\delta_{i}\mathbb{E}^{0,i}[e^{-\zeta_{i}U_{n+1}^{i}}|{\cal F}_{t_{n}}^{0,i}]\\
&amp;=e^{-\zeta_{i}c_{n}^{i}}\Delta+\mathbb{E}^{0,i}\bigl[\delta_{i}e^{-\zeta_{i}c_{n+1}^{i}}\Delta|{\cal F}_{t_{n}}^{0,i}\bigr]+\delta_{i}^{2}\mathbb{E}^{0,i}[e^{-\zeta_{i}U_{n+2}^{i}}|{\cal F}_{t_{n}}^{0,i}]\\
&amp;=\cdots=e^{-\zeta_{i}c_{n}^{i}}\Delta+\mathbb{E}^{0,i}\Bigl[\sum_{k=n+1}^{N-1}\delta_{i}^{k-n}e^{-\zeta_{i}c_{k}^{i}}\Delta+\delta_{i}^{N-n}e^{-\zeta_{i}U_{N}^{i}}|{\cal F}_{t_{n}}^{0,i}\Bigr],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">which thus corresponds to the standard time-separable utility over nominal consumptions. One can see that the parameter <math alttext="\psi_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.m2" intent=":literal"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math>
determines the relative importance of the continuation utility.
We now derive the optimal strategy for each agent with respect to the above-defined recursive utility.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem 3.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let Assumptions <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption1" title="Assumption 3.1. ‣ 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption2" title="Assumption 3.2. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a> be in force.
Then the problem <math alttext="(\ref{problem-R1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.E3" title="In 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.3</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{problem-R1})</annotation></semantics></math> has an unique optimal solution <math alttext="(\phi_{n-1}^{i,*},c_{n-1}^{i,*})_{n=1}^{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m2" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>,</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(\phi_{n-1}^{i,*},c_{n-1}^{i,*})_{n=1}^{N}</annotation></semantics></math>,
where <math alttext="(\phi_{n-1}^{i,*})_{n=1}^{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m3" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(\phi_{n-1}^{i,*})_{n=1}^{N}</annotation></semantics></math> and <math alttext="(c_{n-1}^{i,*})_{n=1}^{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m4" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(c_{n-1}^{i,*})_{n=1}^{N}</annotation></semantics></math> are a.s. bounded processes defined by
measurable functions <math alttext="\phi_{n-1}^{i,*}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m5" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">\phi_{n-1}^{i,*}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
and <math alttext="c_{n-1}^{i,*}:\mathbb{R}\times{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m6" intent=":literal"><semantics><mrow><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mi>ℝ</mi><mo lspace="0.222em" rspace="0.222em">×</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">c_{n-1}^{i,*}:\mathbb{R}\times{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
as <math alttext="\phi_{n-1}^{i,*}:=\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m7" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>:=</mo><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\phi_{n-1}^{i,*}:=\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})</annotation></semantics></math>
and <math alttext="c_{n-1}^{i,*}:=c^{i,*}_{n-1}(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m8" intent=":literal"><semantics><mrow><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>:=</mo><mrow><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">c_{n-1}^{i,*}:=c^{i,*}_{n-1}(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})</annotation></semantics></math> respectively,
where, for each <math alttext="(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\in\mathbb{R}\times{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m9" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><mi>ℝ</mi><mo lspace="0.222em" rspace="0.222em">×</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow></mrow><annotation encoding="application/x-tex">(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\in\mathbb{R}\times{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\phi_{n-1}^{i,*}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{1}{\gamma_{i}\eta_{n}^{i}(u-d)}\Bigl\{\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)+\log\bigl(f_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\bigr)\Bigr\},\end{split}" class="ltx_Math" display="block" id="S3.E4.m1" intent=":literal"><semantics><mtable displaystyle="true"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><mrow><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mfrac><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mfrac></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo>+</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\phi_{n-1}^{i,*}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{1}{\gamma_{i}\eta_{n}^{i}(u-d)}\Bigl\{\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)+\log\bigl(f_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\bigr)\Bigr\},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.4)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}c_{n-1}^{i,*}(x^{i},{\bf{s}},y,z^{i},\varrho_{i}):=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}-\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl\{\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}.\end{split}" class="ltx_Math" display="block" id="S3.E5.m1" intent=":literal"><semantics><mtable displaystyle="true"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><mrow><mrow><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mfrac><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>x</mi><mi>i</mi></msup></mrow><mo>−</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mfrac><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}c_{n-1}^{i,*}(x^{i},{\bf{s}},y,z^{i},\varrho_{i}):=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}-\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl\{\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><math alttext="f_{n-1}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m10" intent=":literal"><semantics><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">f_{n-1}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is an a.s. strictly positive and bounded
measurable function:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{n-1}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{\mathbb{E}^{0,i}\bigl[\exp\bigl(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]\bigr)|y,z^{i},\varrho_{i}\bigr]}{\mathbb{E}^{0,i}\bigl[\exp\bigl(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]\bigr)|y,z^{i},\varrho_{i}\bigr]}," class="ltx_Math" display="block" id="S3.E6.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mfrac><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">f_{n-1}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{\mathbb{E}^{0,i}\bigl[\exp\bigl(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]\bigr)|y,z^{i},\varrho_{i}\bigr]}{\mathbb{E}^{0,i}\bigl[\exp\bigl(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]\bigr)|y,z^{i},\varrho_{i}\bigr]},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">and <math alttext="V_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m11" intent=":literal"><semantics><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">V_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math> is an a.s. bounded measurable function
defined recursively by</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;V_{n-1}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{\eta_{n-1}^{i}}{\eta_{n}^{i}\gamma_{i}\beta}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})+\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl(\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\Bigr)-\frac{1}{\zeta_{i}}\log(\eta_{n-1}^{i}),\end{split}" class="ltx_Math" display="block" id="S3.E7.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mrow><mfrac><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow><mo>−</mo><mrow><mfrac><mn>1</mn><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;V_{n-1}({\bf{s}},y,z^{i},\varrho_{i}):=\frac{\eta_{n-1}^{i}}{\eta_{n}^{i}\gamma_{i}\beta}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})+\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl(\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\Bigr)-\frac{1}{\zeta_{i}}\log(\eta_{n-1}^{i}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">with</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\\
&amp;\quad:=p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi_{n-1}^{i,*}u}\mathbb{E}^{0,i}\bigl[\exp(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})])|y,z^{i},\varrho_{i}]\\
&amp;\quad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi_{n-1}^{i,*}d}\mathbb{E}^{0,i}\bigl[\exp(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})])|y,z^{i},\varrho_{i}],\end{split}" class="ltx_Math" display="block" id="S3.E8.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo lspace="1.278em">:=</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\\
&amp;\quad:=p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi_{n-1}^{i,*}u}\mathbb{E}^{0,i}\bigl[\exp(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})])|y,z^{i},\varrho_{i}]\\
&amp;\quad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi_{n-1}^{i,*}d}\mathbb{E}^{0,i}\bigl[\exp(\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})])|y,z^{i},\varrho_{i}],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">starting from the terminal condition <math alttext="V_{N}({\bf{S}}^{N},Y_{N},Z_{N}^{i},\varrho_{i}):=F({\bf{S}}^{N},Y_{N},Z_{N}^{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m12" intent=":literal"><semantics><mrow><mrow><msub><mi>V</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>N</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>N</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">V_{N}({\bf{S}}^{N},Y_{N},Z_{N}^{i},\varrho_{i}):=F({\bf{S}}^{N},Y_{N},Z_{N}^{i})</annotation></semantics></math>. <math alttext="(\eta_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m13" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(\eta_{n}^{i})_{n=0}^{N}</annotation></semantics></math> are strictly positive and bounded
<math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.m14" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable random variables given by the recursive relation:</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\eta_{n-1}^{i}:=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta},\quad\eta_{N}^{i}\equiv 1." class="ltx_Math" display="block" id="S3.E9.m1" intent=":literal"><semantics><mrow><mrow><mrow><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>:=</mo><mfrac><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac></mrow><mo rspace="1.167em">,</mo><mrow><msubsup><mi>η</mi><mi>N</mi><mi>i</mi></msubsup><mo>≡</mo><mn>1</mn></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\eta_{n-1}^{i}:=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta},\quad\eta_{N}^{i}\equiv 1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p2">
<p class="ltx_p">We first hypothesize that the utility <math alttext="U_{n}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m1" intent=":literal"><semantics><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">U_{n}^{i}</annotation></semantics></math> at <math alttext="t=t_{n}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m2" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">t=t_{n}</annotation></semantics></math> is given by the following form:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})=\eta_{n}^{i}X_{n}^{i}-V_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})," class="ltx_Math" display="block" id="S3.Ex9.m1" intent=":literal"><semantics><mrow><mrow><mrow><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo>−</mo><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})=\eta_{n}^{i}X_{n}^{i}-V_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="V_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m3" intent=":literal"><semantics><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">V_{n}:{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
is a measurable a.s. bounded function and <math alttext="\eta_{n}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m4" intent=":literal"><semantics><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">\eta_{n}^{i}</annotation></semantics></math> is <math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m5" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable
strictly positive and bounded random variable. The hypothesis obviously holds at the terminal point
with <math alttext="V_{N}({\bf{S}}^{N},Y_{N},Z_{N}^{i},\varrho_{i})=F({\bf{S}}^{N},Y_{N},Z_{N}^{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m6" intent=":literal"><semantics><mrow><mrow><msub><mi>V</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>N</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>N</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">V_{N}({\bf{S}}^{N},Y_{N},Z_{N}^{i},\varrho_{i})=F({\bf{S}}^{N},Y_{N},Z_{N}^{i})</annotation></semantics></math> and <math alttext="\eta_{N}^{i}\equiv 1" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m7" intent=":literal"><semantics><mrow><msubsup><mi>η</mi><mi>N</mi><mi>i</mi></msubsup><mo>≡</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\eta_{N}^{i}\equiv 1</annotation></semantics></math>.
We shall show by induction that our hypothesis holds in every period.
Under the hypothesis, the problem for the agent-<math alttext="i" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m8" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> at <math alttext="t_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m9" intent=":literal"><semantics><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{n-1}</annotation></semantics></math> becomes to find <math alttext="{\cal F}_{n-1}^{0,i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m10" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup><annotation encoding="application/x-tex">{\cal F}_{n-1}^{0,i}</annotation></semantics></math>-measurable strategy <math alttext="(\phi^{i},c^{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m11" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo>,</mo><msup><mi>c</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\phi^{i},c^{i})</annotation></semantics></math>
that solves</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\inf_{(\phi^{i},c^{i})}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\Bigl(\mathbb{E}^{0,i}\bigl[e^{-\gamma_{i}U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})}|{\cal F}_{n-1}^{0,i}\bigr]\Bigr)\Bigr)\Bigr\}." class="ltx_Math" display="block" id="S3.E10.m1" intent=":literal"><semantics><mrow><mrow><munder><mo movablelimits="false">inf</mo><mrow><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo>,</mo><msup><mi>c</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></munder><mrow><mo lspace="0em" maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>c</mi><mi>i</mi></msup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo fence="false">|</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msubsup></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\inf_{(\phi^{i},c^{i})}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\Bigl(\mathbb{E}^{0,i}\bigl[e^{-\gamma_{i}U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})}|{\cal F}_{n-1}^{0,i}\bigr]\Bigr)\Bigr)\Bigr\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">We consider the problem on the set <math alttext="\{(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m12" intent=":literal"><semantics><mrow><mo stretchy="false">{</mo><mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\}</annotation></semantics></math>.
By Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption1" title="Assumption 3.1. ‣ 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a> (vii), <math alttext="(\ref{Y-conditional-2})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m13" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E1" title="In 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Y-conditional-2})</annotation></semantics></math>, and the above hypothesis, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\mathbb{E}^{0,i}\Bigl[e^{-\gamma_{i}U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})}|x^{i},{\bf{s}},y^{i},z^{i},\varrho_{i}\Bigr]\\
&amp;=\mathbb{E}^{0,i}\Bigl[\exp\Bigl(-\gamma_{i}\eta_{n}^{i}\bigl(\beta(x^{i}-c^{i}\Delta)+\phi^{i}R_{n}+g_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i})\bigr)+\gamma_{i}V_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})\Bigr)|{\bf{s}},y,z^{i},\varrho_{i}\Bigr]\\
&amp;=e^{-\gamma_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\Bigl\{p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;\qquad\qquad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\Bigr\}.\end{split}" class="ltx_Math" display="block" id="S3.Ex10.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo fence="false">|</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><msup><mi>y</mi><mi>i</mi></msup><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><mrow><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msup><mi>c</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><msub><mi>R</mi><mi>n</mi></msub></mrow><mo>+</mo><mrow><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo fence="false">|</mo><mrow><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msup><mi>c</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mo>+</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\mathbb{E}^{0,i}\Bigl[e^{-\gamma_{i}U_{n}^{i}(X_{n}^{i},{\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})}|x^{i},{\bf{s}},y^{i},z^{i},\varrho_{i}\Bigr]\\
&amp;=\mathbb{E}^{0,i}\Bigl[\exp\Bigl(-\gamma_{i}\eta_{n}^{i}\bigl(\beta(x^{i}-c^{i}\Delta)+\phi^{i}R_{n}+g_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i})\bigr)+\gamma_{i}V_{n}({\bf{S}}^{n},Y_{n},Z_{n}^{i},\varrho_{i})\Bigr)|{\bf{s}},y,z^{i},\varrho_{i}\Bigr]\\
&amp;=e^{-\gamma_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\Bigl\{p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;\qquad\qquad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\Bigr\}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Thus the problem <math alttext="(\ref{problem-R-intermediate})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p2.m14" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E10" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.10</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{problem-R-intermediate})</annotation></semantics></math> can be restated as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\inf_{(\phi^{i},c^{i})}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\\
&amp;\times\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\Bigl\{p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;\qquad\qquad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\Bigr\}\Bigr)\Bigr\}.\end{split}" class="ltx_Math" display="block" id="S3.Ex11.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><munder><mo movablelimits="false">inf</mo><mrow><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo>,</mo><msup><mi>c</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow></munder><mrow><mo lspace="0em" maxsize="1.600em" minsize="1.600em">{</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>c</mi><mi>i</mi></msup></mrow></mrow></msup><mi mathvariant="normal">Δ</mi><mo>+</mo><msub><mi>δ</mi><mi>i</mi></msub><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msup><mi>c</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mo rspace="0.222em">×</mo><mi>exp</mi><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mi>log</mi><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><mo>+</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false">|</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\inf_{(\phi^{i},c^{i})}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\\
&amp;\times\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\Bigl\{p_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;\qquad\qquad+q_{n-1}({\bf{s}},y)e^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\Bigr\}\Bigr)\Bigr\}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.Thmtheorem1.p3">
<p class="ltx_p">The optimization over <math alttext="(\phi^{i},c^{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo>,</mo><msup><mi>c</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\phi^{i},c^{i})</annotation></semantics></math> can now be solved separately. Since <math alttext="d&lt;0&lt;u" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m2" intent=":literal"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mn>0</mn><mo>&lt;</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">d&lt;0&lt;u</annotation></semantics></math>, the optimal <math alttext="\phi^{i,*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m3" intent=":literal"><semantics><msup><mi>ϕ</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><annotation encoding="application/x-tex">\phi^{i,*}</annotation></semantics></math>
is characterized uniquely by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}0&amp;=p_{n-1}({\bf{s}},y)ue^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;+q_{n-1}({\bf{s}},y)de^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr],\end{split}" class="ltx_Math" display="block" id="S3.Ex12.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>u</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>ϕ</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>V</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>−</mo><mrow><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>𝐬</mi><mo lspace="0em" rspace="0em">​</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></msup><mo fence="false">|</mo><mrow><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}0&amp;=p_{n-1}({\bf{s}},y)ue^{-\gamma_{i}\eta_{n}^{i}\phi^{i}u}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{u})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr]\\
&amp;+q_{n-1}({\bf{s}},y)de^{-\gamma_{i}\eta_{n}^{i}\phi^{i}d}\mathbb{E}^{0,i}\bigl[e^{\gamma_{i}[V_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i},\varrho_{i})-\eta_{n}^{i}g_{n}(({\bf{s}}\widetilde{d})^{n},Y_{n},Z_{n}^{i})]}|y,z^{i},\varrho_{i}\bigr],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">which gives the desired solution <math alttext="(\ref{th-R1-phinm1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E4" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-phinm1})</annotation></semantics></math> for <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m5" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> with <math alttext="f_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m6" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{n-1}</annotation></semantics></math> defined as in <math alttext="(\ref{th-R1-fnm1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m7" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E6" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-fnm1})</annotation></semantics></math>.
Thanks to the boundedness of <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m8" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> and our hypothesis on <math alttext="V_{n}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m9" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math>, <math alttext="f_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m10" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{n-1}</annotation></semantics></math> is proved to be an a.s. strictly positive and bounded function
on <math alttext="{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m11" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma</annotation></semantics></math>. Combined with the assumption on <math alttext="(p_{n-1},q_{n-1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m12" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{n-1},q_{n-1})</annotation></semantics></math>
and our hypothesis on <math alttext="\eta_{n}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m13" intent=":literal"><semantics><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">\eta_{n}^{i}</annotation></semantics></math>, <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m14" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> is also a.s. bounded on <math alttext="{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p3.m15" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.Thmtheorem1.p4">
<p class="ltx_p">With <math alttext="\widetilde{V}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m1" intent=":literal"><semantics><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\widetilde{V}_{n-1}</annotation></semantics></math> defined as in <math alttext="(\ref{th-R1-Vtildenm1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_missing_label ltx_mathvariant_italic"><span class="ltx_ref ltx_missing_label ltx_font_italic ltx_ref_self">LABEL:th-R1-Vtildenm1</span></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-Vtildenm1})</annotation></semantics></math>, the optimization with respect to <math alttext="c^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m3" intent=":literal"><semantics><msup><mi>c</mi><mi>i</mi></msup><annotation encoding="application/x-tex">c^{i}</annotation></semantics></math> reduces to</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\inf_{c^{i}}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}." class="ltx_Math" display="block" id="S3.Ex13.m1" intent=":literal"><semantics><mrow><mrow><munder><mo movablelimits="false">inf</mo><msup><mi>c</mi><mi>i</mi></msup></munder><mrow><mo lspace="0em" maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>c</mi><mi>i</mi></msup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msup><mi>c</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\inf_{c^{i}}\Bigl\{e^{-\zeta_{i}c^{i}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Thus the optimal solution is characterized by the equation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="0=-\zeta_{i}e^{-\zeta_{i}c^{i}}+\delta_{i}\psi_{i}\eta_{n}^{i}\beta e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)," class="ltx_Math" display="block" id="S3.E11.m1" intent=":literal"><semantics><mrow><mrow><mn>0</mn><mo>=</mo><mrow><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>c</mi><mi>i</mi></msup></mrow></mrow></msup></mrow></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msup><mi>c</mi><mi>i</mi></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">0=-\zeta_{i}e^{-\zeta_{i}c^{i}}+\delta_{i}\psi_{i}\eta_{n}^{i}\beta e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which gives the unique solution <math alttext="c_{n-1}^{i,*}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m4" intent=":literal"><semantics><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">c_{n-1}^{i,*}</annotation></semantics></math> in <math alttext="(\ref{th-R1-cnm1})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E5" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.5</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-cnm1})</annotation></semantics></math> as desired. Note that it is a.s. bounded if the wealth <math alttext="x^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m6" intent=":literal"><semantics><msup><mi>x</mi><mi>i</mi></msup><annotation encoding="application/x-tex">x^{i}</annotation></semantics></math>
at <math alttext="t_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m7" intent=":literal"><semantics><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">t_{n-1}</annotation></semantics></math> is bounded. Therefore, once our induction is complete, the spending process is shown to be a.s. bounded since <math alttext="\xi_{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m8" intent=":literal"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_{i}</annotation></semantics></math> takes
values in a bounded interval <math alttext="[\underline{\xi},\overline{\xi}]" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p4.m9" intent=":literal"><semantics><mrow><mo stretchy="false">[</mo><munder accentunder="true"><mi>ξ</mi><mo stretchy="true">¯</mo></munder><mo>,</mo><mover accent="true"><mi>ξ</mi><mo stretchy="true">¯</mo></mover><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\underline{\xi},\overline{\xi}]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.Thmtheorem1.p5">
<p class="ltx_p">In order to complete the induction argument, we need to obtain the utility <math alttext="U_{n-1}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m1" intent=":literal"><semantics><msubsup><mi>U</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><annotation encoding="application/x-tex">U_{n-1}^{i}</annotation></semantics></math> for the next period.
By <math alttext="(\ref{def-RU})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E2" title="In 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{def-RU})</annotation></semantics></math>, it satisfies</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e^{-\zeta_{i}U_{n-1}^{i}}=e^{-\zeta_{i}c^{i,*}_{n-1}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i,*}_{n-1}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)." class="ltx_Math" display="block" id="S3.Ex14.m1" intent=":literal"><semantics><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>U</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow></msup><mo>=</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>i</mi></msup><mo>−</mo><mrow><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">e^{-\zeta_{i}U_{n-1}^{i}}=e^{-\zeta_{i}c^{i,*}_{n-1}}\Delta+\delta_{i}e^{-\psi_{i}\eta_{n}^{i}\beta(x^{i}-c^{i,*}_{n-1}\Delta)}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">The right-hand side of the above equality can be evaluated by using <math alttext="(\ref{th-R1-c_dummy})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E11" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.11</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-c_dummy})</annotation></semantics></math> as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;e^{-\zeta_{i}c^{i,*}_{n-1}}\Delta+\frac{1}{\psi_{i}\eta_{n}^{i}\beta}\zeta_{i}e^{-\zeta_{i}c_{n-1}^{i,*}}=\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}e^{-\zeta_{i}c_{n-1}^{i,*}}\\
&amp;=\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}\exp\Bigl\{-\frac{\zeta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}+\frac{\zeta_{i}}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl[\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr]\Bigr\}.\end{split}" class="ltx_Math" display="block" id="S3.Ex15.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mrow><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup></mrow></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup></mrow></mrow></msup></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup></mrow></mrow></msup></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mfrac><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><mo>−</mo><mrow><mfrac><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>x</mi><mi>i</mi></msup></mrow></mrow><mo>+</mo><mrow><mfrac><msub><mi>ζ</mi><mi>i</mi></msub><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mfrac><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;e^{-\zeta_{i}c^{i,*}_{n-1}}\Delta+\frac{1}{\psi_{i}\eta_{n}^{i}\beta}\zeta_{i}e^{-\zeta_{i}c_{n-1}^{i,*}}=\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}e^{-\zeta_{i}c_{n-1}^{i,*}}\\
&amp;=\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}\exp\Bigl\{-\frac{\zeta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}+\frac{\zeta_{i}}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl[\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr]\Bigr\}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">It follows that the utility <math alttext="U_{n-1}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m4" intent=":literal"><semantics><msubsup><mi>U</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><annotation encoding="application/x-tex">U_{n-1}^{i}</annotation></semantics></math>
is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}U_{n-1}^{i}(x^{i},{\bf{s}},y,z^{i},\varrho_{i})&amp;=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}-\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl\{\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}\\
&amp;-\frac{1}{\zeta_{i}}\log\Bigl(\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}\Bigr).\end{split}" class="ltx_Math" display="block" id="S3.Ex16.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msubsup><mi>U</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><mfrac><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>x</mi><mi>i</mi></msup></mrow><mo>−</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mfrac><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>−</mo><mrow><mfrac><mn>1</mn><msub><mi>ζ</mi><mi>i</mi></msub></mfrac><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mrow><msub><mi>ζ</mi><mi>i</mi></msub><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><mi>β</mi></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}U_{n-1}^{i}(x^{i},{\bf{s}},y,z^{i},\varrho_{i})&amp;=\frac{\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}x^{i}-\frac{1}{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}\log\Bigl\{\frac{\delta_{i}\psi_{i}\eta_{n}^{i}\beta}{\zeta_{i}}\exp\Bigl(\frac{\psi_{i}}{\gamma_{i}}\log\widetilde{V}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})\Bigr)\Bigr\}\\
&amp;-\frac{1}{\zeta_{i}}\log\Bigl(\frac{\zeta_{i}+\Delta\psi_{i}\eta_{n}^{i}\beta}{\psi_{i}\eta_{n}^{i}\beta}\Bigr).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">on the set <math alttext="\{(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m5" intent=":literal"><semantics><mrow><mo stretchy="false">{</mo><mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo>,</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{(X_{n-1}^{i},{\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=(x^{i},{\bf{s}},y,z^{i},\varrho_{i})\}</annotation></semantics></math>.
By setting the right-hand side equal to <math alttext="\eta_{n-1}^{i}x^{i}-V_{n-1}({\bf{s}},y,z^{i},\varrho_{i})" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m6" intent=":literal"><semantics><mrow><mrow><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msup><mi>x</mi><mi>i</mi></msup></mrow><mo>−</mo><mrow><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\eta_{n-1}^{i}x^{i}-V_{n-1}({\bf{s}},y,z^{i},\varrho_{i})</annotation></semantics></math>, we obtained the desired recursive relation
for <math alttext="\eta_{n}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m7" intent=":literal"><semantics><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">\eta_{n}^{i}</annotation></semantics></math> and <math alttext="V_{n}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m8" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math>. It is now clear that <math alttext="(\eta_{n}^{i})_{n=1}^{N}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m9" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(\eta_{n}^{i})_{n=1}^{N}</annotation></semantics></math> are <math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m10" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable, strictly positive and bounded,
and that <math alttext="V_{n}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m11" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math> is a bounded function on <math alttext="{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m12" intent=":literal"><semantics><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mi>n</mi></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">{\cal S}^{n}\times{\cal Y}_{n}\times{\cal Z}_{n}\times\Gamma\rightarrow\mathbb{R}</annotation></semantics></math>
for every <math alttext="0\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p5.m13" intent=":literal"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0\leq n\leq N</annotation></semantics></math>.
∎</p>
</div>
</div>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Mean-field equilibrium among the agents with recursive utilities</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p">Finally, as a main goal of this section, we shall derive a set of transition probabilities of the stock so that the mean-field equilibrium holds
among the agents with recursive utilities. As before, we incorporate the existence of stochastic external order flow <math alttext="L_{n}" class="ltx_Math" display="inline" id="S3.SS3.p1.m1" intent=":literal"><semantics><msub><mi>L</mi><mi>n</mi></msub><annotation encoding="application/x-tex">L_{n}</annotation></semantics></math> at each <math alttext="t_{n}" class="ltx_Math" display="inline" id="S3.SS3.p1.m2" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>,
but it is now allowed to be path-dependent on the stock price:</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S3.Thmassumption3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption 3.3</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmassumption3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">For every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmassumption3.p1.m1" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>, <math alttext="L_{n-1}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.Thmassumption3.p1.m2" intent=":literal"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo stretchy="false">→</mo><mi>ℝ</mi></mrow></mrow><annotation encoding="application/x-tex">L_{n-1}:{\cal S}^{n-1}\times{\cal Y}_{n-1}\rightarrow\mathbb{R}</annotation></semantics></math> is a bounded measurable function.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S3.Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 3.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmdefinition1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">We say that the system is in the mean-field equilibrium if</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lim_{N_{p}\rightarrow\infty}\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=L_{n-1}({\bf{S}}^{n-1},Y_{n-1})," class="ltx_Math" display="block" id="S3.Ex17.m1" intent=":literal"><semantics><mrow><mrow><mrow><munder><mo movablelimits="false">lim</mo><mrow><msub><mi>N</mi><mi>p</mi></msub><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\lim_{N_{p}\rightarrow\infty}\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})=L_{n-1}({\bf{S}}^{n-1},Y_{n-1}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><math alttext="\mathbb{P}" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.m1" intent=":literal"><semantics><mi>ℙ</mi><annotation encoding="application/x-tex">\mathbb{P}</annotation></semantics></math><span class="ltx_text ltx_font_italic">-a.s. for every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.m2" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math> with <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.m3" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> defined by <math alttext="(\ref{th-R1-phinm1})" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.E4" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-phinm1})</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p">Since <math alttext="(Z^{i},\varrho_{i}),i\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS3.p2.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><msup><mi>Z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>,</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">(Z^{i},\varrho_{i}),i\in\mathbb{N}</annotation></semantics></math> are independent and identically distributed and also independent of the process <math alttext="(S,Y)" class="ltx_Math" display="inline" id="S3.SS3.p2.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S,Y)</annotation></semantics></math>, the above condition for the mean-field equilibrium
can be represented by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}^{1}\bigl[\phi^{1,*}_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1})\bigr]=L_{n-1}({\bf{s}},y)" class="ltx_Math" display="block" id="S3.Ex18.m1" intent=":literal"><semantics><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}^{1}\bigl[\phi^{1,*}_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1})\bigr]=L_{n-1}({\bf{s}},y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">for every <math alttext="({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S3.SS3.p2.m3" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.SS3.p2.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>.
It is now straightforward to derive the counterpart of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmtheorem2" title="Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem 3.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let Assumptions <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption1" title="Assumption 3.1. ‣ 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption2" title="Assumption 3.2. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption3" title="Assumption 3.3. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.3</span></a> be in force.
Then there exists a unique mean-field equilibrium and the associated transition probabilities of the stock are given by</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;p_{n-1}({\bf{s}},y):=\mathbb{P}^{0}\Bigl(S_{n}=\widetilde{u}S_{n-1}|({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\Bigr)\\
&amp;=(-d)\Big/\Bigl\{u\exp\Bigl(\frac{1}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}\Bigl[\mathbb{E}^{1}\Bigl(\frac{\log(f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1}))}{\gamma_{1}\eta_{n}^{1}}\Bigr)-(u-d)L_{n-1}({\bf{s}},y)\Bigr]\Bigr)-d\Bigr\}\end{split}" class="ltx_Math" display="block" id="S3.Ex19.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo fence="false">|</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true" symmetric="true">/</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mrow><mi>u</mi><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mfrac><mn>1</mn><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo>−</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo>−</mo><mi>d</mi></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;p_{n-1}({\bf{s}},y):=\mathbb{P}^{0}\Bigl(S_{n}=\widetilde{u}S_{n-1}|({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\Bigr)\\
&amp;=(-d)\Big/\Bigl\{u\exp\Bigl(\frac{1}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}\Bigl[\mathbb{E}^{1}\Bigl(\frac{\log(f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1}))}{\gamma_{1}\eta_{n}^{1}}\Bigr)-(u-d)L_{n-1}({\bf{s}},y)\Bigr]\Bigr)-d\Bigr\}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.m1" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1}</annotation></semantics></math>, <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.m2" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>. Moreover, with the above transition probabilities,
there exists some positive constant <math alttext="C_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.m3" intent=":literal"><semantics><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">C_{n-1}</annotation></semantics></math> such that</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})-L_{n-1}({\bf{S}}^{n-1},Y_{n-1})\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}" class="ltx_Math" display="block" id="S3.Ex20.m1" intent=":literal"><semantics><mrow><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>N</mi><mi>p</mi></msub></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>p</mi></msub></munderover><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>−</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true">|</mo></mrow><mn>2</mn></msup></mrow><mo>≤</mo><mfrac><msub><mi>C</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>N</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\mathbb{E}\Bigl|\frac{1}{N_{p}}\sum_{i=1}^{N_{p}}\phi^{i,*}_{n-1}({\bf{S}}^{n-1},Y_{n-1},Z_{n-1}^{i},\varrho_{i})-L_{n-1}({\bf{S}}^{n-1},Y_{n-1})\Bigr|^{2}\leq\frac{C_{n-1}}{N_{p}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">for every <math alttext="1\leq n\leq N" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1\leq n\leq N</annotation></semantics></math>, which gives the convergence rate in the large population limit.</span></p>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p2">
<p class="ltx_p">The proof is analogous to that of Theorem <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmtheorem2" title="Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a>.
The expression for the transition probabilities <math alttext="(p_{n-1}({\bf{s}},y))" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{n-1}({\bf{s}},y))</annotation></semantics></math> is a direct consequence of <math alttext="(\ref{th-R1-phinm1})" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E4" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-phinm1})</annotation></semantics></math>.
Assumptions <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption2" title="Assumption 3.2. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption3" title="Assumption 3.3. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.3</span></a> guarantees that <math alttext="f_{N-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m3" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-1}</annotation></semantics></math> is a.s. strictly positive and bounded
and hence the condition (vii) in Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption1" title="Assumption 3.1. ‣ 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a> is satisfied for <math alttext="(p_{N-1},q_{N-1})" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{N-1},q_{N-1})</annotation></semantics></math>.
It then makes <math alttext="\phi^{i,*}_{N-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m5" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{N-1}</annotation></semantics></math> a.s. bounded and thus <math alttext="\widetilde{V}_{N-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m6" intent=":literal"><semantics><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\widetilde{V}_{N-1}</annotation></semantics></math> becomes a.s. strictly positive and bounded.
It then follows that <math alttext="V_{N-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m7" intent=":literal"><semantics><msub><mi>V</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">V_{N-1}</annotation></semantics></math> and hence <math alttext="f_{N-2}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m8" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-2}</annotation></semantics></math> are a.s. bounded functions,
which shows that <math alttext="(p_{N-2},q_{N-2})" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m9" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>q</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{N-2},q_{N-2})</annotation></semantics></math> satisfies the condition (vii).
In this way, a simple induction shows that the transition probabilities satisfy Assumption <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmassumption1" title="Assumption 3.1. ‣ 3.1 The setup and notation ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a> (vii)
for every period. The second claim can be proved
by noticing that the optimal position <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m10" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> in the equilibrium is given by for <math alttext="({\bf{s}},y,z^{i},\varrho_{i})\in{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p2.m11" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒵</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em">×</mo><mi mathvariant="normal">Γ</mi></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y,z^{i},\varrho_{i})\in{\cal S}^{n-1}\times{\cal Y}_{n-1}\times{\cal Z}_{n-1}\times\Gamma</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\phi^{i,*}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})&amp;=\frac{1}{(u-d)}\Bigl\{\frac{\log f_{n-1}({\bf{s}},y,z^{i},\varrho_{i})}{\gamma_{i}\eta_{n}^{i}}-\frac{1/(\gamma_{i}\eta_{n}^{i})}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}\mathbb{E}^{1}\Bigl(\frac{\log f_{n-1}({\bf{s}},y,Z_{n-1}^{1},\varrho_{1})}{\gamma_{1}\eta_{n}^{1}}\Bigr)\Bigr\}\\
&amp;+\frac{1/(\gamma_{i}\eta_{n}^{i})}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}L_{n-1}({\bf{s}},y),\end{split}" class="ltx_Math" display="block" id="S3.E12.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mrow><mi>u</mi><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">{</mo><mrow><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msup><mi>z</mi><mi>i</mi></msup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mfrac><mo>−</mo><mrow><mfrac><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">}</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><mfrac><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">​</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\phi^{i,*}_{n-1}({\bf{s}},y,z^{i},\varrho_{i})&amp;=\frac{1}{(u-d)}\Bigl\{\frac{\log f_{n-1}({\bf{s}},y,z^{i},\varrho_{i})}{\gamma_{i}\eta_{n}^{i}}-\frac{1/(\gamma_{i}\eta_{n}^{i})}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}\mathbb{E}^{1}\Bigl(\frac{\log f_{n-1}({\bf{s}},y,Z_{n-1}^{1},\varrho_{1})}{\gamma_{1}\eta_{n}^{1}}\Bigr)\Bigr\}\\
&amp;+\frac{1/(\gamma_{i}\eta_{n}^{i})}{\mathbb{E}^{1}[1/(\gamma_{1}\eta_{n}^{1})]}L_{n-1}({\bf{s}},y),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and the fact that all the relevant components are bounded.
∎</p>
</div>
</div>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="S3.Thmremark2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Remark 3.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="S3.Thmremark2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">It is easy to check that the required time-horizon
of the path dependence in the transition probabilities is equal to that in the liability and the incremental endowments.
In particular, if <math alttext="F" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m1" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> and <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m2" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> depend only on <math alttext="S_{N}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m3" intent=":literal"><semantics><msub><mi>S</mi><mi>N</mi></msub><annotation encoding="application/x-tex">S_{N}</annotation></semantics></math> and <math alttext="S_{n}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m4" intent=":literal"><semantics><msub><mi>S</mi><mi>n</mi></msub><annotation encoding="application/x-tex">S_{n}</annotation></semantics></math> respectively as in the previous section,
the transition probabilities of the form <math alttext="(p_{n-1}(s,y),q_{n-1}(s,y))" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p_{n-1}(s,y),q_{n-1}(s,y))</annotation></semantics></math> with <math alttext="s\in{\cal S}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m6" intent=":literal"><semantics><mrow><mi>s</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s\in{\cal S}_{n-1}</annotation></semantics></math> are enough to achieve the equilibrium.
Simple replacement of <math alttext="{\bf{s}}\in{\cal S}^{n-1}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m7" intent=":literal"><semantics><mrow><mi>𝐬</mi><mo>∈</mo><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{\bf{s}}\in{\cal S}^{n-1}</annotation></semantics></math> by <math alttext="s\in{\cal S}_{n-1}" class="ltx_Math" display="inline" id="S3.Thmremark2.p1.m8" intent=":literal"><semantics><mrow><mi>s</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s\in{\cal S}_{n-1}</annotation></semantics></math>, we obtain the corresponding results for
Theorems <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmtheorem1" title="Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmtheorem2" title="Theorem 3.2. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a>.</span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p">On the relation between the mean-field price distribution and the one in the risk-neutral measure,
most of the discussions given in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="2.4 Some implications ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a> still hold.
In particular, the situation <math alttext="p_{n-1}({\bf{s}},y)&gt;p^{\mathbb{Q}}" class="ltx_Math" display="inline" id="S3.SS3.p3.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><msup><mi>p</mi><mi>ℚ</mi></msup></mrow><annotation encoding="application/x-tex">p_{n-1}({\bf{s}},y)&gt;p^{\mathbb{Q}}</annotation></semantics></math> (i.e. positive excess return)
occurs if and only if
<math alttext="\displaystyle\mathbb{E}^{1}\Bigl[\frac{\log(f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1}))}{\gamma_{1}\eta_{n}^{1}}\Bigr]&lt;0," class="ltx_Math" display="inline" id="S3.SS3.p3.m2" intent=":literal"><semantics><mrow><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mstyle displaystyle="true"><mfrac><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac></mstyle><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo>&lt;</mo><mn>0</mn></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle\mathbb{E}^{1}\Bigl[\frac{\log(f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1}))}{\gamma_{1}\eta_{n}^{1}}\Bigr]&lt;0,</annotation></semantics></math>
when there is no external order flow <math alttext="L_{n-1}\equiv 0" class="ltx_Math" display="inline" id="S3.SS3.p3.m3" intent=":literal"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_{n-1}\equiv 0</annotation></semantics></math>.
As one can see from <math alttext="(\ref{th-R1-fnm1})" class="ltx_Math" display="inline" id="S3.SS3.p3.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E6" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-fnm1})</annotation></semantics></math>, <math alttext="f_{n-1}" class="ltx_Math" display="inline" id="S3.SS3.p3.m5" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{n-1}</annotation></semantics></math> has contributions from the liability <math alttext="V_{n}" class="ltx_Math" display="inline" id="S3.SS3.p3.m6" intent=":literal"><semantics><msub><mi>V</mi><mi>n</mi></msub><annotation encoding="application/x-tex">V_{n}</annotation></semantics></math>
and the incremental endowment <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.SS3.p3.m7" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math>. If the liability size decreases and the endowment size simultaneously increases as the stock price grows, both effects will amplify the deviations from the risk-neutral distribution toward a higher excess return.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p">Since the equilibrium price distribution of the stock is determined by the need for risk hedging, the relative importance of the continuation utility
with respect to the current nominal consumption is a crucial factor in controlling the size of the risk premium.
From the expressions in <math alttext="(\ref{th-R1-Vnm1})" class="ltx_Math" display="inline" id="S3.SS3.p4.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E7" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.7</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-Vnm1})</annotation></semantics></math> and <math alttext="(\ref{th-R1-Vtildenm1})" class="ltx_Math" display="inline" id="S3.SS3.p4.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_missing_label ltx_mathvariant_italic"><span class="ltx_ref ltx_missing_label ltx_font_italic ltx_ref_self">LABEL:th-R1-Vtildenm1</span></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-Vtildenm1})</annotation></semantics></math>, one can expect that the ratio</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\eta_{n-1}^{i}}{\eta_{n}^{i}}" class="ltx_Math" display="block" id="S3.Ex21.m1" intent=":literal"><semantics><mfrac><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mfrac><annotation encoding="application/x-tex">\frac{\eta_{n-1}^{i}}{\eta_{n}^{i}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">is the key value. Using <math alttext="\beta\simeq 1" class="ltx_Math" display="inline" id="S3.SS3.p4.m3" intent=":literal"><semantics><mrow><mi>β</mi><mo>≃</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta\simeq 1</annotation></semantics></math> and <math alttext="\Delta\ll 1" class="ltx_Math" display="inline" id="S3.SS3.p4.m4" intent=":literal"><semantics><mrow><mi mathvariant="normal">Δ</mi><mo>≪</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Delta\ll 1</annotation></semantics></math>, we have
<math alttext="\eta_{n-1}^{i}/\eta_{n}^{i}\simeq\psi_{i}/\zeta_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.m5" intent=":literal"><semantics><mrow><mrow><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>/</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mrow><mo>≃</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>/</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\eta_{n-1}^{i}/\eta_{n}^{i}\simeq\psi_{i}/\zeta_{i}</annotation></semantics></math>
from <math alttext="(\ref{th-R1-etanm1})" class="ltx_Math" display="inline" id="S3.SS3.p4.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E9" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.9</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-etanm1})</annotation></semantics></math>. Therefore, if
<math alttext="\psi_{i}&lt;\zeta_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.m7" intent=":literal"><semantics><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\psi_{i}&lt;\zeta_{i}</annotation></semantics></math> holds for the majority of agents, we expect that the relative importance of the continuation utility
quickly decays and we would have only a small impact from it for earlier periods. In this case, significant deviations from the risk-neutral price distribution can be observed only in the later periods near the maturity. On the other hand, in the case of <math alttext="\psi_{i}&gt;\zeta_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.m8" intent=":literal"><semantics><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\psi_{i}&gt;\zeta_{i}</annotation></semantics></math>,
we can expect to see significant deviations throughout the interval. We shall confirm this behavior in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4" title="4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p">As for the expected trading volume <math alttext="\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S3.SS3.p5.m1" intent=":literal"><semantics><mrow><mi>𝔼</mi><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}[|\phi^{1,*}_{n}|^{2}]^{\frac{1}{2}}</annotation></semantics></math>, which gives the standard deviation of the stock
position among the agents at <math alttext="t=t_{n}" class="ltx_Math" display="inline" id="S3.SS3.p5.m2" intent=":literal"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">t=t_{n}</annotation></semantics></math>, we have the consistent result as in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="2.4 Some implications ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a>.
The expression for <math alttext="\phi^{i,*}_{n-1}" class="ltx_Math" display="inline" id="S3.SS3.p5.m3" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n-1}</annotation></semantics></math> in <math alttext="(\ref{th-R2-phinm1})" class="ltx_Math" display="inline" id="S3.SS3.p5.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E12" title="In Theorem 3.2. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.12</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R2-phinm1})</annotation></semantics></math> shows that its size is governed by the
variation of idiosyncratic factors defined on the space <math alttext="(\Omega^{i},{\cal F}^{i},\mathbb{P}^{i})" class="ltx_Math" display="inline" id="S3.SS3.p5.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mi>i</mi></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mi>i</mi></msup><mo>,</mo><msup><mi>ℙ</mi><mi>i</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega^{i},{\cal F}^{i},\mathbb{P}^{i})</annotation></semantics></math>.
It is also quite consistent with our intuition
that the agents’ heterogeneity in idiosyncratic factors is the origin of the trading activity in the market.
Moreover, we can make use of the degrees of freedom in the process <math alttext="(Z_{n}^{i})" class="ltx_Math" display="inline" id="S3.SS3.p5.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Z_{n}^{i})</annotation></semantics></math>, in particular its volatility,
to obtain the desired trading volume. We shall confirm this claim in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.SS2" title="4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p">Finally, let us comment on the fact that the constant shifts in <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p6.m1" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> and <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.SS3.p6.m2" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math>, i.e. <math alttext="F\mapsto F+c" class="ltx_Math" display="inline" id="S3.SS3.p6.m3" intent=":literal"><semantics><mrow><mi>F</mi><mo stretchy="false">↦</mo><mrow><mi>F</mi><mo>+</mo><mi>c</mi></mrow></mrow><annotation encoding="application/x-tex">F\mapsto F+c</annotation></semantics></math> and <math alttext="g_{n}\mapsto g_{n}+c^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p6.m4" intent=":literal"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false">↦</mo><mrow><msub><mi>g</mi><mi>n</mi></msub><mo>+</mo><msup><mi>c</mi><mo>′</mo></msup></mrow></mrow><annotation encoding="application/x-tex">g_{n}\mapsto g_{n}+c^{\prime}</annotation></semantics></math>
with some constants <math alttext="c,c^{\prime}\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS3.p6.m5" intent=":literal"><semantics><mrow><mrow><mi>c</mi><mo>,</mo><msup><mi>c</mi><mo>′</mo></msup></mrow><mo>∈</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">c,c^{\prime}\in\mathbb{R}</annotation></semantics></math> do not affect the equilibrium price distribution.
This property can be checked by a simple induction as follows:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p">By <math alttext="(\ref{th-R1-fnm1})" class="ltx_Math" display="inline" id="S3.I1.i1.p1.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E6" title="In Theorem 3.1. ‣ 3.2 The individual optimization problem ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{th-R1-fnm1})</annotation></semantics></math>, the value of <math alttext="f_{N-1}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.m2" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-1}</annotation></semantics></math> remains unchanged and so are <math alttext="p_{N-1}({\bf{s}},y)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.m3" intent=":literal"><semantics><mrow><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{N-1}({\bf{s}},y)</annotation></semantics></math> and <math alttext="\phi^{i,*}_{N-1}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.m4" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{N-1}</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p">The value of <math alttext="\widetilde{V}_{N-1}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.m1" intent=":literal"><semantics><msub><mover accent="true"><mi>V</mi><mo>~</mo></mover><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\widetilde{V}_{N-1}</annotation></semantics></math> is changed only by an <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable multiplicative factor.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p">The value of <math alttext="V_{N-1}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.m1" intent=":literal"><semantics><msub><mi>V</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">V_{N-1}</annotation></semantics></math> is only shifted by an <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable term.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p">Thus <math alttext="f_{N-2}" class="ltx_Math" display="inline" id="S3.I1.i4.p1.m1" intent=":literal"><semantics><msub><mi>f</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">f_{N-2}</annotation></semantics></math> remains once again unchanged, and so are <math alttext="p_{N-2}({\bf{s}},y)" class="ltx_Math" display="inline" id="S3.I1.i4.p1.m2" intent=":literal"><semantics><mrow><msub><mi>p</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{N-2}({\bf{s}},y)</annotation></semantics></math> and <math alttext="\phi^{i,*}_{N-2}" class="ltx_Math" display="inline" id="S3.I1.i4.p1.m3" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{N-2}</annotation></semantics></math>. <math alttext="\cdots" class="ltx_Math" display="inline" id="S3.I1.i4.p1.m4" intent=":literal"><semantics><mi mathvariant="normal">⋯</mi><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></p>
</div>
</li>
</ul>
<p class="ltx_p">Therefore, the signs of <math alttext="F" class="ltx_Math" display="inline" id="S3.SS3.p6.m6" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> and <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.SS3.p6.m7" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> can be altered without affecting the equilibrium price distribution.
Note however that, the cash spending is affected by these shifts.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Mean-field equilibrium of multiple populations</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p">Let us briefly mention the construction of the mean-field equilibrium for multiple populations.
The population ratio among the groups must be kept constant when the large population limit is taken.
Suppose, for example, that population ratio among the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS4.p1.m1" intent=":literal"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> groups are given by <math alttext="w_{p}\in(0,1),~p=1,\cdots,m" class="ltx_Math" display="inline" id="S3.SS4.p1.m2" intent=":literal"><semantics><mrow><mrow><msub><mi>w</mi><mi>p</mi></msub><mo>∈</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.497em">,</mo><mrow><mi>p</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><mi>m</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">w_{p}\in(0,1),~p=1,\cdots,m</annotation></semantics></math> satisfying
<math alttext="\sum_{p=1}^{m}w_{p}=1" class="ltx_Math" display="inline" id="S3.SS4.p1.m3" intent=":literal"><semantics><mrow><mrow><msubsup><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>w</mi><mi>p</mi></msub></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{p=1}^{m}w_{p}=1</annotation></semantics></math>. We enlarge the product probability space by introducing <math alttext="(\Omega^{i,p},{\cal F}^{i,p},({\cal F}_{t_{n}}^{i,p})_{n=0}^{N},\mathbb{P}^{i,p})" class="ltx_Math" display="inline" id="S3.SS4.p1.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="normal">Ω</mi><mrow><mi>i</mi><mo>,</mo><mi>p</mi></mrow></msup><mo>,</mo><msup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mrow><mi>i</mi><mo>,</mo><mi>p</mi></mrow></msup><mo>,</mo><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mrow><mi>i</mi><mo>,</mo><mi>p</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msup><mi>ℙ</mi><mrow><mi>i</mi><mo>,</mo><mi>p</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Omega^{i,p},{\cal F}^{i,p},({\cal F}_{t_{n}}^{i,p})_{n=0}^{N},\mathbb{P}^{i,p})</annotation></semantics></math>
for every <math alttext="p=1,\cdots,m" class="ltx_Math" display="inline" id="S3.SS4.p1.m5" intent=":literal"><semantics><mrow><mi>p</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><mi>m</mi></mrow></mrow><annotation encoding="application/x-tex">p=1,\cdots,m</annotation></semantics></math> and <math alttext="i\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS4.p1.m6" intent=":literal"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>ℕ</mi></mrow><annotation encoding="application/x-tex">i\in\mathbb{N}</annotation></semantics></math>. If we denote the optimal trade position of the agent-<math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p1.m7" intent=":literal"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> in the group <math alttext="p" class="ltx_Math" display="inline" id="S3.SS4.p1.m8" intent=":literal"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> by <math alttext="\phi^{i,p,*}_{n-1}" class="ltx_Math" display="inline" id="S3.SS4.p1.m9" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>,</mo><mi>p</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,p,*}_{n-1}</annotation></semantics></math>,
the condition for the mean-field equilibrium is, with obvious notation,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{p=1}^{m}w_{p}\mathbb{E}^{1,p}\bigl[\phi^{1,p,*}_{n-1}({\bf{s}},y,Z_{n-1}^{1,p},\varrho_{1,p})\bigr]=L_{n-1}({\bf{s}},y)" class="ltx_Math" display="block" id="S3.E13.m1" intent=":literal"><semantics><mrow><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><msub><mi>w</mi><mi>p</mi></msub><mo lspace="0em" rspace="0em">​</mo><msup><mi>𝔼</mi><mrow><mn>1</mn><mo>,</mo><mi>p</mi></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">[</mo><mrow><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>,</mo><mi>p</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>,</mo><mi>p</mi></mrow></msubsup><mo>,</mo><msub><mi>ϱ</mi><mrow><mn>1</mn><mo>,</mo><mi>p</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">]</mo></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\sum_{p=1}^{m}w_{p}\mathbb{E}^{1,p}\bigl[\phi^{1,p,*}_{n-1}({\bf{s}},y,Z_{n-1}^{1,p},\varrho_{1,p})\bigr]=L_{n-1}({\bf{s}},y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
3.13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for every <math alttext="({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1},1\leq n\leq N" class="ltx_Math" display="inline" id="S3.SS4.p1.m10" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒮</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">×</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>,</mo><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">({\bf{s}},y)\in{\cal S}^{n-1}\times{\cal Y}_{n-1},1\leq n\leq N</annotation></semantics></math>.
Since the factor <math alttext="\displaystyle\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)" class="ltx_Math" display="inline" id="S3.SS4.p1.m11" intent=":literal"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mstyle displaystyle="true"><mfrac><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mfrac></mstyle></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)</annotation></semantics></math> in the optimal position <math alttext="\phi_{n-1}^{i,p,*}" class="ltx_Math" display="inline" id="S3.SS4.p1.m12" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>,</mo><mi>p</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi_{n-1}^{i,p,*}</annotation></semantics></math>
is the same across the populations, solving the equation <math alttext="(\ref{eq-multi-p})" class="ltx_Math" display="inline" id="S3.SS4.p1.m13" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E13" title="In 3.4 Mean-field equilibrium of multiple populations ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.13</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-multi-p})</annotation></semantics></math> is straightforward. We can even mix the populations
with standard exponential utilities and the recursive utilities just discussed.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p">As a simple example, consider the situation where the external order flow is absent <math alttext="L\equiv 0" class="ltx_Math" display="inline" id="S3.SS4.p2.m1" intent=":literal"><semantics><mrow><mi>L</mi><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L\equiv 0</annotation></semantics></math> and the agents discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2" title="2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2</span></a>
and those in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3" title="3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3</span></a> have the same population size in the market.
Distinguishing the expectations and variables for the first group by tilde (such as <math alttext="\widetilde{\mathbb{E}}^{1}[\cdot]" class="ltx_Math" display="inline" id="S3.SS4.p2.m2" intent=":literal"><semantics><mrow><msup><mover accent="true"><mi>𝔼</mi><mo>~</mo></mover><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mo lspace="0em" rspace="0em">⋅</mo><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\widetilde{\mathbb{E}}^{1}[\cdot]</annotation></semantics></math> and <math alttext="\widetilde{\gamma}_{1}" class="ltx_Math" display="inline" id="S3.SS4.p2.m3" intent=":literal"><semantics><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub><annotation encoding="application/x-tex">\widetilde{\gamma}_{1}</annotation></semantics></math>) for simplicity,
the equation <math alttext="(\ref{eq-multi-p})" class="ltx_Math" display="inline" id="S3.SS4.p2.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S3.E13" title="In 3.4 Mean-field equilibrium of multiple populations ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.13</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-multi-p})</annotation></semantics></math> yields</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}0&amp;=\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)\Bigl(\mathbb{E}^{1}\Bigl[\frac{1}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{1}{\widetilde{\gamma}_{1}}\Bigr]\Bigr)\\
&amp;+\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}({\bf{s}},y,Z_{n-1}^{1},\varrho_{i})}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{\log\widetilde{f}_{n-1}(s,y,\widetilde{Z}_{n-1}^{1},\widetilde{\gamma}_{1})}{\widetilde{\gamma}_{1}}\Bigr]\end{split}" class="ltx_Math" display="block" id="S3.Ex22.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mi></mi><mo>=</mo><mrow><mrow><mi>log</mi><mo>⁡</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mo>−</mo><mfrac><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>u</mi></mrow><mrow><msub><mi>q</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mi>d</mi></mrow></mfrac></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">(</mo><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mn>1</mn><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>𝔼</mi><mo>~</mo></mover><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mn>1</mn><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo maxsize="1.600em" minsize="1.600em">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mo>+</mo><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mo>+</mo><mrow><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>𝔼</mi><mo>~</mo></mover><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>f</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mover accent="true"><mi>Z</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}0&amp;=\log\Bigl(-\frac{p_{n-1}({\bf{s}},y)u}{q_{n-1}({\bf{s}},y)d}\Bigr)\Bigl(\mathbb{E}^{1}\Bigl[\frac{1}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{1}{\widetilde{\gamma}_{1}}\Bigr]\Bigr)\\
&amp;+\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}({\bf{s}},y,Z_{n-1}^{1},\varrho_{i})}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{\log\widetilde{f}_{n-1}(s,y,\widetilde{Z}_{n-1}^{1},\widetilde{\gamma}_{1})}{\widetilde{\gamma}_{1}}\Bigr]\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">on the set <math alttext="\{({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\}" class="ltx_Math" display="inline" id="S3.SS4.p2.m5" intent=":literal"><semantics><mrow><mo stretchy="false">{</mo><mrow><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\}</annotation></semantics></math>, where <math alttext="s:=s_{n-1}" class="ltx_Math" display="inline" id="S3.SS4.p2.m6" intent=":literal"><semantics><mrow><mi>s</mi><mo>:=</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s:=s_{n-1}</annotation></semantics></math>. It is easy to solve this equation to get the equilibrium
transition probability as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;p_{n-1}({\bf{s}},y)=\mathbb{P}^{0}\bigl(S_{n}=\widetilde{u}S_{n-1}|({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\bigr)\\
&amp;=(-d)\Big/\left\{u\exp\left(\frac{\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1})}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{\log\widetilde{f}_{n-1}(s,y,\widetilde{Z}_{n-1}^{1},\widetilde{\gamma}_{1})}{\widetilde{\gamma}_{1}}\Bigr]}{\mathbb{E}^{1}\Bigl[\frac{1}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{1}{\widetilde{\gamma}_{1}}\Bigr]}\right)-d\right\}.\end{split}" class="ltx_Math" display="block" id="S3.Ex23.m1" intent=":literal"><semantics><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msub><mi>p</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>ℙ</mi><mn>0</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.200em" minsize="1.200em">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo fence="false">|</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐒</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo maxsize="1.200em" minsize="1.200em">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mo maxsize="1.600em" minsize="1.600em" stretchy="true" symmetric="true">/</mo><mrow><mo>{</mo><mrow><mrow><mi>u</mi><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mi>f</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>𝐬</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mi>ϱ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>𝔼</mi><mo>~</mo></mover><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mrow><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><msub><mover accent="true"><mi>f</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo>,</mo><msubsup><mover accent="true"><mi>Z</mi><mo>~</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>,</mo><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow><mrow><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mn>1</mn><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>η</mi><mi>n</mi><mn>1</mn></msubsup></mrow></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow><mo>+</mo><mrow><mfrac><msup><mi>β</mi><mi>n</mi></msup><msup><mi>β</mi><mi>N</mi></msup></mfrac><mo lspace="0em" rspace="0em">​</mo><msup><mover accent="true"><mi>𝔼</mi><mo>~</mo></mover><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo maxsize="1.600em" minsize="1.600em">[</mo><mfrac><mn>1</mn><msub><mover accent="true"><mi>γ</mi><mo>~</mo></mover><mn>1</mn></msub></mfrac><mo maxsize="1.600em" minsize="1.600em">]</mo></mrow></mrow></mrow></mfrac><mo>)</mo></mrow></mrow></mrow><mo>−</mo><mi>d</mi></mrow><mo>}</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;p_{n-1}({\bf{s}},y)=\mathbb{P}^{0}\bigl(S_{n}=\widetilde{u}S_{n-1}|({\bf{S}}^{n-1},Y_{n-1})=({\bf{s}},y)\bigr)\\
&amp;=(-d)\Big/\left\{u\exp\left(\frac{\mathbb{E}^{1}\Bigl[\frac{\log f_{n-1}({\bf{s}},y,Z^{1}_{n-1},\varrho_{1})}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{\log\widetilde{f}_{n-1}(s,y,\widetilde{Z}_{n-1}^{1},\widetilde{\gamma}_{1})}{\widetilde{\gamma}_{1}}\Bigr]}{\mathbb{E}^{1}\Bigl[\frac{1}{\gamma_{1}\eta_{n}^{1}}\Bigr]+\frac{\beta^{n}}{\beta^{N}}\widetilde{\mathbb{E}}^{1}\Bigl[\frac{1}{\widetilde{\gamma}_{1}}\Bigr]}\right)-d\right\}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">One can prove its well-posedness across the whole time interval in the same way as in Theorems <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.Thmtheorem2" title="Theorem 2.2. ‣ 2.3 Mean-field equilibrium under stochastic order flow ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmtheorem2" title="Theorem 3.2. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a>.
Moreover, if we turn off the path-dependence in <math alttext="F" class="ltx_Math" display="inline" id="S3.SS4.p2.m7" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> and <math alttext="g_{n}" class="ltx_Math" display="inline" id="S3.SS4.p2.m8" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> at least, the numerical evaluation of the equilibrium distribution can be
carried out in a simple manner as in the next section.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p">Note that these results are quite remarkable when compared with the
situation in the continuous-time setting. In fact, if we tries to solve the corresponding problem in the formulation of Fujii &amp; Sekine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib20" title="">20</a>]</cite>,
we would obtain a coupled system of mean-field qg-BSDEs, whose well-posedness would be much harder than the
single population case, not to mention its numerical evaluation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Numerical examples</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p">In this section, we provide some numerical examples for the models introduced in Sections <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2" title="2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2</span></a>
and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3" title="3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3</span></a> but without path dependence.
Since the models are too flexible for through analysis, we focus only on a few simple setups
to grasp characteristic behaviors of the mean-field price distributions.
In order to reduce numerical cost, we assume that <math alttext="Y" class="ltx_Math" display="inline" id="S4.p1.m1" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> and <math alttext="Z^{i}" class="ltx_Math" display="inline" id="S4.p1.m2" intent=":literal"><semantics><msup><mi>Z</mi><mi>i</mi></msup><annotation encoding="application/x-tex">Z^{i}</annotation></semantics></math> are also one-dimensional discrete processes taking values on binomial trees,
and that all the <math alttext="{\cal F}^{i}_{0}" class="ltx_Math" display="inline" id="S4.p1.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}^{i}_{0}</annotation></semantics></math>-measurable random variables are uniformly distributed over finite sets.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Utility for terminal wealth</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p">Let us first consider the model discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2" title="2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2</span></a>.
<math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.m1" intent=":literal"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_{i}</annotation></semantics></math> is assumed to have a uniform distribution over <math alttext="(N_{\gamma}+1)" class="ltx_Math" display="inline" id="S4.SS1.p1.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>N</mi><mi>γ</mi></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N_{\gamma}+1)</annotation></semantics></math> discrete values given by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma_{i}(k_{\gamma}):=\underline{\gamma}+(\overline{\gamma}-\underline{\gamma})\frac{k_{\gamma}}{N_{\gamma}},\quad k_{\gamma}=0,\cdots,N_{\gamma}." class="ltx_Math" display="block" id="S4.Ex1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>γ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>γ</mi><mo stretchy="true">¯</mo></mover><mo>−</mo><munder accentunder="true"><mi>γ</mi><mo stretchy="true">¯</mo></munder></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mfrac><msub><mi>k</mi><mi>γ</mi></msub><msub><mi>N</mi><mi>γ</mi></msub></mfrac></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><msub><mi>k</mi><mi>γ</mi></msub><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><msub><mi>N</mi><mi>γ</mi></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\gamma_{i}(k_{\gamma}):=\underline{\gamma}+(\overline{\gamma}-\underline{\gamma})\frac{k_{\gamma}}{N_{\gamma}},\quad k_{\gamma}=0,\cdots,N_{\gamma}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">The process <math alttext="(Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S4.SS1.p1.m3" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math> is supposed to follow a one-dimensional binomial process modeled by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Z_{n+1}^{i}=Z_{n}^{i}R_{n+1}^{i}," class="ltx_Math" display="block" id="S4.Ex2.m1" intent=":literal"><semantics><mrow><mrow><msubsup><mi>Z</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><mrow><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Z_{n+1}^{i}=Z_{n}^{i}R_{n+1}^{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="(R_{n}^{i})" class="ltx_Math" display="inline" id="S4.SS1.p1.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>R</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(R_{n}^{i})</annotation></semantics></math> is an <math alttext="({\cal F}^{i}_{t_{n}})" class="ltx_Math" display="inline" id="S4.SS1.p1.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">({\cal F}^{i}_{t_{n}})</annotation></semantics></math>-adapted process taking values either <math alttext="u_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m6" intent=":literal"><semantics><msub><mi>u</mi><mi>z</mi></msub><annotation encoding="application/x-tex">u_{z}</annotation></semantics></math> or <math alttext="d_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m7" intent=":literal"><semantics><msub><mi>d</mi><mi>z</mi></msub><annotation encoding="application/x-tex">d_{z}</annotation></semantics></math>, where <math alttext="R_{n+1}^{i}=u_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m8" intent=":literal"><semantics><mrow><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>u</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">R_{n+1}^{i}=u_{z}</annotation></semantics></math> occurs with probability <math alttext="p_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m9" intent=":literal"><semantics><msub><mi>p</mi><mi>z</mi></msub><annotation encoding="application/x-tex">p_{z}</annotation></semantics></math> and <math alttext="R_{n+1}^{i}=d_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m10" intent=":literal"><semantics><mrow><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>d</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">R_{n+1}^{i}=d_{z}</annotation></semantics></math> with <math alttext="q_{z}:=1-p_{z}" class="ltx_Math" display="inline" id="S4.SS1.p1.m11" intent=":literal"><semantics><mrow><msub><mi>q</mi><mi>z</mi></msub><mo>:=</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>z</mi></msub></mrow></mrow><annotation encoding="application/x-tex">q_{z}:=1-p_{z}</annotation></semantics></math>.
We take <math alttext="u_{z}=(d_{z})^{-1}=\exp(\sigma_{z}\sqrt{\Delta})" class="ltx_Math" display="inline" id="S4.SS1.p1.m12" intent=":literal"><semantics><mrow><msub><mi>u</mi><mi>z</mi></msub><mo>=</mo><msup><mrow><mo stretchy="false">(</mo><msub><mi>d</mi><mi>z</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>σ</mi><mi>z</mi></msub><mo lspace="0em" rspace="0em">​</mo><msqrt><mi mathvariant="normal">Δ</mi></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">u_{z}=(d_{z})^{-1}=\exp(\sigma_{z}\sqrt{\Delta})</annotation></semantics></math>. We also assume <math alttext="Z_{0}^{i}=z_{0}\in(0,\infty)" class="ltx_Math" display="inline" id="S4.SS1.p1.m13" intent=":literal"><semantics><mrow><msubsup><mi>Z</mi><mn>0</mn><mi>i</mi></msubsup><mo>=</mo><msub><mi>z</mi><mn>0</mn></msub><mo>∈</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z_{0}^{i}=z_{0}\in(0,\infty)</annotation></semantics></math> common for all the agents in order to reduce
numerical costs. We model the process <math alttext="(Y_{n})_{n=0}^{N}" class="ltx_Math" display="inline" id="S4.SS1.p1.m14" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(Y_{n})_{n=0}^{N}</annotation></semantics></math> similarly but it is assumed to follow an approximate Gaussian process:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Y_{n+1}=Y_{n}+R_{n+1}^{y}," class="ltx_Math" display="block" id="S4.Ex3.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>+</mo><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>y</mi></msubsup></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Y_{n+1}=Y_{n}+R_{n+1}^{y},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="(R_{n}^{y})" class="ltx_Math" display="inline" id="S4.SS1.p1.m15" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>R</mi><mi>n</mi><mi>y</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(R_{n}^{y})</annotation></semantics></math> is an <math alttext="({\cal F}^{0}_{t_{n}})" class="ltx_Math" display="inline" id="S4.SS1.p1.m16" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><msub><mi>t</mi><mi>n</mi></msub><mn>0</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">({\cal F}^{0}_{t_{n}})</annotation></semantics></math>-adapted process taking values either <math alttext="u_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m17" intent=":literal"><semantics><msub><mi>u</mi><mi>y</mi></msub><annotation encoding="application/x-tex">u_{y}</annotation></semantics></math> or <math alttext="d_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m18" intent=":literal"><semantics><msub><mi>d</mi><mi>y</mi></msub><annotation encoding="application/x-tex">d_{y}</annotation></semantics></math>,
where <math alttext="R_{n+1}^{y}=u_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m19" intent=":literal"><semantics><mrow><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>y</mi></msubsup><mo>=</mo><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">R_{n+1}^{y}=u_{y}</annotation></semantics></math> with probability <math alttext="p_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m20" intent=":literal"><semantics><msub><mi>p</mi><mi>y</mi></msub><annotation encoding="application/x-tex">p_{y}</annotation></semantics></math> and <math alttext="R_{n+1}^{y}=d_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m21" intent=":literal"><semantics><mrow><msubsup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>y</mi></msubsup><mo>=</mo><msub><mi>d</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">R_{n+1}^{y}=d_{y}</annotation></semantics></math> with <math alttext="q_{y}:=1-p_{y}" class="ltx_Math" display="inline" id="S4.SS1.p1.m22" intent=":literal"><semantics><mrow><msub><mi>q</mi><mi>y</mi></msub><mo>:=</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>y</mi></msub></mrow></mrow><annotation encoding="application/x-tex">q_{y}:=1-p_{y}</annotation></semantics></math>.
We take <math alttext="u_{y}=(-d_{y})=\sigma_{y}\sqrt{\Delta}" class="ltx_Math" display="inline" id="S4.SS1.p1.m23" intent=":literal"><semantics><mrow><msub><mi>u</mi><mi>y</mi></msub><mo>=</mo><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><msub><mi>d</mi><mi>y</mi></msub></mrow><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><msub><mi>σ</mi><mi>y</mi></msub><mo lspace="0em" rspace="0em">​</mo><msqrt><mi mathvariant="normal">Δ</mi></msqrt></mrow></mrow><annotation encoding="application/x-tex">u_{y}=(-d_{y})=\sigma_{y}\sqrt{\Delta}</annotation></semantics></math>.
Finally, for the stock-price process <math alttext="(S_{n})" class="ltx_Math" display="inline" id="S4.SS1.p1.m24" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S_{n})</annotation></semantics></math>, we set <math alttext="\widetilde{u}=(\widetilde{d})^{-1}=\exp(\sigma\sqrt{\Delta})" class="ltx_Math" display="inline" id="S4.SS1.p1.m25" intent=":literal"><semantics><mrow><mover accent="true"><mi>u</mi><mo>~</mo></mover><mo>=</mo><msup><mrow><mo stretchy="false">(</mo><mover accent="true"><mi>d</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>σ</mi><mo lspace="0em" rspace="0em">​</mo><msqrt><mi mathvariant="normal">Δ</mi></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\widetilde{u}=(\widetilde{d})^{-1}=\exp(\sigma\sqrt{\Delta})</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p">The parameter values to be used throughout this subsection are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.T1" title="Table 1 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">1</span></a> below. Recall that the initial wealth <math alttext="\xi_{i}" class="ltx_Math" display="inline" id="S4.SS1.p2.m1" intent=":literal"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_{i}</annotation></semantics></math>
is irrelevant for our analysis.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">parameter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\underline{\gamma}" class="ltx_Math" display="inline" id="S4.T1.m1" intent=":literal"><semantics><munder accentunder="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></munder><annotation encoding="application/x-tex">\underline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\overline{\gamma}" class="ltx_Math" display="inline" id="S4.T1.m2" intent=":literal"><semantics><mover accent="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N_{\gamma}" class="ltx_Math" display="inline" id="S4.T1.m3" intent=":literal"><semantics><msub><mi mathsize="0.800em">N</mi><mi mathsize="0.800em">γ</mi></msub><annotation encoding="application/x-tex">N_{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="z_{0}" class="ltx_Math" display="inline" id="S4.T1.m4" intent=":literal"><semantics><msub><mi mathsize="0.800em">z</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">z_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.T1.m5" intent=":literal"><semantics><msub><mi mathsize="0.800em">σ</mi><mi mathsize="0.800em">z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{z}" class="ltx_Math" display="inline" id="S4.T1.m6" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">z</mi></msub><annotation encoding="application/x-tex">p_{z}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="Y_{0}" class="ltx_Math" display="inline" id="S4.T1.m7" intent=":literal"><semantics><msub><mi mathsize="0.800em">Y</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">Y_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma_{y}" class="ltx_Math" display="inline" id="S4.T1.m8" intent=":literal"><semantics><msub><mi mathsize="0.800em">σ</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">\sigma_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{y}" class="ltx_Math" display="inline" id="S4.T1.m9" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">p_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="S_{0}" class="ltx_Math" display="inline" id="S4.T1.m10" intent=":literal"><semantics><msub><mi mathsize="0.800em">S</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">S_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma" class="ltx_Math" display="inline" id="S4.T1.m11" intent=":literal"><semantics><mi mathsize="0.800em">σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="r" class="ltx_Math" display="inline" id="S4.T1.m12" intent=":literal"><semantics><mi mathsize="0.800em">r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="T" class="ltx_Math" display="inline" id="S4.T1.m13" intent=":literal"><semantics><mi mathsize="0.800em">T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N" class="ltx_Math" display="inline" id="S4.T1.m14" intent=":literal"><semantics><mi mathsize="0.800em">N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">value</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">15%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3.3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3yr</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">48</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" style="font-size:113%;">Table 1</span>: </span><span class="ltx_text" style="font-size:113%;"> parameter values </span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.F4.fig1" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="336" id="S4.F4.g1" src="p-T1-1yr-3yr.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the marginal price distributions under the equilibrium measure <math alttext="(P)" class="ltx_Math" display="inline" id="S4.F4.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P)</annotation></semantics></math> and the risk-neutral measures <math alttext="(Q)" class="ltx_Math" display="inline" id="S4.F4.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Q)</annotation></semantics></math>
at 1-year and 3-year points for <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.F4.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.F4.fig2" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="S4.F4.g2" src="p-T1-3yr-top-bottom.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the marginal price distribution <math alttext="P" class="ltx_Math" display="inline" id="S4.F4.m11" intent=":literal"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math> and the conditional price distributions <math alttext="P(\cdot|Y^{\rm top-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F4.m12" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>top</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm top-25\%})</annotation></semantics></math>
and <math alttext="P(\cdot|Y^{\rm bottom-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F4.m13" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>bottom</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm bottom-25\%})</annotation></semantics></math> at 3-year point for <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.F4.m14" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S4.F4.fig3" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S4.F4.g3" src="p-T1-exp.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the expected values of <math alttext="S(t_{n})" class="ltx_Math" display="inline" id="S4.F4.m17" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t_{n})</annotation></semantics></math> under the equilibrium and the risk-neutral measures
for <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.F4.m18" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S4.F4.fig4" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="336" id="S4.F4.g4" src="p-T1-phi.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" style="font-size:80%;">The time evolution of the expected trading volume <math alttext="\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S4.F4.m21" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msup><mi>ϕ</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}</annotation></semantics></math> of the optimal stock position for <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.F4.m22" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p">Let us first assume that there is no external oder flow <math alttext="L_{n}\equiv 0" class="ltx_Math" display="inline" id="S4.SS1.p3.m1" intent=":literal"><semantics><mrow><msub><mi>L</mi><mi>n</mi></msub><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_{n}\equiv 0</annotation></semantics></math>, and that the
terminal liability <math alttext="F" class="ltx_Math" display="inline" id="S4.SS1.p3.m2" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is given by the function</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="F(S_{N},Y_{N},Z_{N}^{i}):=C-3S_{N}Y_{N}Z_{N}^{i}," class="ltx_Math" display="block" id="S4.E1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>C</mi><mo>−</mo><mrow><mn>3</mn><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>Y</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">F(S_{N},Y_{N},Z_{N}^{i}):=C-3S_{N}Y_{N}Z_{N}^{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="C\in\mathbb{R}" class="ltx_Math" display="inline" id="S4.SS1.p3.m3" intent=":literal"><semantics><mrow><mi>C</mi><mo>∈</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">C\in\mathbb{R}</annotation></semantics></math> is an arbitrary real constant. Since the result is unchanged by the constant shift,
one can adjust, if necessary, the constant <math alttext="C" class="ltx_Math" display="inline" id="S4.SS1.p3.m4" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math> to make the liability positive.
From the discussion in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="2.4 Some implications ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a>,
we expect that the equilibrium price distribution for this liability has positive excess return.
We can check if this is actually the case by observing Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F4" title="Figure 4 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>,
which presents the comparison of the marginal price distributions under the equilibrium measure <math alttext="(P)" class="ltx_Math" display="inline" id="S4.SS1.p3.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P)</annotation></semantics></math>
and the risk-neutral measure <math alttext="(Q)" class="ltx_Math" display="inline" id="S4.SS1.p3.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Q)</annotation></semantics></math> at 1-year and 3-year points.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p">We can also provide the conditional price distribution <math alttext="\mathbb{P}(S_{n}\in A|Y_{n}=y),~\forall A\subset{\cal S}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p4.m1" intent=":literal"><semantics><mrow><mrow><mrow><mi>ℙ</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>∈</mo><mrow><mi>A</mi><mo fence="false">|</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow><mo>=</mo><mi>y</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.497em">,</mo><mrow><mo rspace="0.167em">∀</mo><mi>A</mi></mrow></mrow><mo>⊂</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{P}(S_{n}\in A|Y_{n}=y),~\forall A\subset{\cal S}_{n}</annotation></semantics></math> for each <math alttext="y\in{\cal Y}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p4.m2" intent=":literal"><semantics><mrow><mi>y</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">𝒴</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y\in{\cal Y}_{n}</annotation></semantics></math>.
At 3-year point, the value of <math alttext="Y" class="ltx_Math" display="inline" id="S4.SS1.p4.m3" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> that marks the top 25% <math alttext="(Y^{\rm top-25})" class="ltx_Math" display="inline" id="S4.SS1.p4.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>Y</mi><mrow><mi>top</mi><mo>−</mo><mn>25</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Y^{\rm top-25})</annotation></semantics></math> (resp. bottom 25% <math alttext="(Y^{\rm bottom-25})" class="ltx_Math" display="inline" id="S4.SS1.p4.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>Y</mi><mrow><mi>bottom</mi><mo>−</mo><mn>25</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Y^{\rm bottom-25})</annotation></semantics></math>)
is equivalent to a total of 36 up moves (resp. 12 up moves). Comparison of the conditional distributions
<math alttext="\{\mathbb{P}(S_{n}=s|Y^{\rm top-25}),~\mathbb{P}(S_{n}=s|Y^{\rm bottom-25}),~\forall s\in{\cal S}_{n}\}" class="ltx_Math" display="inline" id="S4.SS1.p4.m6" intent=":literal"><semantics><mrow><mo stretchy="false">{</mo><mrow><mrow><mrow><mi>ℙ</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>s</mi><mo fence="false">|</mo><msup><mi>Y</mi><mrow><mi>top</mi><mo>−</mo><mn>25</mn></mrow></msup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.497em">,</mo><mrow><mi>ℙ</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>s</mi><mo fence="false">|</mo><msup><mi>Y</mi><mrow><mi>bottom</mi><mo>−</mo><mn>25</mn></mrow></msup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.497em">,</mo><mrow><mo rspace="0.167em">∀</mo><mi>s</mi></mrow></mrow><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>n</mi></msub></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbb{P}(S_{n}=s|Y^{\rm top-25}),~\mathbb{P}(S_{n}=s|Y^{\rm bottom-25}),~\forall s\in{\cal S}_{n}\}</annotation></semantics></math> and the
marginal distribution at 3-year point <math alttext="(n=48)" class="ltx_Math" display="inline" id="S4.SS1.p4.m7" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>=</mo><mn>48</mn></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n=48)</annotation></semantics></math> is given in Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F4" title="Figure 4 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>.
As expected from the functional form in <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.SS1.p4.m8" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>, the deviations from the risk-neutral distribution
are positive and become larger for the larger value of <math alttext="Y" class="ltx_Math" display="inline" id="S4.SS1.p4.m9" intent=":literal"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F4" title="Figure 4 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>, we provide the time-evolution of <math alttext="(\mathbb{E}^{\mathbb{P}}[S(t)],\mathbb{E}^{\mathbb{Q}}[S(t)])" class="ltx_Math" display="inline" id="S4.SS1.p4.m10" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>,</mo><mrow><msup><mi>𝔼</mi><mi>ℚ</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbb{E}^{\mathbb{P}}[S(t)],\mathbb{E}^{\mathbb{Q}}[S(t)])</annotation></semantics></math>,
the expected value of the stock price under the equilibrium measure and the risk-neutral measure, respectively.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F4" title="Figure 4 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a> gives the time-evolution of the expected trading volume <math alttext="\sqrt{\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]}" class="ltx_Math" display="inline" id="S4.SS1.p4.m11" intent=":literal"><semantics><msqrt><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msup><mi>ϕ</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p">In Figures <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F8" title="Figure 8 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">8</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F8" title="Figure 8 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">8</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F8" title="Figure 8 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">8</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F8" title="Figure 8 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">8</span></a>, we present
the corresponding results for the different liability function</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="F(S_{N},Y_{N},Z_{N}^{i}):=C+3S_{N}Y_{N}Z_{N}^{i}" class="ltx_Math" display="block" id="S4.E2.m1" intent=":literal"><semantics><mrow><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>C</mi><mo>+</mo><mrow><mn>3</mn><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>Y</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup></mrow></mrow></mrow><annotation encoding="application/x-tex">F(S_{N},Y_{N},Z_{N}^{i}):=C+3S_{N}Y_{N}Z_{N}^{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which exhibits the opposite sign of sensitivity to the stock price. We see that the excess return becomes negative in this case.</p>
</div>
<figure class="ltx_figure" id="S4.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.F8.fig1" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="S4.F8.g1" src="p-T2-1yr-3yr.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the marginal price distributions under the equilibrium measure <math alttext="(P)" class="ltx_Math" display="inline" id="S4.F8.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P)</annotation></semantics></math> and the risk-neutral measures <math alttext="(Q)" class="ltx_Math" display="inline" id="S4.F8.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Q)</annotation></semantics></math>
at 1-year and 3-year points for <math alttext="(\ref{Terminal-F2})" class="ltx_Math" display="inline" id="S4.F8.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E2" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F2})</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.F8.fig2" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="S4.F8.g2" src="p-T2-3yr-top-bottom.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the marginal price distribution <math alttext="P" class="ltx_Math" display="inline" id="S4.F8.m11" intent=":literal"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math> and the conditional price distributions <math alttext="P(\cdot|Y^{\rm top-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F8.m12" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>top</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm top-25\%})</annotation></semantics></math>
and <math alttext="P(\cdot|Y^{\rm bottom-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F8.m13" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>bottom</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm bottom-25\%})</annotation></semantics></math> at 3-year point for <math alttext="(\ref{Terminal-F2})" class="ltx_Math" display="inline" id="S4.F8.m14" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E2" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F2})</annotation></semantics></math>. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S4.F8.fig3" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F8.g3" src="p-T2-exp.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the expected values of <math alttext="S(t_{n})" class="ltx_Math" display="inline" id="S4.F8.m17" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t_{n})</annotation></semantics></math> under the equilibrium and the risk-neutral measures
for <math alttext="(\ref{Terminal-F2})" class="ltx_Math" display="inline" id="S4.F8.m18" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E2" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F2})</annotation></semantics></math>. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S4.F8.fig4" style="width:230.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="S4.F8.g4" src="p-T2-phi.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" style="font-size:80%;">The time evolution of the expected trading volume <math alttext="\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S4.F8.m21" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msup><mi>ϕ</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}</annotation></semantics></math> of the optimal stock position for <math alttext="(\ref{Terminal-F2})" class="ltx_Math" display="inline" id="S4.F8.m22" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E2" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.2</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F2})</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p">Now, let us turn on the external order flow. We continue to use the same parameter values in Table <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.T1" title="Table 1 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">1</span></a>
and the liability function defined by <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.SS1.p6.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math>, but now with external order flow (without <math alttext="y" class="ltx_Math" display="inline" id="S4.SS1.p6.m2" intent=":literal"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-dependence):</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{n}(s):=a\max(s-c,0)." class="ltx_Math" display="block" id="S4.E3.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>L</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>a</mi><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo>−</mo><mi>c</mi></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">L_{n}(s):=a\max(s-c,0).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">We set <math alttext="c=1.75" class="ltx_Math" display="inline" id="S4.SS1.p6.m3" intent=":literal"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1.75</mn></mrow><annotation encoding="application/x-tex">c=1.75</annotation></semantics></math> and consider two scenarios, one is <math alttext="a=7" class="ltx_Math" display="inline" id="S4.SS1.p6.m4" intent=":literal"><semantics><mrow><mi>a</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">a=7</annotation></semantics></math> and the other is <math alttext="a=-7" class="ltx_Math" display="inline" id="S4.SS1.p6.m5" intent=":literal"><semantics><mrow><mi>a</mi><mo>=</mo><mrow><mo>−</mo><mn>7</mn></mrow></mrow><annotation encoding="application/x-tex">a=-7</annotation></semantics></math>. In the former case, there is positive supply of the stock
when the stock price is very large <math alttext="s&gt;1.75" class="ltx_Math" display="inline" id="S4.SS1.p6.m6" intent=":literal"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>1.75</mn></mrow><annotation encoding="application/x-tex">s&gt;1.75</annotation></semantics></math>, and in the latter case the positive demand (i.e. negative supply) for <math alttext="s&gt;1.75" class="ltx_Math" display="inline" id="S4.SS1.p6.m7" intent=":literal"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>1.75</mn></mrow><annotation encoding="application/x-tex">s&gt;1.75</annotation></semantics></math>.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F9" title="Figure 9 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">9</span></a>, we compare the marginal as well as conditional price distribution as in Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F4" title="Figure 4 ‣ 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4</span></a>
with the positive external order flow in the left panel and the negative one in the right panel.
We can clearly observe that the positive supply generates a heavy right tail in the equilibrium distributions
and that the positive demand causes the opposite. In order to absorb positive supply, higher excess return
is required by the agents.</p>
</div>
<figure class="ltx_figure" id="S4.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:233.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="366" id="S4.F9.g1" src="p-T1-3yr-TB-Lplus.png" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:233.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="364" id="S4.F9.g2" src="p-T1-3yr-TB-Lminus.png" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" style="font-size:80%;">Comparison of the marginal price distribution <math alttext="P" class="ltx_Math" display="inline" id="S4.F9.m8" intent=":literal"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math> and the conditional price distributions <math alttext="P(\cdot|Y^{\rm top-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F9.m9" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>top</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm top-25\%})</annotation></semantics></math>
and <math alttext="P(\cdot|Y^{\rm bottom-25\%})" class="ltx_math_unparsed" display="inline" id="S4.F9.m10" intent=":literal"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false">|</mo><msup><mi>Y</mi><mrow><mi>bottom</mi><mo>−</mo><mrow><mn>25</mn><mo>%</mo></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\cdot|Y^{\rm bottom-25\%})</annotation></semantics></math> at 3-year point. <math alttext="F" class="ltx_Math" display="inline" id="S4.F9.m11" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is given by <math alttext="(\ref{Terminal-F1})" class="ltx_Math" display="inline" id="S4.F9.m12" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E1" title="In 4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{Terminal-F1})</annotation></semantics></math> and the
external order flow is equal to <math alttext="L_{n}(s)=7\max(s-1.75,0)" class="ltx_Math" display="inline" id="S4.F9.m13" intent=":literal"><semantics><mrow><mrow><msub><mi>L</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>7</mn><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo>−</mo><mn>1.75</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">L_{n}(s)=7\max(s-1.75,0)</annotation></semantics></math> (i.e. positive supply) in the left panel
and <math alttext="L_{n}(s)=-7\max(s-1.75,0)" class="ltx_Math" display="inline" id="S4.F9.m14" intent=":literal"><semantics><mrow><mrow><msub><mi>L</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>−</mo><mrow><mn>7</mn><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo>−</mo><mn>1.75</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">L_{n}(s)=-7\max(s-1.75,0)</annotation></semantics></math> (i.e. positive demand) in the right panel.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Recursive utility</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p">We now consider the recursive utility model discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3" title="3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3</span></a>.
For numerical ease, we assume no path-dependence.
The liability <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.p1.m1" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> is then assumed to depend solely on the terminal stock price <math alttext="S_{N}" class="ltx_Math" display="inline" id="S4.SS2.p1.m2" intent=":literal"><semantics><msub><mi>S</mi><mi>N</mi></msub><annotation encoding="application/x-tex">S_{N}</annotation></semantics></math>,
while the incremental endowments <math alttext="g_{n}" class="ltx_Math" display="inline" id="S4.SS2.p1.m3" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> depend solely on the current price <math alttext="S_{n}" class="ltx_Math" display="inline" id="S4.SS2.p1.m4" intent=":literal"><semantics><msub><mi>S</mi><mi>n</mi></msub><annotation encoding="application/x-tex">S_{n}</annotation></semantics></math>.
See Remark <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.Thmremark2" title="Remark 3.2. ‣ 3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.2</span></a>
for the corresponding results.
We use the same models for <math alttext="(S_{n},Y_{n},Z_{n}^{i})_{n=0}^{N}" class="ltx_Math" display="inline" id="S4.SS2.p1.m5" intent=":literal"><semantics><msubsup><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><annotation encoding="application/x-tex">(S_{n},Y_{n},Z_{n}^{i})_{n=0}^{N}</annotation></semantics></math> and <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.m6" intent=":literal"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_{i}</annotation></semantics></math> as in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.SS1" title="4.1 Utility for terminal wealth ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.1</span></a>.
<math alttext="\psi_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.m7" intent=":literal"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math> is assumed to have a uniform distribution over <math alttext="(N_{\psi}+1)" class="ltx_Math" display="inline" id="S4.SS2.p1.m8" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mrow><msub><mi>N</mi><mi>ψ</mi></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N_{\psi}+1)</annotation></semantics></math> discrete values given by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\psi_{i}(k_{\psi}):=\underline{\psi}+(\overline{\psi}-\underline{\psi})\frac{k_{\psi}}{N_{\psi}},\quad k_{\psi}=0,\cdots,N_{\psi}." class="ltx_Math" display="block" id="S4.Ex4.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>ψ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><munder accentunder="true"><mi>ψ</mi><mo stretchy="true">¯</mo></munder><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>ψ</mi><mo stretchy="true">¯</mo></mover><mo>−</mo><munder accentunder="true"><mi>ψ</mi><mo stretchy="true">¯</mo></munder></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">​</mo><mfrac><msub><mi>k</mi><mi>ψ</mi></msub><msub><mi>N</mi><mi>ψ</mi></msub></mfrac></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><msub><mi>k</mi><mi>ψ</mi></msub><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="normal">⋯</mi><mo>,</mo><msub><mi>N</mi><mi>ψ</mi></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\psi_{i}(k_{\psi}):=\underline{\psi}+(\overline{\psi}-\underline{\psi})\frac{k_{\psi}}{N_{\psi}},\quad k_{\psi}=0,\cdots,N_{\psi}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">For simplicity, we assume that <math alttext="\delta_{i}:=\exp(-\rho\Delta)" class="ltx_Math" display="inline" id="S4.SS2.p1.m9" intent=":literal"><semantics><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo>:=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mrow><mi>ρ</mi><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\delta_{i}:=\exp(-\rho\Delta)</annotation></semantics></math> has a common value across the agents.
Moreover, we assume that <math alttext="\zeta_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.m10" intent=":literal"><semantics><msub><mi>ζ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\zeta_{i}</annotation></semantics></math> and <math alttext="\psi_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.m11" intent=":literal"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math> are related by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\psi_{i}/\zeta_{i}=a_{\zeta}," class="ltx_Math" display="block" id="S4.Ex5.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>/</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow><mo>=</mo><msub><mi>a</mi><mi>ζ</mi></msub></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\psi_{i}/\zeta_{i}=a_{\zeta},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="a_{\zeta}" class="ltx_Math" display="inline" id="S4.SS2.p1.m12" intent=":literal"><semantics><msub><mi>a</mi><mi>ζ</mi></msub><annotation encoding="application/x-tex">a_{\zeta}</annotation></semantics></math> is a positive constant common across the agents. We shall use the parameter <math alttext="a_{\zeta}" class="ltx_Math" display="inline" id="S4.SS2.p1.m13" intent=":literal"><semantics><msub><mi>a</mi><mi>ζ</mi></msub><annotation encoding="application/x-tex">a_{\zeta}</annotation></semantics></math> to control the ratio <math alttext="\eta_{n-1}^{i}/\eta_{n}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.m14" intent=":literal"><semantics><mrow><msubsup><mi>η</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>/</mo><msubsup><mi>η</mi><mi>n</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">\eta_{n-1}^{i}/\eta_{n}^{i}</annotation></semantics></math>.
The parameter values to be used throughout this subsection (expect the last example) are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.T2" title="Table 2 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2</span></a> below.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">parameter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\underline{\gamma}" class="ltx_Math" display="inline" id="S4.T2.m1" intent=":literal"><semantics><munder accentunder="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></munder><annotation encoding="application/x-tex">\underline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\overline{\gamma}" class="ltx_Math" display="inline" id="S4.T2.m2" intent=":literal"><semantics><mover accent="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N_{\gamma}" class="ltx_Math" display="inline" id="S4.T2.m3" intent=":literal"><semantics><msub><mi mathsize="0.800em">N</mi><mi mathsize="0.800em">γ</mi></msub><annotation encoding="application/x-tex">N_{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\underline{\psi}" class="ltx_Math" display="inline" id="S4.T2.m4" intent=":literal"><semantics><munder accentunder="true"><mi mathsize="0.800em">ψ</mi><mo stretchy="true">¯</mo></munder><annotation encoding="application/x-tex">\underline{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\overline{\psi}" class="ltx_Math" display="inline" id="S4.T2.m5" intent=":literal"><semantics><mover accent="true"><mi mathsize="0.800em">ψ</mi><mo stretchy="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N_{\psi}" class="ltx_Math" display="inline" id="S4.T2.m6" intent=":literal"><semantics><msub><mi mathsize="0.800em">N</mi><mi mathsize="0.800em">ψ</mi></msub><annotation encoding="application/x-tex">N_{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\rho" class="ltx_Math" display="inline" id="S4.T2.m7" intent=":literal"><semantics><mi mathsize="0.800em">ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="z_{0}" class="ltx_Math" display="inline" id="S4.T2.m8" intent=":literal"><semantics><msub><mi mathsize="0.800em">z</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">z_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.T2.m9" intent=":literal"><semantics><msub><mi mathsize="0.800em">σ</mi><mi mathsize="0.800em">z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{z}" class="ltx_Math" display="inline" id="S4.T2.m10" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">z</mi></msub><annotation encoding="application/x-tex">p_{z}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="Y_{0}" class="ltx_Math" display="inline" id="S4.T2.m11" intent=":literal"><semantics><msub><mi mathsize="0.800em">Y</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">Y_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma_{y}" class="ltx_Math" display="inline" id="S4.T2.m12" intent=":literal"><semantics><msub><mi mathsize="0.800em">σ</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">\sigma_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{y}" class="ltx_Math" display="inline" id="S4.T2.m13" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">p_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="S_{0}" class="ltx_Math" display="inline" id="S4.T2.m14" intent=":literal"><semantics><msub><mi mathsize="0.800em">S</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">S_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma" class="ltx_Math" display="inline" id="S4.T2.m15" intent=":literal"><semantics><mi mathsize="0.800em">σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="r" class="ltx_Math" display="inline" id="S4.T2.m16" intent=":literal"><semantics><mi mathsize="0.800em">r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="T" class="ltx_Math" display="inline" id="S4.T2.m17" intent=":literal"><semantics><mi mathsize="0.800em">T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N" class="ltx_Math" display="inline" id="S4.T2.m18" intent=":literal"><semantics><mi mathsize="0.800em">N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">value</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">5.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">15%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3.3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3yr</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">48</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" style="font-size:113%;">Table 2</span>: </span><span class="ltx_text" style="font-size:113%;">parameter values</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:233.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="336" id="S4.F11.g1" src="p-R1-1yr.png" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:233.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F11.g2" src="p-R1-3yr.png" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" style="font-size:90%;">Comparison of the risk-neutral as well as the equilibrium marginal price distributions with <math alttext="a_{\zeta}=0.9,0.95,1.0,1.05" class="ltx_Math" display="inline" id="S4.F11.m2" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mrow><mn>0.9</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.0</mn><mo>,</mo><mn>1.05</mn></mrow></mrow><annotation encoding="application/x-tex">a_{\zeta}=0.9,0.95,1.0,1.05</annotation></semantics></math> at 1-year (left panel) and 3-year (right panel) points.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S4.F11.fig1" style="width:469.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="198" id="S4.F11.g3" src="p-R-exp.png" width="324"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" style="font-size:90%;">Comparison of the expected values of <math alttext="S(t_{n})" class="ltx_Math" display="inline" id="S4.F11.m5" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t_{n})</annotation></semantics></math> under the risk-neutral as well as the equilibrium price distributions with
<math alttext="a_{\zeta}=0.9,0.95,1.0,1.05" class="ltx_Math" display="inline" id="S4.F11.m6" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mrow><mn>0.9</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.0</mn><mo>,</mo><mn>1.05</mn></mrow></mrow><annotation encoding="application/x-tex">a_{\zeta}=0.9,0.95,1.0,1.05</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p">Since the effects of the stochastic liability and incremental endowments on the equilibrium price distributions
are as expected from the results in the previous subsection, let us first concentrate on
the effects of the factor <math alttext="a_{\zeta}=\psi_{i}/\zeta_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.m1" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>/</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow></mrow><annotation encoding="application/x-tex">a_{\zeta}=\psi_{i}/\zeta_{i}</annotation></semantics></math>.
We set <math alttext="L_{n}\equiv 0,~\forall n" class="ltx_Math" display="inline" id="S4.SS2.p2.m2" intent=":literal"><semantics><mrow><msub><mi>L</mi><mi>n</mi></msub><mo>≡</mo><mrow><mn>0</mn><mo rspace="0.497em">,</mo><mrow><mo rspace="0.167em">∀</mo><mi>n</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">L_{n}\equiv 0,~\forall n</annotation></semantics></math> and define the liability function
and the incremental endowments in the following way:</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="S5.EGx1">
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle F(S_{N},Y_{N},Z_{N}^{i}):=C-2S_{N}Y_{N}Z_{N}^{i}," class="ltx_Math" display="inline" id="S4.E4.m2" intent=":literal"><semantics><mrow><mrow><mrow><mi>F</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>N</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>N</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><mi>C</mi><mo>−</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>Y</mi><mi>N</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>Z</mi><mi>N</mi><mi>i</mi></msubsup></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle F(S_{N},Y_{N},Z_{N}^{i}):=C-2S_{N}Y_{N}Z_{N}^{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle g_{n}(S_{n},Y_{n},Z_{n}^{i}):=C^{\prime}+1.5\Delta S_{n}Y_{n}Z_{n}^{i},\quad 1\leq n\leq N." class="ltx_Math" display="inline" id="S4.E5.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><msub><mi>g</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>:=</mo><mrow><msup><mi>C</mi><mo>′</mo></msup><mo>+</mo><mrow><mn>1.5</mn><mo lspace="0em" rspace="0em">​</mo><mi mathvariant="normal">Δ</mi><mo lspace="0em" rspace="0em">​</mo><msub><mi>S</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><msub><mi>Y</mi><mi>n</mi></msub><mo lspace="0em" rspace="0em">​</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mi>N</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle g_{n}(S_{n},Y_{n},Z_{n}^{i}):=C^{\prime}+1.5\Delta S_{n}Y_{n}Z_{n}^{i},\quad 1\leq n\leq N.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Here, <math alttext="C,C^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.p2.m3" intent=":literal"><semantics><mrow><mi>C</mi><mo>,</mo><msup><mi>C</mi><mo>′</mo></msup></mrow><annotation encoding="application/x-tex">C,C^{\prime}</annotation></semantics></math> are arbitrary constants irrelevant for the equilibrium distributions.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F11" title="Figure 11 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">11</span></a>, we plot the risk-neutral as well as the equilibrium marginal price distributions
with 4 different values of the ratio <math alttext="a_{\zeta}=0.9,0.95,1.0,1.05" class="ltx_Math" display="inline" id="S4.SS2.p2.m4" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mrow><mn>0.9</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.0</mn><mo>,</mo><mn>1.05</mn></mrow></mrow><annotation encoding="application/x-tex">a_{\zeta}=0.9,0.95,1.0,1.05</annotation></semantics></math> at 1-year (left panel) and 3-year (right panel) points.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F11" title="Figure 11 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">11</span></a> provides the time evolution of the expected value of the stock price <math alttext="S(t_{n})" class="ltx_Math" display="inline" id="S4.SS2.p2.m5" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t_{n})</annotation></semantics></math>
for each case. As inferred from the discussion in the last part of Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S3.SS3" title="3.3 Mean-field equilibrium among the agents with recursive utilities ‣ 3 Recursive utility optimization with path-dependent cash flows ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3.3</span></a>,
the deviations from the risk-neutral distribution become smaller as <math alttext="a_{\zeta}" class="ltx_Math" display="inline" id="S4.SS2.p2.m6" intent=":literal"><semantics><msub><mi>a</mi><mi>ζ</mi></msub><annotation encoding="application/x-tex">a_{\zeta}</annotation></semantics></math> decreases,
and this effect (smaller deviations) is more profound in earlier periods.
We can observe that the value of <math alttext="a_{\zeta}=\psi_{i}/\zeta_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.m7" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>/</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow></mrow><annotation encoding="application/x-tex">a_{\zeta}=\psi_{i}/\zeta_{i}</annotation></semantics></math> can efficiently control
the level of the risk-premium without changing the other parameters.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p">Next, let us turn off the incremental endowments <math alttext="g_{n}\equiv 0" class="ltx_Math" display="inline" id="S4.SS2.p3.m1" intent=":literal"><semantics><mrow><msub><mi>g</mi><mi>n</mi></msub><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g_{n}\equiv 0</annotation></semantics></math> while keeping the
liability function the same as in <math alttext="(\ref{num-functions})" class="ltx_Math" display="inline" id="S4.SS2.p3.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E4" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{num-functions})</annotation></semantics></math>.
We are now going to study the effects of an external order flow defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(S_{n})=8\max(S_{n}-1.6,0)-8\max(1.1-S_{n},0),\quad 0\leq n\leq N-1." class="ltx_Math" display="block" id="S4.E6.m1" intent=":literal"><semantics><mrow><mrow><mrow><mrow><mi>L</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>8</mn><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>−</mo><mn>1.6</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>−</mo><mrow><mn>8</mn><mo lspace="0.167em" rspace="0em">​</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1.1</mn><mo>−</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mn>0</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">L(S_{n})=8\max(S_{n}-1.6,0)-8\max(1.1-S_{n},0),\quad 0\leq n\leq N-1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(
4.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">to demonstrate how flexibly the shape of equilibrium distributions can change.
<math alttext="(\ref{eq-Lext})" class="ltx_Math" display="inline" id="S4.SS2.p3.m3" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E6" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-Lext})</annotation></semantics></math> means that there is positive supply (i.e. sell orders from other groups) of the stock when the stock price is high
and positive demand (i.e. buy orders from other groups) when the stock price is low.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F12" title="Figure 12 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">12</span></a>, with <math alttext="a_{\zeta}=1.07" class="ltx_Math" display="inline" id="S4.SS2.p3.m4" intent=":literal"><semantics><mrow><msub><mi>a</mi><mi>ζ</mi></msub><mo>=</mo><mn>1.07</mn></mrow><annotation encoding="application/x-tex">a_{\zeta}=1.07</annotation></semantics></math>,
we compare the equilibrium price distribution at 3-year point with <math alttext="L_{n}" class="ltx_Math" display="inline" id="S4.SS2.p3.m5" intent=":literal"><semantics><msub><mi>L</mi><mi>n</mi></msub><annotation encoding="application/x-tex">L_{n}</annotation></semantics></math> given by <math alttext="(\ref{eq-Lext})" class="ltx_Math" display="inline" id="S4.SS2.p3.m6" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E6" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-Lext})</annotation></semantics></math>
and that with <math alttext="L_{n}\equiv 0" class="ltx_Math" display="inline" id="S4.SS2.p3.m7" intent=":literal"><semantics><mrow><msub><mi>L</mi><mi>n</mi></msub><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_{n}\equiv 0</annotation></semantics></math>. It shows that the existence of the external order flow <math alttext="(\ref{eq-Lext})" class="ltx_Math" display="inline" id="S4.SS2.p3.m8" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E6" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-Lext})</annotation></semantics></math>
makes the equilibrium distribution fat-tailed in both directions, which is as expected by the analysis
made in the last paragraph of Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="2.4 Some implications ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a>.
Corresponding modifications in the terminal liability <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.p3.m9" intent=":literal"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> and/or the incremental endowments <math alttext="g_{n}" class="ltx_Math" display="inline" id="S4.SS2.p3.m10" intent=":literal"><semantics><msub><mi>g</mi><mi>n</mi></msub><annotation encoding="application/x-tex">g_{n}</annotation></semantics></math> would yield similar results.</p>
</div>
<figure class="ltx_figure" id="S4.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="189" id="S4.F12.g1" src="p-R1-L-nL.png" width="324"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 12</span>: </span><span class="ltx_text" style="font-size:90%;">Comparison of the stock price distributions at 3-year point with <math alttext="L_{n}" class="ltx_Math" display="inline" id="S4.F12.m4" intent=":literal"><semantics><msub><mi>L</mi><mi>n</mi></msub><annotation encoding="application/x-tex">L_{n}</annotation></semantics></math> given by <math alttext="(\ref{eq-Lext})" class="ltx_Math" display="inline" id="S4.F12.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E6" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.6</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{eq-Lext})</annotation></semantics></math> and <math alttext="L_{n}\equiv 0" class="ltx_Math" display="inline" id="S4.F12.m6" intent=":literal"><semantics><mrow><msub><mi>L</mi><mi>n</mi></msub><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_{n}\equiv 0</annotation></semantics></math> .</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p">In the last numerical example, we examine the effect of <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p4.m1" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math>, the volatility of the process <math alttext="(Z^{i}_{n})" class="ltx_Math" display="inline" id="S4.SS2.p4.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Z^{i}_{n})</annotation></semantics></math>,
on trading volume. This volume is quantified by the standard deviation of the stock position among the agents
<math alttext="\mathbb{E}^{1}[|\phi^{i,*}_{t}|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S4.SS2.p4.m3" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mn>1</mn></msup><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><msubsup><mi>ϕ</mi><mi>t</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}^{1}[|\phi^{i,*}_{t}|^{2}]^{\frac{1}{2}}</annotation></semantics></math>, as discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S2.SS4" title="2.4 Some implications ‣ 2 Utility optimization for terminal wealth ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">2.4</span></a>.
To highlight the effect of <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p4.m4" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math>, we reduce the variation in <math alttext="(\gamma_{i},\psi_{i},\zeta_{i})" class="ltx_Math" display="inline" id="S4.SS2.p4.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\gamma_{i},\psi_{i},\zeta_{i})</annotation></semantics></math>.
The parameter values we use are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.T3" title="Table 3 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">3</span></a> below:</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">parameter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\underline{\gamma}" class="ltx_Math" display="inline" id="S4.T3.m1" intent=":literal"><semantics><munder accentunder="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></munder><annotation encoding="application/x-tex">\underline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\overline{\gamma}" class="ltx_Math" display="inline" id="S4.T3.m2" intent=":literal"><semantics><mover accent="true"><mi mathsize="0.800em">γ</mi><mo stretchy="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N_{\gamma}" class="ltx_Math" display="inline" id="S4.T3.m3" intent=":literal"><semantics><msub><mi mathsize="0.800em">N</mi><mi mathsize="0.800em">γ</mi></msub><annotation encoding="application/x-tex">N_{\gamma}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\underline{\psi}" class="ltx_Math" display="inline" id="S4.T3.m4" intent=":literal"><semantics><munder accentunder="true"><mi mathsize="0.800em">ψ</mi><mo stretchy="true">¯</mo></munder><annotation encoding="application/x-tex">\underline{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\overline{\psi}" class="ltx_Math" display="inline" id="S4.T3.m5" intent=":literal"><semantics><mover accent="true"><mi mathsize="0.800em">ψ</mi><mo stretchy="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N_{\psi}" class="ltx_Math" display="inline" id="S4.T3.m6" intent=":literal"><semantics><msub><mi mathsize="0.800em">N</mi><mi mathsize="0.800em">ψ</mi></msub><annotation encoding="application/x-tex">N_{\psi}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\rho" class="ltx_Math" display="inline" id="S4.T3.m7" intent=":literal"><semantics><mi mathsize="0.800em">ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="z_{0}" class="ltx_Math" display="inline" id="S4.T3.m8" intent=":literal"><semantics><msub><mi mathsize="0.800em">z</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">z_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="a_{\zeta}" class="ltx_Math" display="inline" id="S4.T3.m9" intent=":literal"><semantics><msub><mi mathsize="0.800em">a</mi><mi mathsize="0.800em">ζ</mi></msub><annotation encoding="application/x-tex">a_{\zeta}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{z}" class="ltx_Math" display="inline" id="S4.T3.m10" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">z</mi></msub><annotation encoding="application/x-tex">p_{z}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="Y_{0}" class="ltx_Math" display="inline" id="S4.T3.m11" intent=":literal"><semantics><msub><mi mathsize="0.800em">Y</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">Y_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma_{y}" class="ltx_Math" display="inline" id="S4.T3.m12" intent=":literal"><semantics><msub><mi mathsize="0.800em">σ</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">\sigma_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="p_{y}" class="ltx_Math" display="inline" id="S4.T3.m13" intent=":literal"><semantics><msub><mi mathsize="0.800em">p</mi><mi mathsize="0.800em">y</mi></msub><annotation encoding="application/x-tex">p_{y}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="S_{0}" class="ltx_Math" display="inline" id="S4.T3.m14" intent=":literal"><semantics><msub><mi mathsize="0.800em">S</mi><mn mathsize="0.800em">0</mn></msub><annotation encoding="application/x-tex">S_{0}</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="\sigma" class="ltx_Math" display="inline" id="S4.T3.m15" intent=":literal"><semantics><mi mathsize="0.800em">σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="r" class="ltx_Math" display="inline" id="S4.T3.m16" intent=":literal"><semantics><mi mathsize="0.800em">r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="T" class="ltx_Math" display="inline" id="S4.T3.m17" intent=":literal"><semantics><mi mathsize="0.800em">T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><math alttext="N" class="ltx_Math" display="inline" id="S4.T3.m18" intent=":literal"><semantics><mi mathsize="0.800em">N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">value</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">5.0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">15%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3.3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">3yr</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" style="font-size:80%;">48</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" style="font-size:113%;">Table 3</span>: </span><span class="ltx_text" style="font-size:113%;">value of parameters for Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F13" title="Figure 13 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">13</span></a>.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p">We use the terminal liability and the incremental endowments defined by <math alttext="(\ref{num-functions})" class="ltx_Math" display="inline" id="S4.SS2.p5.m1" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E4" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{num-functions})</annotation></semantics></math> and <math alttext="(\ref{num-endow})" class="ltx_Math" display="inline" id="S4.SS2.p5.m2" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E5" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.5</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{num-endow})</annotation></semantics></math>.
In the right panel of Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F13" title="Figure 13 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">13</span></a>, we have plotted the evolution of the trading volume <math alttext="\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S4.SS2.p5.m3" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msup><mi>ϕ</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}</annotation></semantics></math>
for 5 different volatilities of the process <math alttext="(Z^{i}_{n})" class="ltx_Math" display="inline" id="S4.SS2.p5.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Z^{i}_{n})</annotation></semantics></math>: <math alttext="\sigma_{z}=0\%,~5\%,~10\%,~15\%,~20\%" class="ltx_Math" display="inline" id="S4.SS2.p5.m5" intent=":literal"><semantics><mrow><msub><mi>σ</mi><mi>z</mi></msub><mo>=</mo><mrow><mrow><mn>0</mn><mo>%</mo></mrow><mo rspace="0.497em">,</mo><mrow><mn>5</mn><mo>%</mo></mrow><mo rspace="0.497em">,</mo><mrow><mn>10</mn><mo>%</mo></mrow><mo rspace="0.497em">,</mo><mrow><mn>15</mn><mo>%</mo></mrow><mo rspace="0.497em">,</mo><mrow><mn>20</mn><mo>%</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\sigma_{z}=0\%,~5\%,~10\%,~15\%,~20\%</annotation></semantics></math>.
We observe that the trading volume increases with the volatility <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p5.m6" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math>.
The non-zero trading volume, even when <math alttext="\sigma_{z}=0" class="ltx_Math" display="inline" id="S4.SS2.p5.m7" intent=":literal"><semantics><mrow><msub><mi>σ</mi><mi>z</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma_{z}=0</annotation></semantics></math>, stems from the non-zero variation in the risk-aversion coefficients.
The near-identical trading volume
in the earliest period is a consequence of our assumption that the agents have the common initial value <math alttext="Z_{0}^{i}\equiv z_{0}=1,~\forall i\in\mathbb{N}" class="ltx_Math" display="inline" id="S4.SS2.p5.m8" intent=":literal"><semantics><mrow><mrow><msubsup><mi>Z</mi><mn>0</mn><mi>i</mi></msubsup><mo>≡</mo><msub><mi>z</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><mo rspace="0.497em">,</mo><mrow><mrow><mo rspace="0.167em">∀</mo><mi>i</mi></mrow><mo>∈</mo><mi>ℕ</mi></mrow></mrow><annotation encoding="application/x-tex">Z_{0}^{i}\equiv z_{0}=1,~\forall i\in\mathbb{N}</annotation></semantics></math>, an assumption made solely for numerical convenience.</p>
</div>
<figure class="ltx_figure" id="S4.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:232.9pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="346" id="S4.F13.g1" src="p-R-sigma-Z-Exp.png" width="598"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:232.9pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="349" id="S4.F13.g2" src="p-R-sigma-Z-phi.png" width="598"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure 13</span>: </span><span class="ltx_text" style="font-size:90%;">Left panel: Comparison of the expected value of <math alttext="S(t_{n})" class="ltx_Math" display="inline" id="S4.F13.m5" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t_{n})</annotation></semantics></math> under the risk-neutral as well as the equilibrium price distributions with
<math alttext="\sigma_{z}=0\%,5\%,10\%,15\%,20\%" class="ltx_Math" display="inline" id="S4.F13.m6" intent=":literal"><semantics><mrow><msub><mi>σ</mi><mi>z</mi></msub><mo>=</mo><mrow><mrow><mn>0</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>5</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>10</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>15</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>20</mn><mo>%</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\sigma_{z}=0\%,5\%,10\%,15\%,20\%</annotation></semantics></math>.
Right panel: Comparison of the trading volumes <math alttext="\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}" class="ltx_Math" display="inline" id="S4.F13.m7" intent=":literal"><semantics><mrow><msup><mi>𝔼</mi><mi>ℙ</mi></msup><mo lspace="0em" rspace="0em">​</mo><msup><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msup><mi>ϕ</mi><mrow><mn>1</mn><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msup><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\mathbb{E}^{\mathbb{P}}[|\phi^{1,*}(t)|^{2}]^{\frac{1}{2}}</annotation></semantics></math> with <math alttext="\sigma_{z}:=0\%,5\%,10\%,15\%,20\%" class="ltx_Math" display="inline" id="S4.F13.m8" intent=":literal"><semantics><mrow><msub><mi>σ</mi><mi>z</mi></msub><mo>:=</mo><mrow><mrow><mn>0</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>5</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>10</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>15</mn><mo>%</mo></mrow><mo>,</mo><mrow><mn>20</mn><mo>%</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\sigma_{z}:=0\%,5\%,10\%,15\%,20\%</annotation></semantics></math>.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p6">
<p class="ltx_p">In the left panel of Figure <a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#S4.F13" title="Figure 13 ‣ 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">13</span></a>, we have plotted the evolution of the expected value of <math alttext="S(t)" class="ltx_Math" display="inline" id="S4.SS2.p6.m1" intent=":literal"><semantics><mrow><mi>S</mi><mo lspace="0em" rspace="0em">​</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math> for each case of <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p6.m2" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math>.
(The result for the risk-neutral measure is also plotted for reference.)
From this result, we see that the size of excess return is almost unaffected by the volatility <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p6.m3" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math>.
This stems from the functional form of <math alttext="(\ref{num-functions})" class="ltx_Math" display="inline" id="S4.SS2.p6.m4" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E4" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.4</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{num-functions})</annotation></semantics></math> and <math alttext="(\ref{num-endow})" class="ltx_Math" display="inline" id="S4.SS2.p6.m5" intent=":literal"><semantics><mrow><mo stretchy="false">(</mo><mtext class="ltx_mathvariant_italic"><a class="ltx_ref ltx_font_italic" href="https://arxiv.org/html/2510.11261v1#S4.E5" title="In 4.2 Recursive utility ‣ 4 Numerical examples ‣ Mean-Field Price Formation on Trees 11footnote 1The authors are not responsible in any manner for any losses caused by the use of any contents in this research."><span class="ltx_text ltx_ref_tag">4.5</span></a></mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\ref{num-endow})</annotation></semantics></math>, as well as the fact that the expectation value of <math alttext="Z^{i}_{n}" class="ltx_Math" display="inline" id="S4.SS2.p6.m6" intent=":literal"><semantics><msubsup><mi>Z</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">Z^{i}_{n}</annotation></semantics></math> remains nearly identical across all cases. These results suggest that we can control trading volume by changing <math alttext="\sigma_{z}" class="ltx_Math" display="inline" id="S4.SS2.p6.m7" intent=":literal"><semantics><msub><mi>σ</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\sigma_{z}</annotation></semantics></math> without significantly affecting the risk-premium.
Although trading volume is also significantly influenced by the variation in <math alttext="{\cal F}_{0}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p6.m8" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">ℱ</mi><mn>0</mn><mi>i</mi></msubsup><annotation encoding="application/x-tex">{\cal F}_{0}^{i}</annotation></semantics></math>-measurable random variables such as <math alttext="\gamma_{i},\zeta_{i}" class="ltx_Math" display="inline" id="S4.SS2.p6.m9" intent=":literal"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ζ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_{i},\zeta_{i}</annotation></semantics></math> and
<math alttext="\psi_{i}" class="ltx_Math" display="inline" id="S4.SS2.p6.m10" intent=":literal"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math>, these variables may simultaneously induce a large change in the risk-premium.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Concluding remarks and future research directions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p">In this work, we have proved the existence of the unique mean-field equilibrium for agents with exponential-type utilities and derived an explicit formula for equilibrium transition probabilities of the stock price by restricting its trajectories onto a recombining binomial tree. The agents are supposed to have stochastic terminal liabilities and incremental endowments, both dependent on unhedgeable common and idiosyncratic factors in addition to the past trajectory of the stock price. We also examined the impacts of external order flow.
Finally, we provided numerical examples to illustrate qualitative effects of these components on the equilibrium price distributions. Our results clearly show that the equilibrium distributions can substantially change their shapes in response to these inputs. In particular, focusing on liabilities whose size changes countercyclically with market performance, we have found that the more levered financial firms and institutional investors are, the higher the risk premium is. The same observation also holds for cyclical endowments, i.e., non-tradable incomes originating from the firms’ other business lines. Empirical analysis regarding this finding would constitute an important research topic.
On the other hand, the trading volume per capita crucially depends on the variation in idiosyncratic factors.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p">Our method can also be applied to other asset classes, such as commodities and foreign exchanges, as long as they can be
modeled by binomial trees.
The Black-Derman-Toy model (BDG) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib8" title="">8</a>]</cite>, which is a famous short-rate model constructed on a binomial tree, may provide an
interesting framework to analyze a mean-field equilibrium for a risk-free interest rates.
Although many of them are becoming obsolete in today’s financial markets,
various techniques (such as “implied binomial trees”) have been developed by practitioners for tree-based derivative pricing
since its initial invention by Sharpe. These can now serve as valuable tools for investigating the mean-field equilibrium in our framework.
For a comprehensive overview of general Markov processes for financial applications,
see, for example, the textbooks by Bäuerle &amp; Rieder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib7" title="">7</a>]</cite> and Hernández-Lerma &amp; Lasserre <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p">Extensions to general multinomial trees and multi-asset frameworks constitute interesting future research directions.
Although our framework remains conceptually the same, there appear several hurdles to be overcome.</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p">Although it is not difficult to put appropriate assumptions so that there exists a unique optimal solution,
its explicit form is generally unavailable.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p">There are more degrees of freedom in the transition probabilities than are imposed by the market-clearing
conditions. This remaining freedom must be fixed by imposing an appropriate dependence structure among the assets.</p>
</div>
</li>
</ul>
<p class="ltx_p">Due to these issues, although the second point might be beneficial for flexibility,
numerical costs would be significantly higher than the single asset case, in particular, in the presence of
common noises. The fact that the market-clearing condition alone does not uniquely determine the asset price process
is already well known. (See, Karatzas &amp; Shreve <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2510.11261v1#bib.bib30" title="">30</a>, Chapter 4]</cite>.)
This is because that one can build a equivalent set of mutual funds
from the original stocks without affecting the market-clearing condition.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p">Constructing mean-field equilibrium among agents with other utilities, such as power type, remains one of the most challenging problems.
This is a common issue, mirroring the challenge in the continuous-time setting. For utilities other than the exponential-type, the optimal
trade position <math alttext="\phi^{i,*}_{n}" class="ltx_Math" display="inline" id="S5.p4.m1" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n}</annotation></semantics></math> is, in general, dependent on the size of weal at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S5.p4.m2" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>.
Since the wealth of each agent <math alttext="w_{n}^{i}" class="ltx_Math" display="inline" id="S5.p4.m3" intent=":literal"><semantics><msubsup><mi>w</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">w_{n}^{i}</annotation></semantics></math> at <math alttext="t_{n}" class="ltx_Math" display="inline" id="S5.p4.m4" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math> depends on the trading strategy up to <math alttext="t_{n}" class="ltx_Math" display="inline" id="S5.p4.m5" intent=":literal"><semantics><msub><mi>t</mi><mi>n</mi></msub><annotation encoding="application/x-tex">t_{n}</annotation></semantics></math>,
the mean-field equilibrium condition leads to a complex fixed-point problem involving the backward <math alttext="\phi^{i,*}_{n}" class="ltx_Math" display="inline" id="S5.p4.m6" intent=":literal"><semantics><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi^{i,*}_{n}</annotation></semantics></math>
and forward <math alttext="w_{n}^{i}" class="ltx_Math" display="inline" id="S5.p4.m7" intent=":literal"><semantics><msubsup><mi>w</mi><mi>n</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">w_{n}^{i}</annotation></semantics></math> discrete processes.
Although we can decouple the wealth process by deliberately constructing the model so that <math alttext="\phi^{i,*}_{n}\equiv 0" class="ltx_Math" display="inline" id="S5.p4.m8" intent=":literal"><semantics><mrow><msubsup><mi>ϕ</mi><mi>n</mi><mrow><mi>i</mi><mo rspace="0em">,</mo><mo lspace="0em">∗</mo></mrow></msubsup><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi^{i,*}_{n}\equiv 0</annotation></semantics></math>,
the resulting model allows no trading activity in the market and is thus clearly unrealistic.</p>
</div>
<section class="ltx_subsection" id="S5.SSx1">
<h3 class="ltx_title ltx_title_subsection">Acknowledgements</h3>
<div class="ltx_para" id="S5.SSx1.p1">
<p class="ltx_p">The author would like to thank M. Sekine for useful discussions related to the earlier works.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Achdou, Y., Han, J., Lasry, J., Lions, P. and Moll, B., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Partial differential equation models
in macroeconomics</span><span class="ltx_text" style="font-size:90%;">, Philosophical Transaction of The Royal Society, 2014, A 372:20130397.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Achdou, Y., Han, J., Lasry, J., Lions, P. and Moll, B., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Income and wealth distributions in
macroeconomics: A continuous-time approach</span><span class="ltx_text" style="font-size:90%;">, The Review of Economic Studies, 2021, Vol. 89, Issue 1, pp. 45-86.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Aïd, R., Possamaï, D., Touzi, N., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Optimal electricity demand response contracting with responsiveness incentives</span><span class="ltx_text" style="font-size:90%;">,
Mathematics of Operations Research, 2022, Vol. 47, No. 3, pp. 2112-2137.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Aïd, R., Bonesini, O., Callegaro, G., and Campi, L., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Continuous-time persuasion by filtering</span><span class="ltx_text" style="font-size:90%;">,
Journal of Economic Dynamics and Control, 2025, Vol. 176, 105100.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Bayraktar, E., Mitra, I., Zhang, J., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Countercyclical unemployment benefits: a general equilibrium analysis of transition
dynamics</span><span class="ltx_text" style="font-size:90%;">, Mathematics and Financial Economics, 2024, Vol. 18, pp. 213-232.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Ashrafyan, Y., Bakaryan, T., Gomes, D. and Gutierrez, J., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A duality approach to a price formation MFG model</span><span class="ltx_text" style="font-size:90%;">,
Minimax Theory and its Applications, 2023, Vol. 8, pp. 1-36.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Bäuerle, N. and Rieder, U., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Markov decision processes with applications to finance</span><span class="ltx_text" style="font-size:90%;">,
Universitext, 2011, Springer-Verlag Berlin.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Black, F., Derman, E. and Toy, W., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A one-factor model of interest rates and its applications to treasury bond options</span><span class="ltx_text" style="font-size:90%;">,
Financial Analysts Journal, 1990, pp. 24–32.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Carmona, R. and Delarue, F., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Probabilistic analysis of mean-field games</span><span class="ltx_text" style="font-size:90%;">, SIAM J. Control. Optim.,
2013, Vol. 51, No. 4, pp. 2705-2734.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Carmona, R. and Delarue, F., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Forward-backward stochastic differential equations and
controlled McKean-Vlasov dynamics</span><span class="ltx_text" style="font-size:90%;">, The Annals of Probability, 2015, Vol. 43, No. 5, pp. 2647-2700.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Carmona, R. and Delarue, F., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Probabilistic theory of mean field games with applications I</span><span class="ltx_text" style="font-size:90%;">, 2018,
Springer International Publishing, Switzerland.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Carmona, R. and Delarue, F., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Probabilistic theory of mean field games with applications II</span><span class="ltx_text" style="font-size:90%;">, 2018,
Springer International Publishing, Switzerland.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Cox, J.C., Ross, S.A. and Rubinstein, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Option Pricing: a simplified approach</span><span class="ltx_text" style="font-size:90%;">,
Journal of Financial Economics, 1979, Vol. 7, pp. 229-263.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Derman, E., and Kani, I., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Riding on a smile</span><span class="ltx_text" style="font-size:90%;">, RISK, 1994, July, no.3, 32-39.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Féron, O., Tankov, P. and Tinsi, L., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Price formation and optimal trading in intraday electricity markets</span><span class="ltx_text" style="font-size:90%;">,
Mathematics and Financial Economics, 2022, Vol. 16, pp. 205-237.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M., and Takahashi, A., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A mean field game approach to equilibrium pricing with market clearing condition</span><span class="ltx_text" style="font-size:90%;">,
SIAM J. Control. Optim. , 2022, Vol. 1, pp. 259-279.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M., and Takahashi, A., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Strong convergence to the mean-field limit of a finite agent equilibrium</span><span class="ltx_text" style="font-size:90%;">,
SIAM J. Financial Math. , 2022, Vol. 13, No. 2, pp. 459-490.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M. and Takahashi, A., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Equilibrium price formation with a major player and its mean field limit</span><span class="ltx_text" style="font-size:90%;">,
ESAIM: Control, Optimization and Calculus of Variations, 2022, Vol. 28, 21.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Equilibrium pricing of securities in the co-presence of cooperative and non-cooperative populations</span><span class="ltx_text" style="font-size:90%;">,
ESAIM: Control, Optimization and Calculus of Variations, 2023, Vol. 29, 56.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M., Sekine, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Mean-field equilibrium price formation with exponential utility</span><span class="ltx_text" style="font-size:90%;">,
Stochastics and Dynamics, 2025, Vol. 24, No.8, 255001-36.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Fujii, M., Sekine, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Mean field equilibrium asset pricing model with habit formation</span><span class="ltx_text" style="font-size:90%;">,
Asia-Pacific Financial Markets, published online in 2025,
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Gabaix, X, Lasry, J.M. , Lions, P.L. and Moll, B.,</span><span class="ltx_text ltx_font_italic" style="font-size:90%;">The dynamics of inequality</span><span class="ltx_text" style="font-size:90%;">,
Econometrica, 2016, Vol. 84, No. 6, 2071-2111.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Gomes, D.A., Gutierrez, J., and Ribeiro, R., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A random-supply mean field game price model</span><span class="ltx_text" style="font-size:90%;">,
SIAM J. Financial Math., 2023, Vol. 14, No. 1, pp. 1888-222.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Gomes, D.A. and Saúde, J., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A mean-field game approach to price formation</span><span class="ltx_text" style="font-size:90%;">,
Dyn Games Appl, 2020, https://doi.org/10.1007/s13235-020-00348-x.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Hernández-Lerma,O. and Lasserre,J. B. , </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Discrete-Time Markov Control Processes</span><span class="ltx_text" style="font-size:90%;">,
Springer, 1996, NY.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Hu, Y., Imkeller, P. and Müller, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Utility maximization in incomplete markets</span><span class="ltx_text" style="font-size:90%;">,
The Annals of Applied Probability, 2005, 15 (3) : 1691-1712.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Huang, M., Malhame, R. and Caines, P.E., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Large population stochastic dynamic games:
closed-loop McKean-Vlasov systems and the Nash certainty equivalence principle</span><span class="ltx_text" style="font-size:90%;">, Commun. Inf. Syst., 2006,
Vol. 6, No. 3, pp.221-252.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Huang, M., Malhame, R. and Caines, P.E., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">An invariance principle in large population stochastic dynamics games</span><span class="ltx_text" style="font-size:90%;">, Jrl Syst Sci &amp; Complexity,
2007, Vol. 20, pp. 162-172.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Huang, M., Malhame, R. and Caines, P.E., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Large-population cost-coupled LQG problems with nonuniform agents:
individual-mass behavior and decentralized <math alttext="\epsilon" class="ltx_Math" display="inline" id="bib.bib29.m1" intent=":literal"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>-Nash equilibria</span><span class="ltx_text" style="font-size:90%;">, IEEE Transactions on Automatic Control, 2007, Vol. 52, No. 9, pp. 1560-1571.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Karatzas, I. and Shreve, S., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Methods of mathematical finance</span><span class="ltx_text" style="font-size:90%;">,
Springer NY, 1998.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Klenke, A., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Probability Theorey: A comprehensive course</span><span class="ltx_text" style="font-size:90%;">, Third Edition, 2020, Springer Switzerland.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Kobylanski, A., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Backward stochastic differential equations and partial differential equations with quadratic growth</span><span class="ltx_text" style="font-size:90%;">,
The Annals of Probability, 2000, Vol. 28, pp. 558-602.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Lasry, J. M. and Lions, P.L., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Jeux a champ moyen I. Le cas stationnaire</span><span class="ltx_text" style="font-size:90%;">, C. R. Sci. Math. Acad. Paris, 2006,
343 pp. 619-625.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Lasry, J. M. and Lions, P.L., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Jeux a champ moyen II. Horizon fini et controle optimal</span><span class="ltx_text" style="font-size:90%;">,
C. R. Sci. Math. Acad. Paris, 2006, 343, pp. 679-684.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Lasry, J.M. and Lions, P.L., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Mean field games</span><span class="ltx_text" style="font-size:90%;">, Jpn. J. Math., 2007, Vol. 2, pp. 229-260.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Sarto, G.D., Leocata, M. and Livieri, G., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A mean field game approach for pollution regulation of competitive firms</span><span class="ltx_text" style="font-size:90%;">,
2024, preprint, arXiv:2407.1275.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Sekine, M., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">Mean field equilibrium asset pricing model under partial observation: An exponential quadratic Gaussian approach</span><span class="ltx_text" style="font-size:90%;">,
Japan Journal of Industrial and Applied Mathematics, 2025, No. 42, pp. 853-878.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Sharpe, W.F., 1978, Investments (Prentice-Hall, Englewood Chffs, NJ)
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span class="ltx_text" style="font-size:90%;">
Shrivats, A., Firoozi, D. and Jaimungal, S., </span><span class="ltx_text ltx_font_italic" style="font-size:90%;">A mean-field game approach to equilibrium pricing,
optimal generation, and trading in solar renewable energy certificate markets</span><span class="ltx_text" style="font-size:90%;">,
Mathematical Finance, 2020, Vol. 32, Issue 3, pp. 779-824.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct 13 10:38:00 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
